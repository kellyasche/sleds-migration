---
title: "Analysis - local employment cross tabs"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 4
runtime: shiny
resource_files:
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.cpg
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.dbf
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.prj
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbn
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbx
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shp.xml
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(sf)
library(ggrepel)
library(scales)
library(shiny)
library(shinycssloaders)
library(ggiraph)
library(kableExtra)
library(rmapshaper)
library(cowplot)
library(DT)
library(htmlwidgets)
library(RColorBrewer)
library(readxl)
library(janitor)
library(lubridate)
library(systemfonts)
reset_font_cache()
library(ggtext)
library(gmodels)
library(fastDummies)
library(car)
library(glmnet)
library(glmnetUtils)
library(pscl)
library(sjPlot)
library(ggforce)

```

```{r join docs, include=FALSE}
theme_bar <- theme_bw() +
  theme(panel.grid.major = element_line(color = "grey70", size = 0.1),
        panel.grid.minor = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.key.size = unit(1, "lines"),
        legend.margin = margin(0,0,0,0),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))

theme_line <- theme_bw() +
  theme(legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.text = element_text(margin = margin(l = 2)),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_line(color = "grey70", size = 0.1),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))


theme_sf <- theme_bw() +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks=element_blank(),
        panel.background = element_blank(),
        panel.grid.major = element_line(color = "white"),
        panel.border = element_blank(),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))

regions <- read_csv("Data/Join docs/county_regions.csv") %>%
    select(5,6) %>%
    unique() %>%
    mutate(edr = str_replace(edr, "  ", " "),
           planning.region = str_replace(planning.region, " Minnesota", ""),
           planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
           edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"))

counties.regions <- read_csv("Data/Join docs/county_regions.csv") %>%
  rename(mif = `MIF Region`) %>%
  mutate(countyfp = formatC(countyfp, width = 3, flag = "0"),
         Name = str_to_title(Name),
         Name = str_replace(Name, "Q", "q"),
         Name = str_replace(Name, "Of The", "of the"),
         Name = str_replace(Name, "Mcleod", "McLeod"),
         Dem_Desc = ifelse(Name == "Minnesota", "Minnesota", Dem_Desc) ,
         edr = str_replace(edr, "  ", " "),
         planning.region = str_replace(planning.region, " Minnesota", ""),
         planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
         edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"),
         mif = ifelse(is.na(mif), "TC", mif),
         mif = as.factor(mif),
         mif = fct_relevel(mif, "NW", "NE", "WC", "EC", "SW", "SE", "TC"))


color.ruca <- c("Entirely rural" = "#009933", "Town/rural mix" = "#99CC33", "Urban/town/rural mix" = "#CC9966", "Entirely urban" = "#754C29", "Minnesota" = "black")

color.pr <- c("Northwest" = 	"#4575b4", "Northeast" = "grey", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black")

color.edr <- c("EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365", "Minnesota" = "black")

color.pr.edr <- c ("Northwest" = "#4575b4","Northeast" = "#e0f3f8", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black", "EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365")

mn_counties <- st_read("Data/Shapefiles/county shapefiles/MNCounties_MNDOT.shp", quiet = TRUE) %>%
  ms_simplify(keep = .01, keep_shapes = TRUE) %>%
  rename(countyfp = FIPS_CODE)


```

```{r master dataset}
master.original <- read_csv("Data/SLEDS/Masters/Master-updated-1.csv")

master.qual.names <- read_csv("Data/SLEDS/Masters/After analysis/Master-final-after-mca.csv") 

master.states <- read_csv("Data/SLEDS/Masters/States/Master-states.csv")

master <- master.states %>%
  left_join(master.qual.names, by = "PersonID")

```

```{r independent and dependent variables}
updated.qual.var.names <-  master.qual.names %>%
  select(-PersonID) %>%
  names()

quan.var.names <- c("total.cte.courses.taken", "cte.0", "cte.1", "cte.2", "cte.3", "cte.4", "cte.5", "cte.6", "cte.7", "cte.8", "cte.9", "cte.10", "cte.11", "cte.12", "cte.14", "cte.21", "cte.22", "cte.23", "cte.24", "cte.25", "cte.26", "avg.cte.intensity", "MCA.M", "MCA.R", "MCA.S", "avg.unemp.rate", "avg.wages.pct.state")

updated.independent.var.names <- c(updated.qual.var.names, quan.var.names)

cte.cc.var.names <- c("cte.1", "cte.2", "cte.3", "cte.4", "cte.5", "cte.6", "cte.7", "cte.8", "cte.9", "cte.10", "cte.11", "cte.12", "cte.14", "cte.21", "cte.22", "cte.23", "cte.24", "cte.25")

dep.var.names <- master %>%
  select(PersonID, grad.year.1, grad.year.5, grad.year.10)

updated.master <- master.original %>%
  select(PersonID, all_of(`updated.independent.var.names`)) %>%
  left_join(dep.var.names, by = "PersonID") %>%
  mutate_at(2:12, as.factor) %>%
  mutate_at(40:42, as.factor) %>%
  mutate(ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector %in% c("5", "6", "7", "8", "9"), "11", as.character(ps.grad.InstitutionSector)),
         ps.grad.InstitutionSector = as.factor(ps.grad.InstitutionSector),
         grad.year.1 = fct_relevel(grad.year.1, "Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps"),
         grad.year.5 = fct_relevel(grad.year.5, "Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps"),
         grad.year.10 = fct_relevel(grad.year.10, "Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps"),
         highest.cred.level = ifelse(ps.grad.InstitutionSector == "Did not grad", "Some college", as.character(highest.cred.level)),
         highest.cred.level = ifelse(ps.grad.InstitutionSector == "Never attended ps", "No college", as.character(highest.cred.level)),
         highest.cred.level = as.factor(highest.cred.level)) %>%
  droplevels()

names(updated.master)

```

<br>

There are a number of "states" in which an individual in this dataset are assigned;

1. Has meaningful employment in the same county as their high school.
2. Has meaningful employment in the same EDR as their high school, but not county.
3. Has meaningful employment in Southwest Minnesota, but not in the same EDR as their high school.
4. Has meaningful employment in Minnesota, but not in Southwest Minnesota.
5. Is attending post-secondary.
6. Has a MN employment record but it's not meaningful, and not attending post-secondary.
7. Does not have a MN employment record and is not attending post-secondary.

There are three "times" in which we checked to see if the individual had meaningful employment within these geographies;

1. one year after graduating high school
2. five years after graduation, and
3. ten years after graduation. 

Meaningful employment is determined by whether an individual worked 1,000 hours for an employer during time X. In addition, if the individual is working for an employer but not meaningful at time X but worked 1,000 hours for that employer during another year it's still considered "meaningful". 

Due to time x potentially being passed the date of the latest data (2019) for some individuals, the analysis below will filter out all individuals where time x is after 2019. 

From the multiple correspondence analysis and the principle component analysis we determined that the following independent variables will be included in the analysis.

```{r list of ind var}
updated.master %>%
  select(-PersonID, -grad.year.1, -grad.year.5, -grad.year.10) %>%
  lapply(class) 

```
    
<br>

# Methodology

For this analysis we are keeping it simple. For categorical variables I’ll be using the Cramer’s v-square measure of association. The V^2 value is from 0 to 1 with 0 meaning there’s no association and a value closer to 1 indicates a strong association.

For the variables with continuous values I’ll be using the Wilcoxon two paired groups test. P-value will be used to determine whether we can reject the NULL hypothesis at a .01 level. I’ll also include boxplots to see in which direction there might be influence from the variables.

We are going to split up the analysis into two different datasets. The first dataset will combine 3 of the previous states into one.


* Has meaningful employment anywhere in SW Minnesota, which combines the following states;
    + Meaningful emp County
    + Meaningful emp EDR
    + Meaningful emp SW
    
The remaining states will stay the same.

* Has meaningful employment in Minnesota, but not in Southwest Minnesota
* Is attending a post-secondary institution.
* Has a MN employment record but it's not meaningful, and they are not attending post-secondary. 
* Does not have a MN employment record and is not attending post-secondary.

The CART analysis gave us an idea of which variables were the strongest, so we will analyze them in the following order, from which is most strong to least strong from that analysis.

* CTE Coursework
  + avg.cte.intensity
  + total.cte.courses.taken
  + cte. achievement
* Post-secondary pathway
  + ps.grad.InstitutionSector
  + highest.cred.earned
* High school prep
  + took.ACT
  + MCA - reading
* High school county economics
  + avg.wages.pct.state
  + avg.unemp.rate
* Fringe variables
  + Gender
  + LimitedEnglishProficiencyIndicator
  + economic.status
  + pseo.participant
  + SpecialEdStatus
  + RaceEthnicity
  + edr
  + MCA.M
  + MCA.S



# Meaningful employment in Southwest Minnesota

```{r prep meaningful employment in SW MN}
meaningful.emp.sw <- updated.master %>%
  mutate(grad.year.1 = ifelse(grad.year.1 %in% c("Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW"), "Meaningful emp SW", as.character(grad.year.1)),
         grad.year.1 = as_factor(grad.year.1),
         grad.year.1 = fct_relevel(grad.year.1, "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps", "After 2019"),
         grad.year.5 = ifelse(grad.year.5 %in% c("Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW"), "Meaningful emp SW", as.character(grad.year.5)),
         grad.year.5 = as_factor(grad.year.5),
         grad.year.5 = fct_relevel(grad.year.5, "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps", "After 2019"),
         grad.year.10 = ifelse(grad.year.10 %in% c("Meaningful emp County", "Meaningful emp EDR", "Meaningful emp SW"), "Meaningful emp SW", as.character(grad.year.10)),
         grad.year.10 = as_factor(grad.year.10),
         grad.year.10 = fct_relevel(grad.year.10, "Meaningful emp SW", "Meaningful emp MN", "Attending ps", "Not meaningful, not attending ps", "No MN emp record, not attending ps", "After 2019"),
         highest.cred.level = fct_relevel(highest.cred.level, "No college", "Some college", "Less than associate degree", "Associate degree", "Bachelor degree", "Master degree or higher"))

write_csv(meaningful.emp.sw, "Data/SLEDS/Masters/After analysis/Master-meaningful-emp-sw.csv")
```

Let's first take a look at proportion of states in each of the time.X. The chart below shows that a majority of individuals are attending post-secondary one year after graduating high school. However, as the percentage of attendance drops, the two primary states that increase are individuals with meaningful employment in Minnesota, but no Southwest, and individuals with no MN employment record and are not attending post-secondary.

While that trend is happening, the percentage of individuals that have meaningful employment in Southwest Minnesota grow from one year after graduating to five years after graduation, but barely increases to ten years after graduating.

<br>

```{r proportion of states meaningful emp SW}
prop.states.meaningful.emp.sw <- meaningful.emp.sw %>%
  select(grad.year.1, grad.year.5, grad.year.10) %>%
  pivot_longer(names_to = "grad.year", values_to = "states", 1:3) %>%
  group_by(grad.year, states) %>%
  summarize(n = n()) %>%
  ungroup() %>%
  filter(states != "After 2019") %>%
  group_by(grad.year) %>%
  mutate(pct = n / sum(n)) %>%
  ungroup() %>%
  mutate(data_id = seq(n()),
         grad.year = fct_relevel(grad.year, "grad.year.1", "grad.year.5", "grad.year.10"))

prop.states.meaningful.emp.sw.plot <- ggplot(prop.states.meaningful.emp.sw, aes(grad.year, pct, fill = states, group = states)) +
  geom_col_interactive(position = "dodge", aes(data_id = data_id, tooltip = paste(grad.year, "\nState of individuals: ", states, "\nNumber of people in states: ", comma(n), "\nPercent of people in state: ", percent(pct, accuracy = .1), sep = ""))) +
  geom_text(aes(x = 2, y = .5, label = "High proportion\nattending post-secondary"), size = 4, show.legend = FALSE) +
  geom_segment(x = 1.7, xend = 1.2, y = .5, yend = .5, arrow = arrow(length = unit(.25, "cm"))) +
  geom_text(aes(x = 3, y = .6, label = "As less people\nattend post-secondary\nlarger proportions here"), size = 4, show.legend = FALSE) +
  geom_segment(x = 3, xend = 2.9, y = .55, yend = .25, arrow = arrow(length = unit(.25, "cm"))) +
  geom_segment(x = 3, xend = 3.2, y = .55, yend = .39, arrow = arrow(length = unit(.25, "cm"))) +
  labs(x="", y = "", color="", title = "Percent of people in each state")+
  scale_y_continuous(labels=scales::percent)+
  theme_bar+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu"),
                    guide = guide_legend(ncol = 2)) +
  theme(legend.position = "bottom",
        text = element_text(size = 18))


girafe(ggobj = prop.states.meaningful.emp.sw.plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))      

```


<br>

Let's examine the variables to see if there are any significant differences in the proportion of individuals in these states across the variable categories or values.

<br>

## CTE Coursework

**Average CTE intensity**

* One year after graduating
  + No MN emp record, not attending post-secondary had .1797 less CTE intensity in high school compared to the group that had meaningful employment in Minnesota, but not Southwest.
* Five years after graduating
  + No MN emp record, not attending post-secdondary had 
* CTE Coursework
  + avg.cte.intensity
  + total.cte.courses.taken
  + cte. achievement
  
**Total CTE Courses**

All three time.x have a p-value less than .01. And when we examine the differences between the groups, we can see that there is a significant difference when comparing each group with another.

* One year after graduating
  + The individuals who had meaningful employment in Southwest, and in Minnesota took significantly more CTE courses when comparing the means and quartiles.
  + The individuals who attended post-secondary had the lowest values.
* Five years after graduating
  + The individuals who had meaningful employment in Southwest had taken significantly more CTE courses than any other group. 
  + The individuals who had meaningful employment in Minnesota but not Southwest dropped from one year after graduating, but still had higher numbers of courses taken than other groups.
  + Attending post-secondary had the lowest values of CTE courses taken.
* Ten years after graduating
  + The group who had meaningful employment continue to have the largest values of CTE courses taken out of all the groups. 
  + The group who had meaningful employment in Minnesota but not Southwest had the lowest. 

**Achievement in CTE**

All three cross-tabs indicate that there are differences in the group state and the CTE achievement. 

* One year after graduating
  + The CTE concentrator or completor had significantly higher percentage of individuals that had meaningful employment in Southwest or in Minnesota compared to the other groups. 
  + The group that took no CTE courses had a significantly higher percentage of individuals attend post-secondary, or have no MN employment record and were not attending post-secondary.
* Five years after graduation
  + The CTE concentrator or completor group had significantly larger proportion of individuals with meaningful employment in Southwest

<br>

### Average CTE intensity{.tabset}

No boxplot necessary. No significant differences to show. 

#### One year after graduating

<br>

```{r ct avg cte intensity grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, avg.cte.intensity) %>%
  filter(grad.year.1 != "After 2019") %>%
  filter(grad.year.1 != "Attending ps") %>%
  drop_na()

summary <- aov(avg.cte.intensity ~ grad.year.1, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Five years after graduating

<br>

```{r ct avg cte intensity grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, avg.cte.intensity) %>%
  filter(grad.year.5 != "After 2019") %>%
  filter(grad.year.5 != "Attending ps") %>%
  drop_na()

summary <- aov(avg.cte.intensity ~ grad.year.5, data = data)

summary(summary)

TukeyHSD(summary)


```


<br>

#### Ten years after graduating

<br>

```{r ct avg cte intensity grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, avg.cte.intensity) %>%
  filter(grad.year.10 != "After 2019") %>%
  filter(grad.year.10 != "Attending ps") %>%
  drop_na() %>%
  droplevels()

summary <- aov(avg.cte.intensity ~ grad.year.10, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

### Number of CTE courses{.tabset}

There are significant differences across all three time.x and is definitely worth looking at the boxplots.

#### One year after graduating

<br>

```{r ct total cte courses grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, total.cte.courses.taken) %>%
  filter(grad.year.1 != "After 2019") %>%
  filter(grad.year.1 != "Attending ps") %>%
  drop_na() %>%
  group_by(grad.year.1) %>%
  mutate(q1 = quantile(total.cte.courses.taken, .25),
         q3 = quantile(total.cte.courses.taken, .75),
         iqr = IQR(total.cte.courses.taken),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(total.cte.courses.taken > low.outlier,
         total.cte.courses.taken < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.1) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.1, total.cte.courses.taken, fill = grad.year.1, group = grad.year.1)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.1, y = 25, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of number of CTE courses taken by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0, 30))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(total.cte.courses.taken ~ grad.year.1, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Five years after graduating

<br>

```{r ct total cte courses grad year 5 meaningful emp SW}

data <- meaningful.emp.sw %>%
  select(grad.year.5, total.cte.courses.taken) %>%
  filter(grad.year.5 != "After 2019") %>%
  filter(grad.year.5 != "Attending ps") %>%
  drop_na() %>%
  group_by(grad.year.5) %>%
  mutate(q1 = quantile(total.cte.courses.taken, .25),
         q3 = quantile(total.cte.courses.taken, .75),
         iqr = IQR(total.cte.courses.taken),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(total.cte.courses.taken > low.outlier,
         total.cte.courses.taken < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.5) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.5, total.cte.courses.taken, fill = grad.year.5, group = grad.year.5)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.5, y = 25, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of number of CTE courses taken by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0, 30))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 

summary <- aov(total.cte.courses.taken ~ grad.year.5, data = data)

summary(summary)

TukeyHSD(summary)


```


<br>

#### Ten years after graduating

<br>

```{r ct total cte courses grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, total.cte.courses.taken) %>%
  filter(grad.year.10 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.10) %>%
  mutate(q1 = quantile(total.cte.courses.taken, .25),
         q3 = quantile(total.cte.courses.taken, .75),
         iqr = IQR(total.cte.courses.taken),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(total.cte.courses.taken > low.outlier,
         total.cte.courses.taken < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.10) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.10, total.cte.courses.taken, fill = grad.year.10, group = grad.year.10)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.10, y = 25, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of number of CTE courses taken by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0, 30))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 

summary <- aov(total.cte.courses.taken ~ grad.year.10, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

### CTE Achievement{.tabset}

Boxplot?

#### One year after graduating

<br>

```{r ct cte achievement grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, cte.achievement) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct cte achievement grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, cte.achievement) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct cte achievement grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, cte.achievement) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

## Post-secondary pathway

When looking at the multiple correspondence analysis and the number of individuals who have graduated from each institution sector, it makes sense to combine some of these categories. So here's how we will recode this varaible;

In addition to eliminating those variables, we will also simplify the ps.grad.InstitutionSector to the following codes;

* "4-year, any" = graduated from the following institutions
  + Public, 4-year (1)
  + Private, not for profit 4-year (2)
  + Private, for profit 4-year (3)
* "2-year, not public" = graduated from the following institutions
  + Private, not for profit 2-year (5, 11)
  + Private, for profit 2-year (6, 11)
  + Public, less than 2-year (7, 11)
  + Private, not for profit less than 2-year (8, 11)
  + Private for-profit, less-than 2-year (9, 11)
* "Multiple" = graduated from multiple institution sectors (10)
* "2-year, public" = graduated from a public, 2-year institution (4,4)
* "Some" = Attended college but never graduated
* "None" = Did not graduate or attend a post-secondary institution

```{r prep post secondary institution recode}
meaningful.emp.sw.ps.recode <- meaningful.emp.sw %>%
  select(grad.year.1, grad.year.5, grad.year.10, ps.grad.InstitutionSector) %>%
  mutate(ps.grad.InstitutionSector = as.factor(ps.grad.InstitutionSector),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector %in% c("1", "2", "3"), "4-year, any", as.character(ps.grad.InstitutionSector)),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector == "11", "2-year, not public", as.character(new.ps.grad.InstitutionSector)),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector == "4", "2-year, public", as.character(new.ps.grad.InstitutionSector)),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector == "10", "Multiple", as.character(new.ps.grad.InstitutionSector)),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector == "Never attended ps", "Never attended", as.character(new.ps.grad.InstitutionSector)),
         new.ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector == "Did not grad", "Some college", new.ps.grad.InstitutionSector),
         new.ps.grad.InstitutionSector = fct_relevel(new.ps.grad.InstitutionSector, "2-year, public", "2-year, not public", "4-year, any", "Multiple", "Some college", "Never attended"))


```

<br>

**Post-secondary institution sector graduate**

There are definitely significant differences here across all time x.

* One year after graduating
  + As expected, the group that either didn't graduate or attend post-secondary had the highest proportion of individuals with meaningful employment in Southwest MN. Interestingly, this group also had a very high proportion of individuals with no MN employment record and were not attending post-secondary. Perhaps South Dakota employment? Also, this group had a high proportion of individuals with no meaningful employment and were not attending post-secondary. 
  + A whopping 33% of individuals were attending post-secondary institution one year out of college and never graduated.
  + Suprisingly, the group that graduated from a two-year institution had the next highest with 14.5%. 
* Five years after graduating
  + At five years after graduating high school, the group that graduated from a 2-year, public college had the highest proportion of individuals with meaningful employment in Southwest Minnesota (37.5%). Also high was the group that did not graduate or attend post-secondary.
  + The group that graduated from a 4-year institution had a significantly higher proportion of individuals with meaningful employment in Minnesota, but not Southwest.
  + Still a stubbornly high proportion of individuals that eid not graduate or attend post-secondary institution did not have meaningful employment.
  + A higher proportion of individuals that did not graduate or attend post-secondary institution had no MN employment record and were not attending post-secondary.
* Ten years after graduating
  + The group that graduated from a 2-year public had a signficantly higher proportion of individuals with meaningful employment in Southwest.
  + The group that graduated from a 4-year institution had a significantly higher proportion of individuals with meaningful employment in Minnesota, but not Southwest.
  
**Highest credential earned**

There are significant differences here.

* One year after graduating
  + Not surprisingly, the group with less than Associate Degree had a significantly higher proportion of individuals with meaningful employment in Southwest. They also had a significantly higher proportion of individuals with no MN employment record and were not attending post-secondary.
* Five years after graduating
  + The groups that earned an Associate degree or less had a significantly higher proportion of individuals with meaningful employment in Southwest. 
  + The group that earned a bachelor's degree had a significantly higher proportion of individuals with meaningful employment in Minnesota, but not Southwest.
  + The group that had less than an associate degree had a significantly higher proportion of individuals with no mn employment record and were not attending post-secondary.
* Ten years after graduating
  + Even after ten years, the group with an Associate Degree or Less had a higher proportion of individuals with meaningful employment in Southwest. 
  + The groups with a bachelor's degree or higher had a higher proportion of individuals with meaningful employment in Minnesota, but not Southwest.
  

Summary here

<br>

### Post-secondary institution sector graduate{.tabset}

#### One year after graduating

<br>

```{r ct post-secondary institution sector grad year 1 meaningful emp SW}
data <- meaningful.emp.sw.ps.recode %>%
  select(grad.year.1, new.ps.grad.InstitutionSector) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$new.ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct post-secondary institution sector grad year 5 meaningful emp SW}
data <- meaningful.emp.sw.ps.recode %>%
  select(grad.year.5, new.ps.grad.InstitutionSector) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$new.ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduation

<br>

```{r ct post-secondary institution sector grad year 10 meaningful emp SW}
data <- meaningful.emp.sw.ps.recode %>%
  select(grad.year.10, new.ps.grad.InstitutionSector) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$new.ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### Highest credential earned{.tabset}

#### One year after graduating

<br>

```{r ct highest credential earned grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, highest.cred.level) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct highest credential earned grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, highest.cred.level) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduation

<br>

```{r ct highest credential earned grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, highest.cred.level) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

## High school prep

<br>

**Took the ACT**

The p-values indicate significant differences across categories for all time x.

* One year after graduating
  + The group that did not take the ACT in high school had a significantly higher proportion of individuals that had meaningful employment in Southwest, did not have meaningful employment nor were they attending post-secondary, or did not have a MN employment record and were not attending post-secondary.
  + The group that took the ACT had a significantly higher proportion of individuals that were attending post-secondary.
* Five years after graduating
  + The group that did not take the ACT had a significantly higher proportion of individuals that had meaningful employment in Southwest, or did not have meaningful employment, or did not have a MN employment record and were not attending post-secondary.
  + The group that did take the ACT had a significantly higher proportion of individuals that had meaningful employment in Minnesota, but not Southwest or were attending post-secondary.
* Ten years after graduating
  + The group that did not take the ACT had a signifcantly higher proportion of individuals that had meaningful employment in Southwest.
  + The group that did take the ACT had a signficantly higher proportion of individuals that had meaningful employment in Minnesota, but not Southwest.
  + Interestingly, by year ten, both groups had the same proportion of individuals with no MN employment record and were not attending post-secondary.


**MCA - Reading scores**

The p-values indicate that we have significant differences across categories for each Time X.

* One year after graduating
  + The group with the highest MCA-Reading scores were more likely to attend post-secondary.
  + The group with the lowest MCA-Reading scores were more likely to have meaningful employment in Southwest, or had no MN employment record and were not attending post-secondary.
* Five years after graduating
  + The group with the highest MCA-Reading scores were most likely to have meaningful employment in Minnesota, but not Southwest, or were attending post-secondary.
  + The group with the lowest MCA-Reading scores were more likely to have meaningful employment in Southwest, or did not have meaningful employment and were not attending post-secondary.
* Ten years after graduating
  + The group with the highest MCA-Reading scores were most likely to have meaningful employment in Minnesota, but not Southwest, or did not have a MN employment record and were not attending post-secondary.
  + The group with the lowest MCA-reading scores were most likely to have meaningful employment in Southwest Minnesota, or did not have meaningful employment and were not attending post-secondary.


<br>

### Took the ACT{.tabset}

#### One year after graduating

<br>

```{r ct took ACT grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, took.ACT) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct took ACT grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, took.ACT) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct took ACT grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, took.ACT) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### MCA - Reading score{.tabset}

#### One year after graduating

<br>

```{r ct mca reading grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, MCA.R) %>%
  filter(grad.year.1 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.1) %>%
  mutate(q1 = quantile(MCA.R, .25),
         q3 = quantile(MCA.R, .75),
         iqr = IQR(MCA.R),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(MCA.R > low.outlier,
         MCA.R < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.1) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.1, MCA.R, fill = grad.year.1, group = grad.year.1)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.1, y = 5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA reading scores taken by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0,6))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(MCA.R ~ grad.year.1, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Five years after graduating

<br>

```{r ct mca reading grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, MCA.R) %>%
  filter(grad.year.5 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.5) %>%
  mutate(q1 = quantile(MCA.R, .25),
         q3 = quantile(MCA.R, .75),
         iqr = IQR(MCA.R),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(MCA.R > low.outlier,
         MCA.R < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.5) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.5, MCA.R, fill = grad.year.5, group = grad.year.5)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.5, y = 5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0,6))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(MCA.R ~ grad.year.5, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Ten years after graduating

<br>

```{r ct mca reading grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, MCA.R) %>%
  filter(grad.year.10 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.10) %>%
  mutate(q1 = quantile(MCA.R, .25),
         q3 = quantile(MCA.R, .75),
         iqr = IQR(MCA.R),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(MCA.R > low.outlier,
         MCA.R < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.10) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.10, MCA.R, fill = grad.year.10, group = grad.year.10)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.10, y = 5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores by state")+
  scale_y_continuous(labels=scales::comma,
                     limits = c(0,6))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(MCA.R ~ grad.year.10, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

## High school county economics

<br>

**Average wages as a percent of state average**

The p-values indicate that there are signficant differences across categories for each Time X.

* One year after graduating
  + The biggest difference is the group that had meaningful employment in Minnesota but not Southwest - they had the highest average wages in their high school counties.
  + Interestingly, the group that had meaningful employment in Southwest MN had the lowest average wages as a percent of the state.
  + Also, the group that had no MN employment record and were not attending post-secondary had lower average wages as well.
* Five years after graduating
  + Interstingly, the means and values begin to tighten up and there isn't much difference between them.
* Ten years after graduating
  + Same

**Average unemployment rates in high school county**

The p-values indicate a signficant difference across categories for each Time X.

* One year after graduating
  + The group that has meaningful employment in Minnesota but not Southwest had higher unemployment rates in their high school counties.
  + The group that has meaningful employment in Soutwest, or did not have a MN employment record and were not attending post-secondary had low unemployment rates in their high school counties.
* Five years after graduating
  + The group that has meaningful employment in Southwest had lower unemployment rates in their high school county.
  + The group that had meaningful employment in Minnesota but not Southwest had higher unemployment rates in their high school county.
  + The group that had no MN employment record and were not attending post-secondary had the lowest unemployment rate values.
* Ten years after graduating
  + The group with no MN employment record and were not attending post-secondary had the lowest unemployment rate.
  + The group with meaningful employment in Southwest also had low unemployment rates.
  + The group that had meaningful employment in Minnesota, but not Southwest, had higher unemployment rate values.
  

<br>

### Average wages as a percent of state average{.tabset}

#### One year after graduating

<br>

```{r ct avg wages as a pct of state grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, avg.wages.pct.state) %>%
  filter(grad.year.1 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.1) %>%
  mutate(q1 = quantile(avg.wages.pct.state, .25),
         q3 = quantile(avg.wages.pct.state, .75),
         iqr = IQR(avg.wages.pct.state),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.wages.pct.state > low.outlier,
         avg.wages.pct.state < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.1) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.1, avg.wages.pct.state, fill = grad.year.1, group = grad.year.1)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.1, y = .9, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0, 1))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.wages.pct.state ~ grad.year.1, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Five years after graduating

<br>

```{r ct avg wages as a pct of state grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, avg.wages.pct.state) %>%
  filter(grad.year.5 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.5) %>%
  mutate(q1 = quantile(avg.wages.pct.state, .25),
         q3 = quantile(avg.wages.pct.state, .75),
         iqr = IQR(avg.wages.pct.state),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.wages.pct.state > low.outlier,
         avg.wages.pct.state < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.5) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.5, avg.wages.pct.state, fill = grad.year.5, group = grad.year.5)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.5, y = .9, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0, 1))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.wages.pct.state ~ grad.year.5, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Ten years after graduating

<br>

```{r ct avg wages as a pct of state grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, avg.wages.pct.state) %>%
  filter(grad.year.10 != "After 2019") %>%
  drop_na() %>%
  group_by(grad.year.10) %>%
  mutate(q1 = quantile(avg.wages.pct.state, .25),
         q3 = quantile(avg.wages.pct.state, .75),
         iqr = IQR(avg.wages.pct.state),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.wages.pct.state > low.outlier,
         avg.wages.pct.state < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.10) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.10, avg.wages.pct.state, fill = grad.year.10, group = grad.year.10)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.10, y = .9, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0,1))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.wages.pct.state ~ grad.year.10, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

### Average unemployment rates{.tabset}

#### One year after graduating

<br>

```{r ct avg unemployment rates grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, avg.unemp.rate) %>%
  filter(grad.year.1 != "After 2019") %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100) %>%
  drop_na() %>%
  group_by(grad.year.1) %>%
  mutate(q1 = quantile(avg.unemp.rate, .25),
         q3 = quantile(avg.unemp.rate, .75),
         iqr = IQR(avg.unemp.rate),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.unemp.rate > low.outlier,
         avg.unemp.rate < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.1) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.1, avg.unemp.rate, fill = grad.year.1, group = grad.year.1)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.1, y = .1, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0, .2))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.unemp.rate ~ grad.year.1, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Five years after graduating

<br>

```{r ct avg unemployment rates grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, avg.unemp.rate) %>%
  filter(grad.year.5 != "After 2019") %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100) %>%
  drop_na() %>%
  group_by(grad.year.5) %>%
  mutate(q1 = quantile(avg.unemp.rate, .25),
         q3 = quantile(avg.unemp.rate, .75),
         iqr = IQR(avg.unemp.rate),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.unemp.rate > low.outlier,
         avg.unemp.rate < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.5) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.5, avg.unemp.rate, fill = grad.year.5, group = grad.year.5)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.5, y = .1, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0, .2))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.unemp.rate ~ grad.year.5, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

#### Ten years after graduating

<br>

```{r ct avg unemployment rates grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, avg.unemp.rate) %>%
  filter(grad.year.10 != "After 2019") %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100) %>%
  drop_na() %>%
  group_by(grad.year.10) %>%
  mutate(q1 = quantile(avg.unemp.rate, .25),
         q3 = quantile(avg.unemp.rate, .75),
         iqr = IQR(avg.unemp.rate),
         low.outlier = q1 - 1.5*iqr,
         high.outlier = q3 + 1.5*iqr) %>%
  filter(avg.unemp.rate > low.outlier,
         avg.unemp.rate < high.outlier) %>%
  ungroup()

labels <- data %>%
  group_by(grad.year.10) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()

plot <- ggplot(data, aes(grad.year.10, avg.unemp.rate, fill = grad.year.10, group = grad.year.10)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = grad.year.10, y = .1, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "black") +
  labs(x="", y = "", color="", title = "Boxplots of average wages as a percent of Minnesota average by\nstate")+
  scale_y_continuous(labels=scales::percent,
                     limits = c(0, .2))+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18),
        axis.text.x = element_text(angle = 25, hjust = .9))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE)) 


summary <- aov(avg.unemp.rate ~ grad.year.10, data = data)

summary(summary)

TukeyHSD(summary)

```

<br>

## Fringe variables

Next, let's see if any of the fringe variables have significant differences across categories and Time X.

**Gender**

The p-values indicate that there are signficant differences across categories for each Time X. But they are rather small.

* One year after graduating
  + Males had a significantly higher proportion of individuals in every category except attending post-secondary.
  + Females had a significantly higher proportion of individuals that were attending post-secondary.
* Five years after graduating
  + Females had a significantly higher proportion of individuals attending post-secondary, as well as not having meaningful employment and not in post-secondary.
  + Males had a higher proportion of individuals with meaningful employment in Southwest.
* Ten years after graduating
  + Females had a higher proportion of individuals with no meaningful employment and were not attending post-secondary.
  + Males continue to have a higher proportion of individuals with meaningful employment in Southwest.

**Limited English Proficiency**

The p-values indicate that there are significant differences across categories for each Time X, but the strength of the differences decline over time.

* One year after graduating
  + A higher propotion of individuals that had limited english proficiency had meaningful employment in Southwest, did not have meaningful employment and were not attending post-secondary, or had no MN employment record.
  + A higher proportion of individuals that did not have limited english proficiency were attending post-secondary.
* Five years after graduating
  + By year five the differences between the groups having meaningful employment in Southwest dissappear. 
  + A significantly higher proportion of individuals that did not have limited english proficiency had meaningful employment in Minnesota, but not Southwest.
  + Still, a significantly higher proportion of individuals with limited english proficiency had no MN employment record and were not attending post-secondary.
* Ten years after graduating
  + A significantly higher proportion of individuals that did not have limited english proficiency had meaningful employment in Minnesota, but not Southwest. 
* Ten years after graduating
  + Too small of a group. Only 84 individuals that were classified as Limited english proficiency.


**Economic status**

The p-values indicate there are significant differences across categories for each Time X, however those differences decline a lot over time.

* One year after graduating
  + A significantly larger proportion of individuals that qualifed for free or reduced lunch had meaningful employment in Southwest, had meaningful employment in Minnesota but not Southwest, did not have meaningful employment and were not attending post-secondary, or did not have a MN employment record and were not attending post-secondary.
  + A significantly larger proportion of individuals that did not qualify for free or reduced lunch were attending post-secondary.
* Five years after graduating
  + By year five, the differences in the proportion of individuals that have meaningful employment in Southwest disappear. 
  + A significantly larger proportion of individuals that qualify for free or reduced lunch did not have meaningful employment and were not attending post-secondary.
* Ten years after graduating
  + A significantly higher proportion of individuals that qualifed for free or reduced lunch did not have meaningful employment and were not attending post-secondary.
  + A significantly higher proportion of individuals that did not qualify for free or reduced lunch had meaningful employment in Minnesota but not Southwest.


**Special education status**

The p-values indicate significant differences across categories for each Time X, but it does diminish over time.

* One year after graduating
  + A significantly higher proportion of individuals with special education needs had meaningful employment in Southwest, or did not have meaningful employment and wasn't attending post-secondary, or had no MN employment record and was not attending post-secondary.
  + A significantly higher proportion of individuals not requiring special education were attending post-secondary.
* Five years after graduating
  + Same as above
  + A significantly higher proportion of individuals that did not require special education had meaningful employment outside of Southwest.
* Ten years after graduating
  + SAme as above, except
  + A significantly higher proportion of individuals that did not require special education did not have a MN employment record and were not attending post-secondary.

**Race and ethnicity**

The p-values indicate a significant difference across categories for each Time X, however the differences diminish over time.

* One year after graduating
  + A significantly higher proportion of hispanic and black individuals had meaningful employment in Southwest, not having meaningful employment or attend post-secondary, and no MN employment record and not attending post-secondary.
  + A significantly lower proportion of American Indians meaningful employment in Southwest, nor attended post-secondary. Yet they also had a significantly high proportion of individuals that did not have meaningful employment or had no MN employment record.
  + A significantly higher proportion of white individuals were attending post-secondary.
* Five years after graduating.
  + By year fives, the differences between white and hispanic and black having meaningful employment in southwest disappears. 
  + Hispanic individuals have a higher proportion of individuals without meaningful employment and not attending post-secondary, and without a MN employment record. 
* Ten years after graduating
  + Hispanics have a significantly higher proportion without meaningful employmnt, not attending pos-secondary, or without a MN employment record.

**EDR**

P-values indicate a significant difference across categories for all Time X, and they get stronger over time.

* One year after graduating
  + EDR 6E has a higher proportion of individuals that have meaningful employment in Southwest meaningful employment in Minnesota, not having meaningful employment and not attending post-secondary.
  + EDR 8 has a higher proportion of individuals attending post-secondary, and individuals that do not have a MN employment record and are not attending post-secondary.
* Five years after graduating
  + EDR 6E has a significantly higher proportion of individuals with meaningful employment in Minnesota, but not Southwest. 
  + EDR 8 has a significantly higher proportion of individuals with meaningful employment in SW while having a significantly lower proportion with meaningful employment in Minnesota. It also has a significantly higher proportion of individuals with no MN employment record.
* Ten years after graduation
  + EDR 6E has significantly higher proportion of individuals with meaningful employment outside of Southwest Minnesota.
  + EDR 8 has a significantly higher proportion of individuals with meaningful employment in Southwest. And has a HUGE proportion of individuals with no MN employment record.

<br>

### Gender{.tabset}

#### One year after graduating

<br>

```{r ct gender grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, Gender) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$Gender, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct gender grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, Gender) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$Gender, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct gender grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, Gender) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$Gender, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### Limited English Proficiency{.tabset}

#### One year after graduating

<br>

```{r ct LimitedEnglishProficiencyIndicator grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, LimitedEnglishProficiencyIndicator) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct LimitedEnglishProficiencyIndicator grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, LimitedEnglishProficiencyIndicator) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct LimitedEnglishProficiencyIndicator grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, LimitedEnglishProficiencyIndicator) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### Economic Status{.tabset}

#### One year after graduating

<br>

```{r ct economic status grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, economic.status) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$economic.status, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct economic status grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, economic.status) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$economic.status, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct economic status grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, economic.status) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$economic.status, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### Special Education Status{.tabset}

#### One year after graduating

<br>

```{r ct Special Ed Status grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, SpecialEdStatus) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$SpecialEdStatus, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct Special Ed Status grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, SpecialEdStatus) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$SpecialEdStatus, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct Special Ed Status grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, SpecialEdStatus) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$SpecialEdStatus, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### Race and ethnicity{.tabset}

#### One year after graduating

<br>

```{r ct race and ethnicity grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, RaceEthnicity) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct race and ethnicity grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, RaceEthnicity) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct race and ethnicity grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, RaceEthnicity) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

### EDR{.tabset}

#### One year after graduating

<br>

```{r ct edr grad year 1 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.1, edr) %>%
  filter(grad.year.1 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.1, var.col = data$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Five years after graduating

<br>

```{r ct edr grad year 5 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.5, edr) %>%
  filter(grad.year.5 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.5, var.col = data$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>

#### Ten years after graduating

<br>

```{r ct edr grad year 10 meaningful emp SW}
data <- meaningful.emp.sw %>%
  select(grad.year.10, edr) %>%
  filter(grad.year.10 != "After 2019") %>%
  droplevels()

tab_xtab(var.row = data$grad.year.10, var.col = data$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```

<br>



