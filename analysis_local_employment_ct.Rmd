---
title: "Analysis - local employment cross tabs"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 4
runtime: shiny
resource_files:
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.cpg
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.dbf
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.prj
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbn
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbx
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shp.xml
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(sf)
library(ggrepel)
library(scales)
library(shiny)
library(shinycssloaders)
library(ggiraph)
library(kableExtra)
library(rmapshaper)
library(cowplot)
library(DT)
library(htmlwidgets)
library(RColorBrewer)
library(readxl)
library(janitor)
library(lubridate)
library(systemfonts)
reset_font_cache()
library(ggtext)
library(gmodels)
library(fastDummies)
library(car)
library(glmnet)
library(glmnetUtils)
library(pscl)
library(sjPlot)

```

```{r join docs, include=FALSE}
theme_bar <- theme_bw() +
  theme(panel.grid.major = element_line(color = "grey70", size = 0.1),
        panel.grid.minor = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.key.size = unit(1, "lines"),
        legend.margin = margin(0,0,0,0),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))

theme_line <- theme_bw() +
  theme(legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.text = element_text(margin = margin(l = 2)),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_line(color = "grey70", size = 0.1),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))


theme_sf <- theme_bw() +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks=element_blank(),
        panel.background = element_blank(),
        panel.grid.major = element_line(color = "white"),
        panel.border = element_blank(),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial") ,
        plot.title.position = "plot",
        plot.title = element_text(face = "bold"))

regions <- read_csv("Data/Join docs/county_regions.csv") %>%
    select(5,6) %>%
    unique() %>%
    mutate(edr = str_replace(edr, "  ", " "),
           planning.region = str_replace(planning.region, " Minnesota", ""),
           planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
           edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"))

counties.regions <- read_csv("Data/Join docs/county_regions.csv") %>%
  rename(mif = `MIF Region`) %>%
  mutate(countyfp = formatC(countyfp, width = 3, flag = "0"),
         Name = str_to_title(Name),
         Name = str_replace(Name, "Q", "q"),
         Name = str_replace(Name, "Of The", "of the"),
         Name = str_replace(Name, "Mcleod", "McLeod"),
         Dem_Desc = ifelse(Name == "Minnesota", "Minnesota", Dem_Desc) ,
         edr = str_replace(edr, "  ", " "),
         planning.region = str_replace(planning.region, " Minnesota", ""),
         planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
         edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"),
         mif = ifelse(is.na(mif), "TC", mif),
         mif = as.factor(mif),
         mif = fct_relevel(mif, "NW", "NE", "WC", "EC", "SW", "SE", "TC"))


color.ruca <- c("Entirely rural" = "#009933", "Town/rural mix" = "#99CC33", "Urban/town/rural mix" = "#CC9966", "Entirely urban" = "#754C29", "Minnesota" = "black")

color.pr <- c("Northwest" = 	"#4575b4", "Northeast" = "grey", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black")

color.edr <- c("EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365", "Minnesota" = "black")

color.pr.edr <- c ("Northwest" = "#4575b4","Northeast" = "#e0f3f8", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black", "EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365")

mn_counties <- st_read("Data/Shapefiles/county shapefiles/MNCounties_MNDOT.shp", quiet = TRUE) %>%
  ms_simplify(keep = .01, keep_shapes = TRUE) %>%
  rename(countyfp = FIPS_CODE)


```

```{r master dataset}
master.original <- read_csv("Data/SLEDS/Masters/Master-updated-1.csv")

master.qual.names <- read_csv("Data/SLEDS/Masters/Master-final-after-mca.csv") 


```

```{r independent and dependent variables}
updated.qual.var.names <-  master.qual.names %>%
  select(-PersonID) %>%
  names()

quan.var.names <- c("total.cte.courses.taken", "cte.0", "cte.1", "cte.2", "cte.3", "cte.4", "cte.5", "cte.6", "cte.7", "cte.8", "cte.9", "cte.10", "cte.11", "cte.12", "cte.14", "cte.21", "cte.22", "cte.23", "cte.24", "cte.25", "cte.26", "avg.cte.intensity", "MCA.M", "MCA.R", "MCA.S", "avg.unemp.rate", "avg.wages.pct.state")

updated.independent.var.names <- c(updated.qual.var.names, quan.var.names)

cte.cc.var.names <- c("cte.1", "cte.2", "cte.3", "cte.4", "cte.5", "cte.6", "cte.7", "cte.8", "cte.9", "cte.10", "cte.11", "cte.12", "cte.14", "cte.21", "cte.22", "cte.23", "cte.24", "cte.25")

updated.master <- master.original %>%
  select(PersonID, `updated.independent.var.names`, hs.grad.year.county.match, hs.grad.year.2.county.match, hs.grad.year.7.county.match, hs.grad.year.edr.match, hs.grad.year.2.edr.match, hs.grad.year.7.edr.match, hs.grad.year.region.match, hs.grad.year.region.match, hs.grad.year.2.region.match, hs.grad.year.7.region.match, hs.grad.year.state.match, hs.grad.year.2.state.match, hs.grad.year.7.state.match) %>%
  mutate_at(2:15, as.factor) %>%
  mutate(ps.grad.InstitutionSector = ifelse(ps.grad.InstitutionSector %in% c("5", "6", "7", "8", "9"), "11", as.character(ps.grad.InstitutionSector)),
         ps.grad.InstitutionSector = as.factor(ps.grad.InstitutionSector))


```

<br>

The first research question is to analyze the factors that play into whether an individual has meaningful employment within their high school county, EDR, research region, and Minnesota at time X. 

There are three "times" in which we checked to see if the individual had meaningful employment within these geographies;

1. the same year as graduation
2. two years after graduation, and
3. seven years after graduation. 

Meaningful employment is determined by whether an individual worked 1,000 hours for an employer during time X. In addition, if the individual is working for an employer but not meaningful at time X but worked 1,000 hours for that employer during another year it's still considered "meaningful". 

Due to time x potentially being passed the date of the latest data (2019) for some individuals, the analysis below will filter out all individuals where time x is after 2019. 

From the multiple correspondence analysis and the principle component analysis we determined that the following independent variables will be included in the analysis, although I'm no including the CTE.# ones yet;

```{r list of ind var}
updated.master %>%
  select(-PersonID, -hs.grad.year.county.match, -hs.grad.year.2.county.match, -hs.grad.year.7.county.match, -hs.grad.year.edr.match, -hs.grad.year.2.edr.match, -hs.grad.year.7.edr.match, -hs.grad.year.region.match, -hs.grad.year.region.match, -hs.grad.year.2.region.match, -hs.grad.year.7.region.match, -hs.grad.year.state.match, -hs.grad.year.2.state.match, -hs.grad.year.7.state.match) %>%
  lapply(class) 

```
    
<br>

# Steps in analysis

Our dependent variable - the individual has meaningful employment in same location X as their high school - has 4 different outcomes.

1. Location match: the individual has
    + a MN employment record at time X
    + has meaningful employment at time X
    + is employed in the same location X as their high school.
2. No location match: the individual has 
    + a MN employment record at time X
    + has meaningful employment at time X
    + does NOT have employment in the same location X as their high school.
3. No meaningful emp: the individual has
    + a MN employment record at time X
    + the employment is not meaningful at time X.
4. No MN emp record: the individual has
    + NO MN employment record at time X.
    
Since we are most interested in whether an individual has meaningful employment in region X at time X we will create two groups; 1. all individuals that meet the criteria/outcome 1 from list above, and 2. all remaining individuals.
    
For each time X we will analyze whether the independent variables differ significantly on whether an individual has a MN employment record AND has meaningful employment AND the meaningful employment is in the same region X as their high school.

The structure of the analysis will look like this;

* Location match - county through region
    + For each region x
      + Summary chart
    + Cross tabs For each time x (grad year, grad year +2, grad year +7)
      + Demographic variables
      + HS characteristic variables
      + HS enrollment variables
      + HS accomplishments
      + Post secondary (only gor grad year +2 and grad year +7)
      
For categorical variables I'll be using the Cramer's v-square measure of association. The V^2 value is from 0 to 1 with 0 meaning there's no association and a value closer to 1 indicates a strong association.

For the variables with continuous values I'll be using the Wilcoxon two paired groups test. P-value will be used to determine whether we can reject the NULL hypothesis at a .01 level. I'll also include boxplots to see in which direction there might be influence from the variables. 

<br>

# Location match - county

## Summary chart

The chart below provides the percentage of individuals in the dataset that had meaningful employment in the same county as their high school the year of their graduation, graduation year +2, and graduation year +7. The percentage of individuals does increase with each subsequent time X - 12.4% the year of gradation, 17.4% two years after graduation, and 20% seven years after graduation.

<br>

```{r summary county grad year}
county.match.summary <- updated.master %>%
  select(PersonID, hs.grad.year.county.match, hs.grad.year.2.county.match, hs.grad.year.7.county.match) %>%
  gather(key = "key", value = "value", 2:4) %>%
  filter(value != "Unknown") %>%
  filter(value != "After 2019") %>%
  mutate(value = ifelse(value == "Location match", "Match", "No match")) %>%
  group_by(key, value) %>%
  summarize(n = n()) %>%
  ungroup() %>%
  group_by(key) %>%
  mutate(pct = n / sum(n)) %>%
  ungroup() %>%
  mutate(key = ifelse(str_detect(key, "2"), "grad year +2",
                      ifelse(str_detect(key, "7"), "grad year +7", "grad year +0")),
         key = fct_relevel(key, "grad year +0", "grad year +2", "grad year +7"),
         data_id = seq(n()))
                                      

county.match.summary.plot <- ggplot(county.match.summary, aes(value, pct, fill = key, group = key)) +
  geom_col_interactive(position = "dodge", aes(data_id = data_id, tooltip = paste(key, "\n", value, ": ", percent(pct, accuracy = .1), sep = ""))) +
  geom_label(aes(label = percent(pct, accuracy = .1)), show.legend = FALSE, color = "white", size = 5, position = position_dodge(width = .9)) +
  labs(x="", y = "", color="", title = "Meaningful employment in same county as high school for each\ntime X as share of total individuals", subtitle = "The percentage of individuals with meaningful employment in same county as their high\nschool increases for each subsequent Time X")+
  scale_y_continuous(labels=scales::percent)+
  theme_bar+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu"),
                    guide = guide_legend(ncol = 3)) +
  theme(legend.position = "bottom",
        text = element_text(size = 18))


girafe(ggobj = county.match.summary.plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))      

```

<br>

## Cross tabs - Time X = grad year

```{r master ct grad year}
master.grad.year.ct <- updated.master %>%
  select(hs.grad.year.county.match, updated.independent.var.names) %>% 
  rename(`County match` = 1) %>%
  drop_na(`County match`) %>%
  mutate(`County match` = ifelse(`County match` == "Location match", "Match", "No match"))

```

Now let's examine whether there are any relationships between these individuals and the independent variables.

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in the same county as their high school the year they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.068, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (16.6%) had meaningful employment in their high school county compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in the same county as their high school than what was expected - 124 individuals vs. 93 expected.
* A larger proportion of hispanic individuals (19.9%) had meaningful employment in their high school county compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same county as their high school than what was expected - 549 observed vs. 341 expected.

#### Race/Ethnicity

```{r ct race and ethnicity}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.053, indicating that the relationships are weak. Highlights from the table include;

* Individuals from entirely rural high schools had a significantly lower proportion of individuals that had meaningful employment in the same county as their high school - 8.6% compared to 11.1% in urban/town/rural mix and 13.4% in town/rural mix.
* Individuals from entirely rural high schools had a significantly lower observed number of individuals that had meaningful employment in the same county as their high school - 476 observed vs. 684 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.050, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same county as their high school the year of graduation - 9.7% compared to 12% in EDR 8 and 14.2% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same county as their high school the year of graduation - 714 observed vs. 911 expected.

<br>

**avg.unemployment.rate:** The p-value does indicate a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and the average unemployment rate in that county. It states that as unemployment increases, the likliness of having "match" increases as well.

<br>

**avg.wages.pct.state:** The Wilcoxon test p-value indicates a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and the average wages in the high school county as a percent of the state average wages. The boxplots show that counties with a higher percentage equaled a higher liklihood of their being a county match in employment.

<br>

**avg.cte.intensity:** The p-value indicates that we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school and the average CTE intensity at their high school. The boxplots show that individuals that did have meaninful employment the year of graduation went to a high school with an average cte intensity that was slightly higher.

<br>



#### Dem_Desc

```{r ct Dem_Desc}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate}
data <- master.grad.year.ct %>%
  select(`County match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.unemp.rate, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = .09, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `County match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state}
data <- master.grad.year.ct %>%
  select(`County match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`County match`, avg.wages.pct.state, fill = `County match`, group = `County match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `County match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `County match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity}
data <- master.grad.year.ct %>%
  select(`County match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.cte.intensity, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `County match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and if the individual has limited english proficiency. However, the Cramer's V^2 value is only .026 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that had limited english proficiency had meaningful employment in the same county as their high school the year of graduation - 18.1% vs. 12.2% for individuals that did not have limited english proficiency.
* A significantly larger number of individuals with limited english proficiency worked in the same county as their high school than expected - 146 observed vs. 100 expected.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .088 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same county as their high school the year of graduation - 14.5% vs. 8.4% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same county as their high school the year of graduation - 3,608 observed vs. 3,084 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .060 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in the same county as their high school the year of graduation - 18.8% vs. 11.8% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 623 observed vs. 411 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .027 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in the same county as their high school - 16.1% vs. 12.2% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 333 observed vs. 256 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct limitedenglishproficiencyindicator}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct pseo}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct non english home}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct english learner}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments variables{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .107 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 17.3% vs 9.9% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 2,197 observed vs. 1,567 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .064 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same county as their high school - 13.3% vs 7.5% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same county as their high school - 4,271 observed vs. 3,976 expected.

<br>

**total.cte.coureses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school and the number of CTE courses an individual has taken. The boxplots show that individuals who worked in the same county as their high school the year they graduated took a higher number of CTE courses in high school.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school the year of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .074 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same county as their high school - 14.7% vs. 11.6% for CTE participant and 8.7% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same county as their high school than what was expected - 2,630 observed vs. 2,211 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same county as their high school the year of graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same county as their high school the year of graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same county as their high school the year of graduation.

<br>

#### took.ACT

```{r ct act taken}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct ap exam}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses}

data <- master.grad.year.ct %>%
  select(`County match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, total.cte.courses.taken, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `County match`, data = data)

```

<br>

#### cte.achievement

```{r cte achievement}
tab_xtab(var.row = master.grad.year.ct$`County match`, var.col = master.grad.year.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>



#### MCA.M

```{r ct totat MCA math}

data <- master.grad.year.ct %>%
  select(`County match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.M, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `County match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading}
data <- master.grad.year.ct %>%
  select(`County match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.R, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `County match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science}
data <- master.grad.year.ct %>%
  select(`County match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.S, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `County match`, data = data)


```

<br>

## Cross tabs - Time X = grad year +2

```{r master ct grad year plus 2}
master.grad.year.2.ct <- updated.master %>%
  select(hs.grad.year.2.county.match, updated.independent.var.names) %>%
  filter(hs.grad.year.2.county.match != "After 2019") %>%
  filter(hs.grad.year.2.county.match != "Unknown") %>%
  droplevels() %>%
  mutate(hs.grad.year.2.county.match = as.factor(hs.grad.year.2.county.match)) %>%
  rename(`County match` = 1) %>%
  mutate(`County match` = ifelse(`County match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.076, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (23.0%) had meaningful employment in their high school county compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in the same county as their high school than what was expected - 124 individuals vs. 94 expected.
* A larger proportion of hispanic individuals (27.6%) had meaningful employment in their high school county compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same county as their high school than what was expected - 569 observed vs. 359 expected.

#### Race/Ethnicity

```{r ct race and ethnicity grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.065, indicating that the relationships are weak. Highlights from the table include;

* Individuals from entirely rural high schools had a significantly lower proportion of individuals that had meaningful employment in the same county as their high school two years after graduation - 11.6% compared to 18.7% in town/rural mix and 17.4% in urban/town/rural mix.
* Individuals from entirely rural high schools had a significantly lower observed number of individuals that had meaningful employment in the same county as their high school two years after graduation - 550 observed vs. 824 expected.
* Town/rural mix high schools had a significantly higher number of individuals that had meaningful employment in the same county two years after graduation than expected - 4,114 vs. 3,839 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.069, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same county as their high school two years after graduation - 13% compared to 16.9% in EDR 8 and 20.3% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same county as their high school two years after graduation - 802 observed vs. 1,073 expected.

<br>

**avg.unemployment.rate:** The p-value does NOT indicate a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and the average unemployment rate in that county.

<br>

**avg.wages.pct.state:** The p-value does indicate a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and the average household income in that county. Individuals that graduated from a high school county with higher percentages were more likely to have meaningful employment in the county two years after graduation.

<br>

**avg.cte.intensity:** The p-value indicates that we can NOT reject the null hypothesis.




#### Dem_Desc

```{r ct Dem_Desc grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.unemp.rate, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = .09, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during hhigh school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `County match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`County match`, avg.wages.pct.state, fill = `County match`, group = `County match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `County match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `County match`, data = data)
```

<br>

#### avg.cte.intensity

```{r avg cte intensity grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.cte.intensity, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `County match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the NULL hypothesis. 

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .110 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same county as their high school two years after graduation - 20.3% vs. 11.5% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same county as their high school two years after graduation - 4,348 observed vs. 3,729 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .050 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in the same county as their high school two years after graduation - 23.7% vs. 16.9% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 616 observed vs. 452 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .031 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in the same county as their high school - 22.5% vs. 17.2% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 355 observed vs. 275 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct limitedenglishproficiencyindicator grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct pseo grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### non.english.home

```{r ct non english home grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct english learner grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments variables{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .139 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 24.5% vs 13.5% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 2,763 observed vs. 1,962 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .083 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same county as their high school - 18.8% vs 10.2% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same county as their high school - 5,027 observed vs. 4,664 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school two years after graduation and the number of CTE courses an individual has taken. Individuals that took a higher number of CTE courses were more likely to have meaningful employment in the county two years after graduation.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .094 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same county as their high school - 20.7% vs. 16.8% for CTE participant and 11.7% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same county as their high school than what was expected - 3,038 observed vs. 2,555 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school two years after graduation and their MCA math score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county two years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school two years after graduation and their MCA reading score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county two years after graduation.


<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school two years after graduation and their MCA science score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county two years after graduation.


<br>

#### took.ACT

```{r ct act taken grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct ap exam grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct totat cte courses grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, total.cte.courses.taken, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `County match`, data = data)
```

<br>

#### cte.achievement

```{r cte achievement grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>



#### MCA.M

```{r ct totat MCA math grad year plus 2}

data <- master.grad.year.2.ct %>%
  select(`County match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.M, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `County match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.R, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `County match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science grad year plus 2}
data <- master.grad.year.2.ct %>%
  select(`County match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.S, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `County match`, data = data)


```

<br>

### Post-secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual graduated from a post-secondary institution.However, the Cramer's V^2 value is only .115 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same county as their high school - 22.2% vs 13.4% of individuals that graduated from a post-seconary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same county as their high school - 3,231 observed vs. 2,539 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .071 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in the same county as their high school - 22.5% vs 16% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in the same county as their high school - 1,580 observed vs. 1,223 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .209 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in the same county as their high school two years after graduation - 25.5% compared to less than 20% for all other institutions.
* This same group of individuals had more people with meaningful employment in the same county as their high school than expected - 1,439 vs. 984 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in the same county as their high school two years after graduating - 22.5%.
* These same individuals a significantly higher number have meaningful employment in the same county as their high school than expected - 1,580 observed vs. 1,223 expected.
* A significantly larger proportion of individuals that attend post secondary but never graduated had meaningful employment in the same county as their high school two years after graduating - 21.8%.
* These same individuals had a significantly higher number of people have meaningful employment in the same county as their high school two years after graduating - 1,659 observed vs. 1,328 expected.
* A significantly lower proportion of individuals that graduated from a public, 4 year college had meaningful employment in the same county as their high school two years after graduation - 6.8%.
* These same individuals had a significantly lower number of people that had meaningful employment in the same county as their high school - 482 observed vs. 1,243 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school two years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .201 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in the same county as their high school - 21.7% of individuals with Associate degree and 22.5% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in the same county as their high school than expected - 849 observed vs. 682 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in the same county as their high school than expected - 4,154 observed vs. 3,215 expected.

<br>


#### ps.grad

```{r ps.grad ct grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```


<br>

#### attended.ps

```{r attended ps grad year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level year plus 2}
tab_xtab(var.row = master.grad.year.2.ct$`County match`, var.col = master.grad.year.2.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

## Cross tabs - Time X = grad year +7

```{r master ct grad year plus 7}
master.grad.year.7.ct <- updated.master %>%
  select(hs.grad.year.7.county.match, updated.independent.var.names) %>%
  filter(hs.grad.year.7.county.match != "After 2019") %>%
  filter(hs.grad.year.7.county.match != "Unknown") %>%
  droplevels() %>%
  mutate(hs.grad.year.7.county.match = as.factor(hs.grad.year.7.county.match)) %>%
  rename(`County match` = 1) %>%
  mutate(`County match` = ifelse(`County match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.029, indicating a weak association. Highlights in the table include;


* A larger proportion of hispanic individuals (23.1%) had meaningful employment in their high school county compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same county as their high school than what was expected - 191 observed vs. 165 expected.

#### Race/Ethnicity

```{r ct race and ethnicity grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.054, indicating that the relationships are weak. Highlights from the table include;

* Individuals from entirely rural high schools had a significantly lower proportion of individuals that had meaningful employment in the same county as their high school seven years after graduation - 15.6% compared to 21.3% in town/rural mix and 18.3% in urban/town/rural mix.
* Individuals from entirely rural high schools had a significantly lower observed number of individuals that had meaningful employment in the same county as their high school seven years after graduation - 411 observed vs. 525 expected.
* Town/rural mix high schools had a significantly higher number of individuals that had meaningful employment in the same county seven years after graduation than expected - 2,420 vs. 2,264 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.059, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same county as their high school seven years after graduation - 15.3% compared to 20.9% in EDR 8 and 21.5% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same county as their high school seven years after graduation - 505 observed vs. 660 expected.

<br>

**avg.unemployment.rate:** The p-value does indicate a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and the average unemployment rate in that county. The boxplots show that individuals that had meaningful employment in the same county as their high school seven years after graduation had overall lower unemployment rates in those counties.

<br>

**wages.3year.avg:** The p-value does indicate a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and the average household income in that county. The boxplots show that individuals that had meaningful employment in the same county as their high school had higher percentages in those counties.

<br>

**avg.cte.intensity:** The p-value indicates we can not reject the NULL hypothesis.



#### Dem_Desc

```{r ct Dem_Desc grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.unemp.rate, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `County match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`County match`, avg.wages.pct.state, fill = `County match`, group = `County match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `County match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in County")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `County match`, data = data)
```

<br>

#### avg.cte.intensity

```{r avg cte intensity grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, avg.cte.intensity, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `County match`, data = data)
```

<br>



### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the NULL hypothesis. 

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .068 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same county as their high school seven years after graduation - 21.5% vs. 15.1% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same county as their high school seven years after graduation - 2,712 observed vs. 2,521 expected.

<br>

**non.english.home:** The p-value indicates we can not reject the null hypothesis.

<br>

**english.learner**: The p-value indicates we can not reject the null hypothesis.

#### LimitedEnglishProficiencyIndicator

```{r ct limitedenglishproficiencyindicator grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct pseo grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### non.english.home

```{r ct non english home grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct english learner grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments variables{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .089 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 24.4% vs 17.1% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same county as their high school - 1,590 observed vs. 1,301 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .066 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same county as their high school - 21.1% vs 13.9% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same county as their high school - 2,938 observed vs. 2,778 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school seven years after graduation and the number of CTE courses an individual has taken. The boxplot shows that individuals that had meaningful employment in the same county as their high school also had taken a larger number of CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .091 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same county as their high school - 23.1% vs. 18.6% for CTE participant and 13.9% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same county as their high school than what was expected - 2,014 observed vs. 1,743 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school seven years after graduation and their MCA math score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county seven years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school seven years after graduation and their MCA reading score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county seven years after graduation.


<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same county as their high school seven years after graduation and their MCA science score. The boxplots indicate that individuals with lower scores were more likely to have meaningful employment in the county seven years after graduation.

<br>

#### took.ACT

```{r ct act taken grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct ap exam grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct totat cte courses grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, total.cte.courses.taken, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `County match`, data = data)
```

<br>

#### cte.achievement

```{r cte achievement grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct totat MCA math grad year plus 7}

data <- master.grad.year.7.ct %>%
  select(`County match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.M, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `County match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.R, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `County match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science grad year plus 7}
data <- master.grad.year.7.ct %>%
  select(`County match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`County match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`County match`, MCA.S, fill = `County match`, group = `County match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `County match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nCounty")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `County match`, data = data)


```

<br>

### Post-secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .051 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same county as their high school - 22.3% vs 18.2% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same county as their high school - 1,608 observed vs. 1,440 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .028 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in the same county as their high school - 22.1% vs 19.4% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in the same county as their high school - 783 observed vs. 707 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .146 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in the same county as their high school seven years after graduation - 27.9%.
* This same group of individuals had more people with meaningful employment in the same county as their high school than expected - 819 vs. 585 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in the same county as their high school seven years after graduating - 22.1%.
* These same individuals a significantly higher number have meaningful employment in the same county as their high school than expected - 783 observed vs. 707 expected.
* A significantly larger proportion of individuals that attend post secondary but never graduated had meaningful employment in the same county as their high school seven years after graduating - 22.4%.
* These same individuals had a significantly higher number of people have meaningful employment in the same county as their high school seven years after graduating - 835 observed vs. 744 expected.
* A significantly lower proportion of individuals that graduated from a public, 4 year college had meaningful employment in the same county as their high school seven years after graduation - 13.7%.
* These same individuals had a significantly lower number of people that had meaningful employment in the same county as their high school - 516 observed vs. 755 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same county as their high school seven years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .137 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in the same county as their high school - 24.5% of individuals with Associate degree and 23.4% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in the same county as their high school than expected - 497 observed vs. 404 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in the same county as their high school than expected - 2,192 observed vs. 1,869 expected.

<br>


#### ps.grad

```{r ps.grad ct grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

#### attended.ps

```{r attended ps grad year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level year plus 7}
tab_xtab(var.row = master.grad.year.7.ct$`County match`, var.col = master.grad.year.7.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

# Location match - EDR

<br>

## Summary Chart

The chart below provides the percentage of individuals in the dataset that had meaningful employment in the same EDR as their high school the year of their graduation, graduation year +2, and graduation year +7. The percentage of individuals does increase with each subsequent time X - 14.9% the year of gradation, 22.5% two years after graduation, and 27,6% seven years after graduation.

<br>

```{r summary edr grad year}
edr.match.summary <- updated.master %>%
  select(PersonID, hs.grad.year.edr.match, hs.grad.year.2.edr.match, hs.grad.year.7.edr.match) %>%
  gather(key = "key", value = "value", 2:4) %>%
  filter(value != "Unknown") %>%
  filter(value != "After 2019") %>%
  mutate(value = ifelse(value == "Location match", "Match", "No match")) %>%
  group_by(key, value) %>%
  summarize(n = n()) %>%
  ungroup() %>%
  group_by(key) %>%
  mutate(pct = n / sum(n)) %>%
  ungroup() %>%
  mutate(key = ifelse(str_detect(key, "2"), "grad year +2",
                      ifelse(str_detect(key, "7"), "grad year +7", "grad year +0")),
         key = fct_relevel(key, "grad year +0", "grad year +2", "grad year +7"),
         data_id = seq(n()))
                                      

edr.match.summary.plot <- ggplot(edr.match.summary, aes(value, pct, fill = key, group = key)) +
  geom_col_interactive(position = "dodge", aes(data_id = data_id, tooltip = paste(key, "\n", value, ": ", percent(pct, accuracy = .1), sep = ""))) +
  geom_label(aes(label = percent(pct, accuracy = .1)), show.legend = FALSE, color = "white", size = 5, position = position_dodge(width = .9)) +
  labs(x="", y = "", color="", title = "Meaningful employment in same EDR as high school for each\ntime X as share of total individuals", subtitle = "The percentage of individuals with meaningful employment in same EDR as their high\nschool increases for each subsequent Time X")+
  scale_y_continuous(labels=scales::percent)+
  theme_bar+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu"),
                    guide = guide_legend(ncol = 3)) +
  theme(legend.position = "bottom",
        text = element_text(size = 18))


girafe(ggobj = edr.match.summary.plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))      

```

<br>

## Cross tabs - Time X = grad year

```{r master ct edr grad year}
master.grad.year.edr.ct <- updated.master %>%
  select(hs.grad.year.edr.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.edr.match != "Unknown") %>%
  filter(hs.grad.year.edr.match != "After 2019") %>%
  rename(`EDR match` = 1) %>%
  mutate(`EDR match` = ifelse(`EDR match` == "Location match", "Match", "No match")) %>%
  drop_na(`EDR match`)

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in the same EDR as their high school the year they graduate and the individual's race/ethnicy. The p-value was 0, however the Cramer's V^2 value was 0.064, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (17.9%) had meaningful employment in their high school EDR compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in the same EDR as their high school than what was expected - 134 individuals vs. 111 expected.
* A larger proportion of hispanic individuals (22.6%) had meaningful employment in their high school EDR compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same EDR as their high school than what was expected - 623 observed vs. 408 expected.

#### Race/Ethnicity

```{r ct edr race and ethnicity}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristics variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.053, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in the same EDR as their high school - 15.9% compared to 12.2% in entirely rural and 12.4% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in the same EDR as their high school - 4,233 observed vs. 3,942 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.043, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same EDR as their high school the year of graduation - 11.8% compared to 15.1% in EDR 8 and 16.1% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same EDR as their high school the year of graduation - 871 observed vs. 1,091 expected.

<br>

**avg.unemployment.rate:** The ANOVA table does indicate a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and the average unemployment rate in their high school county. It states that as unemployment decreases, the likliness of having "match" increases as well. But it is very minimal.

<br>

**wages.3year.avg:** No relationship.

<br>

**avg.CTE.intensity:** No relationship.



#### Dem_Desc

```{r ct Dem_Desc EDR}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr edr}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate edr}
data <- master.grad.year.edr.ct %>%
  select(`EDR match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.unemp.rate, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `EDR match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state edr}
data <- master.grad.year.edr.ct %>%
  select(`EDR match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`EDR match`, avg.wages.pct.state, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `EDR match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `EDR match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity edr}
data <- master.grad.year.edr.ct %>%
  select(`EDR match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.cte.intensity, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `EDR match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and if the individual has limited english proficiency. However, the Cramer's V^2 value is only .026 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that had limited english proficiency had meaningful employment in the same EDR as their high school the year of graduation - 21.5% vs. 14.7% for individuals that did not have limited english proficiency.
* A significantly larger number of individuals with limited english proficiency worked in the same EDR as their high school than expected - 173 observed vs. 119 expected.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .099 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same EDR as their high school the year of graduation - 17.4% vs. 10.0% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same EDR as their high school the year of graduation - 4,332 observed vs. 3,692 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .060 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in the same EDR as their high school the year of graduation - 21.7% vs. 14.2% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 720 observed vs. 492 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .035 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in the same EDR as their high school - 20.0% vs. 14.5% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 414 observed vs. 306 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct edr limitedenglishproficiencyindicator}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct edr pseo}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct edr non english home}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct edr english learner}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .121 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 20.9% vs 11.8% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 2,650 observed vs. 1,876 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .079 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same EDR as their high school - 16.0% vs 8.3% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same EDR as their high school - 5,152 observed vs. 4,761 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and the number of CTE courses an individual has taken. The boxplots show that individuals that had meaningful employment in the same EDR as their high school likely took more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school the year of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .082 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same EDR as their high school - 17.7% vs. 13.8% for CTE participant and 10.5% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same EDR as their high school than what was expected - 3,156 observed vs. 2,647 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school the year of graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school the year of graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school the year of graduation.

<br>

#### took.ACT

```{r ct edr act taken}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct edr ap exam}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses edr}

data <- master.grad.year.edr.ct %>%
  select(`EDR match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, total.cte.courses.taken, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `EDR match`, data = data)

```

<br>

#### cte.achievement

```{r ct edr cte achievement}
tab_xtab(var.row = master.grad.year.edr.ct$`EDR match`, var.col = master.grad.year.edr.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math edr}

data <- master.grad.year.edr.ct %>%
  select(`EDR match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.M, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `EDR match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading edr}
data <- master.grad.year.edr.ct %>%
  select(`EDR match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.R, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `EDR match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science edr}
data <- master.grad.year.edr.ct %>%
  select(`EDR match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.S, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `EDR match`, data = data)


```

<br>

## Cross tabs - Time X = grad year +2

```{r master ct edr grad year plus 2}
master.grad.year.2.edr.ct <- updated.master %>%
  select(hs.grad.year.2.edr.match, updated.independent.var.names) %>%
  filter(hs.grad.year.2.edr.match != "After 2019") %>%
  filter(hs.grad.year.2.edr.match != "Unknown") %>%
  droplevels() %>%
  mutate(hs.grad.year.2.edr.match = as.factor(hs.grad.year.2.edr.match)) %>%
  rename(`EDR match` = 1) %>%
  mutate(`EDR match` = ifelse(`EDR match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after they graduate and the individual's race/ethnicy. The p-value was 0, however the Cramer's V^2 value was 0.063, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (26.2%) had meaningful employment in their high school EDR compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in the same EDR as their high school than what was expected - 141 individuals vs. 121 expected.
* A larger proportion of hispanic individuals (31.9%) had meaningful employment in their high school EDR compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same EDR as their high school than what was expected - 658 observed vs. 464 expected.

#### Race/Ethnicity

```{r ct edr race and ethnicity gread year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristics variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.043, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in the same EDR as their high school - 23.7% compared to 19.6% in entirely rural and 20.0% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in the same EDR as their high school - 5,217observed vs. 4,954 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.062, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same EDR as their high school two years after graduation - 17.2% compared to 23.6% in EDR 8 and 24.0% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same EDR as their high school two years after graduation - 1,059 observed vs. 1,384 expected.

<br>

**avg.unemployment.rate:** No relationship

<br>

**wages.3year.avg:** No relationship.

<br>

**avg.cte.intensity:** No relationship



#### Dem_Desc

```{r ct edr Dem_Desc grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate edr grad year plus 2}
data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.unemp.rate, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `EDR match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state edr grad year plus 2}
data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`EDR match`, avg.wages.pct.state, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `EDR match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `EDR match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity edr grad year plus 2}
data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.cte.intensity, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `EDR match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the null hypothesis.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .128 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same EDR as their high school two years after graduation - 26.2% vs. 14.8% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same EDR as their high school two years after graduation - 5,608 observed vs. 4,811 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .046 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in the same EDR as their high school two years after graduation - 28.9% vs. 21.9% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 750 observed vs. 583 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .035 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in the same EDR as their high school - 28.9% vs. 22.1% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 457 observed vs. 355 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct edr limitedenglishproficiencyindicator grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct edr pseo grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct edr non english home grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct edr english learner grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .163 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 31.7% vs 17.4% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 3,565 observed vs. 2,532 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .109 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same EDR as their high school - 24.5% vs 11.9% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same EDR as their high school - 6,548 observed vs. 6,019 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and the number of CTE courses an individual has taken. The boxplots show that individuals that had meaningful employment in the same EDR as their high school were more likely to take more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .110 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same EDR as their high school - 26.7% vs. 21.7% for CTE participant and 15.2% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same EDR as their high school than what was expected - 3,918 observed vs. 3,297 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school two years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school two years after graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school two years after graduation.

<br>

#### took.ACT

```{r ct edr act taken grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct edr ap exam grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses edr grad year plus 2}

data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, total.cte.courses.taken, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `EDR match`, data = data)

```

<br>

#### cte.achievement

```{r ct edr cte achievement grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math edr grad year plus 2}

data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.M, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `EDR match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading edr grad year plus 2}
data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.R, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `EDR match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science edr grad year plus 2}
data <- master.grad.year.2.edr.ct %>%
  select(`EDR match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.S, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `EDR match`, data = data)


```

<br>

### Post-secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .113 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same EDR as their high school - 28.5% vs 17.4% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in the same EDR as their high school - 4,156 observed vs. 3,276 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .088 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in the same EDR as their high school - 29.4% vs 20.5% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in the same EDR as their high school - 2,064 observed vs. 1,578 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .253 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in the same EDR as their high school two years after graduation - 33.9%.
* This same group of individuals had more people with meaningful employment in the same EDR as their high school than expected - 1,914 vs. 1,270 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in the same EDR as their high school two years after graduating - 29.4%.
* These same individuals a significantly higher number have meaningful employment in the same EDR as their high school than expected - 2,064 observed vs. 1,578 expected.
* A significantly larger proportion of individuals that attend post secondary but never graduated had meaningful employment in the same EDR as their high school two years after graduating - 27.6%.
* These same individuals had a significantly higher number of people have meaningful employment in the same EDR as their high school seven years after graduating - 2,104 observed vs. 1,713 expected.
* A significantly lower proportion of individuals that graduated from a public, 4 year college had meaningful employment in the same EDR as their high school two years after graduation - 8.7%.
* These same individuals had a significantly lower number of people that had meaningful employment in the same EDR as their high school - 619 observed vs. 1,603 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school two years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .238 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in the same EDR as their high school - 27.6% of individuals with Associate degree and 29.2% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in the same EDR as their high school than expected - 1,080 observed vs. 880 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in the same EDR as their high school than expected - 5,387 observed vs. 4,148 expected.

<br>


#### ps.grad

```{r ps.grad ct edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

#### attended.ps

```{r attended ps edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level edr grad year plus 2}
tab_xtab(var.row = master.grad.year.2.edr.ct$`EDR match`, var.col = master.grad.year.2.edr.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

## Cross tabs - Time X = grad year +7

```{r master ct edr grad year plus 7}
master.grad.year.7.edr.ct <- updated.master %>%
  select(hs.grad.year.7.edr.match, updated.independent.var.names) %>%
  filter(hs.grad.year.7.edr.match != "After 2019") %>%
  filter(hs.grad.year.7.edr.match != "Unknown") %>%
  droplevels() %>%
  mutate(hs.grad.year.7.edr.match = as.factor(hs.grad.year.7.edr.match)) %>%
  rename(`EDR match` = 1) %>%
  mutate(`EDR match` = ifelse(`EDR match` == "Location match", "Match", "No match"))

```
<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate there is no relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after they graduate and the individual's race/ethnicity. 

#### Race/Ethnicity

```{r ct edr race and ethnicity gread year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```


<br>

### High school characteristics variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.049, indicating that the relationships are weak. Highlights from the table include;

* Individuals from urban/town/rural mix high schools had a significantly lower proportion of individuals that had meaningful employment in the same EDR as their high school - 22.6% compared to 29.0% in entirely rural and 28.5% in town/rural mix.
* Individuals from urban/town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in the same EDR as their high school - 582 observed vs. 713 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value however is only 0.075, indicating the associations are weak. Highlights in the table include;

* EDR 6W had the lowest proportion of individuals that had meaningful employment in the same EDR as their high school seven years after graduation - 21.7% compared to 30.7% in EDR 8 and 27.2% in EDR 6E. 
* EDR 6W had a significantly lower number of individuals that had meaningful employment in the same EDR as their high school seven years after graduation - 717 observed vs. 913 expected.

<br>

**avg.unemployment.rate:** The p-value  does indicate a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and the average unemployment rate in their high school county. The boxplots show that individuals who had meaningful employment in the same EDR as their high school seven years after graduation more likely graduated from counties with a lower unemployment rate.

<br>

**wages.3year.avg:** The p-value indicates we can not reject the NULL hypothesis.

<br>

**avg.cte.intensity:** The p-value indicates we can not reject the NULL hypothesis.

<br>



#### Dem_Desc

```{r ct edr Dem_Desc grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct edr edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate edr grad year plus 7}
data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.unemp.rate, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `EDR match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state edr grad year plus 7}
data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`EDR match`, avg.wages.pct.state, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `EDR match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in EDR")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `EDR match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity edr grad year plus 7}
data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, avg.cte.intensity, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in County")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `EDR match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the null hypothesis.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .070 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in the same EDR as their high school seven years after graduation - 29.4% vs. 22% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in the same EDR as their high school seven years after graduation - 3,706 observed vs. 3,487 expected.

<br>

**non.english.home:** The p-value indicates that we can not reject the NULL hypothesis. 

<br>

**english.learner**: The p-value indicates that we can not reject the NULL hypothesis. 

#### LimitedEnglishProficiencyIndicator

```{r ct edr limitedenglishproficiencyindicator grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct edr pseo grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct edr non english home grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct edr english learner grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .108 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 33.6% vs 23.7% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in the same EDR as their high school - 2,189 observed vs. 1,800 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .094 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in the same EDR as their high school - 29.5% vs 18.0% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in the same EDR as their high school - 4,097 observed vs. 3,842 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and the number of CTE courses an individual has taken. The boxplot shows that individuals that have maningful employment in the same EDR as their high school seven years after graduation likely took more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .113 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in the same EDR as their high school - 31.9% vs. 25.8% for CTE participant and 19.2% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in the same EDR as their high school than what was expected - 2,785 observed vs. 2411 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school seven years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school seven years after graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in the same EDR as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in the same EDR as their high school seven years after graduation.

<br>

#### took.ACT

```{r ct edr act taken grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct edr ap exam grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses edr grad year plus 7}

data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, total.cte.courses.taken, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in EDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `EDR match`, data = data)

```

<br>

#### cte.achievement

```{r ct edr cte achievement grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math edr grad year plus 7}

data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.M, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `EDR match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading edr grad year plus 7}
data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.R, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `EDR match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science edr grad year plus 7}
data <- master.grad.year.7.edr.ct %>%
  select(`EDR match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`EDR match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`EDR match`, MCA.S, fill = `EDR match`, group = `EDR match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `EDR match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `EDR match`, data = data)


```

<br>

### Post-secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .043 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in the same EDR as their high school - 29.8% vs 25.9% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in the same EDR as their high school - 2,149 observed vs. 1,992 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .026 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in the same EDR as their high school - 29.8% vs 27% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in the same EDR as their high school - 1,056 observed vs. 978 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .178 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in the same EDR as their high school seven years after graduation - 39.5%.
* This same group of individuals had more people with meaningful employment in the same EDR as their high school than expected - 1,159 vs. 810 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in the same EDR as their high school seven years after graduating - 29.8%.
* These same individuals a significantly higher number have meaningful employment in the same EDR as their high school than expected - 1,056 observed vs. 978 expected.
* A significantly larger proportion of individuals that attend post secondary but never graduated had meaningful employment in the same EDR as their high school seven years after graduating - 29.9%.
* These same individuals had a significantly higher number of people have meaningful employment in the same EDR as their high school seven years after graduating - 1,113 observed vs. 1,029 expected.
* A significantly lower proportion of individuals that graduated from a 2 - Private not-for-profit, 4-year or above had meaningful employment in the same EDR as their high school seven years after graduation - 11.4%.
* These same individuals had a significantly lower number of people that had meaningful employment in the same EDR as their high school - 158 observed vs. 381 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in the same EDR as their high school seven years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .157 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in the same EDR as their high school - 34.7% of individuals with Associate degree and 31.7% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in the same EDR as their high school than expected - 703 observed vs. 559 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in the same EDR as their high school than expected - 2,970 observed vs. 2,585 expected.

<br>


#### ps.grad

```{r ps.grad ct edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

#### attended.ps

```{r attended ps edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level edr grad year plus 7}
tab_xtab(var.row = master.grad.year.7.edr.ct$`EDR match`, var.col = master.grad.year.7.edr.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

# Location match - region

<br>

## Summary chart

The chart below provides the percentage of individuals in the dataset that had meaningful employment in one of the three research EDRs the year of their graduation, graduation year +2, and graduation year +7. The percentage of individuals does increase with each subsequent time X - 16.2% the year of gradation, 25.4% two years after graduation, and 32.1% seven years after graduation.

<br>

```{r summary region grad year}
region.match.summary <- updated.master %>%
  select(PersonID, hs.grad.year.region.match, hs.grad.year.2.region.match, hs.grad.year.7.region.match) %>%
  gather(key = "key", value = "value", 2:4) %>%
  filter(value != "Unknown") %>%
  filter(value != "After 2019") %>%
  mutate(value = ifelse(value == "Location match", "Match", "No match")) %>%
  group_by(key, value) %>%
  summarize(n = n()) %>%
  ungroup() %>%
  group_by(key) %>%
  mutate(pct = n / sum(n)) %>%
  ungroup() %>%
  mutate(key = ifelse(str_detect(key, "2"), "grad year +2",
                      ifelse(str_detect(key, "7"), "grad year +7", "grad year +0")),
         key = fct_relevel(key, "grad year +0", "grad year +2", "grad year +7"),
         data_id = seq(n()))
                                      

region.match.summary.plot <- ggplot(region.match.summary, aes(value, pct, fill = key, group = key)) +
  geom_col_interactive(position = "dodge", aes(data_id = data_id, tooltip = paste(key, "\n", value, ": ", percent(pct, accuracy = .1), sep = ""))) +
  geom_label(aes(label = percent(pct, accuracy = .1)), show.legend = FALSE, color = "white", size = 5, position = position_dodge(width = .9)) +
  labs(x="", y = "", color="", title = "Meaningful employment in same region as high school for each\ntime X as share of total individuals", subtitle = "The percentage of individuals with meaningful employment in same region as their high\nschool increases for each subsequent Time X")+
  scale_y_continuous(labels=scales::percent)+
  theme_bar+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu"),
                    guide = guide_legend(ncol = 3)) +
  theme(legend.position = "bottom",
        text = element_text(size = 18))


girafe(ggobj = region.match.summary.plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))      

```

<br>

## Cross tabs - Time X = grad year

```{r master ct region grad year}
master.grad.year.region.ct <- updated.master %>%
  select(hs.grad.year.region.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.region.match != "Unknown") %>%
  filter(hs.grad.year.region.match != "After 2019") %>%
  droplevels() %>%
  rename(`Region match` = 1) %>%
  mutate(`Region match` = ifelse(`Region match` == "Location match", "Match", "No match")) %>%
  drop_na(`Region match`)

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in one of the three EDRs the year they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.063, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (19.8%) had meaningful employment in one of the three EDRs compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in one of the three EDRs than what was expected - 148 individuals vs. 121 expected.
* A larger proportion of hispanic individuals (24.1%) had meaningful employment in one of the three EDRs compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in one of the three EDRs than what was expected - 665 observed vs. 445 expected.

#### Race/Ethnicity

```{r ct region race and ethnicity}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.058, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in one of the three EDRs - 17.6% compared to 13.1% in entirely rural and 12.7% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in one of the three EDRs - 4,674 observed vs. 4,300 expected.

<br>

**EDR:** The p-value indicates that we can not reject the null hypothesis.

<br>

**avg.unemployment.rate:** The p-value  does indicate a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and the average unemployment rate in their high school county. The boxplot shows that individuals with meaningful employment in one of the three EDRs likely graduated in a county with slightly lower unemployment. But it is minimal.

<br>

**avg.wages.pct.state:** No relationship.

<br>

**avg.cte.intensity:** No relationship.

<br>


#### Dem_Desc

```{r ct region Dem_Desc}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct region region}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate region}
data <- master.grad.year.region.ct %>%
  select(`Region match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.unemp.rate, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `Region match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state region}
data <- master.grad.year.region.ct %>%
  select(`Region match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`Region match`, avg.wages.pct.state, fill = `Region match`, group = `Region match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `Region match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in on of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `Region match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity region}
data <- master.grad.year.region.ct %>%
  select(`Region match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.cte.intensity, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `Region match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and if the individual has limited english proficiency. However, the Cramer's V^2 value is only .024 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that had limited english proficiency had meaningful employment in one of the three EDRs the year of graduation - 22.2% vs. 16.0% for individuals that did not have limited english proficiency.
* A significantly larger number of individuals with limited english proficiency worked in one of the three EDRs than expected - 179 observed vs. 130 expected.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .107 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in one of the three EDRs the year of graduation - 19.0% vs. 10.7% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in one of the three EDRs the year of graduation - 4,743 observed vs. 4,027 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .056 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in one of the three EDRs the year of graduation - 22.8% vs. 15.5% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 756 observed vs. 536 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .032 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in one of the three EDRs - 21.1% vs. 15.9% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 437 observed vs. 334 expected.

<br>

#### LimitedEnglishProficiencyIndicator

```{r ct region limitedenglishproficiencyindicator}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct region pseo}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct region non english home}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct region english learner}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .132 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 23.0% vs 12.7% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 2,917 observed vs. 2,046 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .087 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in one of the three EDRs - 17.5% vs 8.8% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in one of the three EDRs - 5,637 observed vs. 5,192 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and the number of CTE courses an individual has taken. The boxplot shows that individuals that had meaningful employment in one of the three EDRs the year of graduation were more likely to have taken more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs the year of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .085 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in one of the three EDRs - 19.2% vs. 15.0% for CTE participant and 11.6% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in one of the three EDRs than what was expected - 3,432 observed vs. 2,887 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs the year of graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs the year of graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs  and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs the year of graduation.

<br>

#### took.ACT

```{r ct region act taken}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct region ap exam}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses region}

data <- master.grad.year.region.ct %>%
  select(`Region match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, total.cte.courses.taken, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in one of three EDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `Region match`, data = data)

```

<br>

#### cte.achievement

```{r ct region cte achievement}
tab_xtab(var.row = master.grad.year.region.ct$`Region match`, var.col = master.grad.year.region.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math region}

data <- master.grad.year.region.ct %>%
  select(`Region match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.M, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `Region match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading region}
data <- master.grad.year.region.ct %>%
  select(`Region match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.R, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `Region match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science region}
data <- master.grad.year.region.ct %>%
  select(`Region match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.S, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `Region match`, data = data)


```

<br>

## Cross tabs - Time X = grad year +2

```{r master ct region grad year plus 2}
master.grad.year.2.region.ct <- updated.master %>%
  select(hs.grad.year.2.region.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.2.region.match != "Unknown") %>%
  filter(hs.grad.year.2.region.match != "After 2019") %>%
  droplevels() %>%
  rename(`Region match` = 1) %>%
  mutate(`Region match` = ifelse(`Region match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in one of the three EDRs two years after they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.058, indicating a weak association. Highlights in the table include;

* A larger proportion of hispanic individuals (34.4%) had meaningful employment in their high school EDR compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same EDR as their high school than what was expected - 710 observed vs. 524 expected.

#### Race/Ethnicity

```{r ct region race and ethnicity grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.063, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in one of the three EDRs - 27.2% compared to 21.8% in entirely rural and 20.8% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in one of the three EDRs - 5,996 observed vs. 5,593 expected.

<br>

**EDR:** The p-value indicates that we can not reject the null hypothesis.

<br>

**avg.unemployment.rate:** There is no relationship

<br>

**avg.wages.pct.state:** There is no relationship.

<br>

**avg.cte.intensity:** There is no relationship



#### Dem_Desc

```{r ct region Dem_Desc grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct region region grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate region grad year plus 2}
data <- master.grad.year.2.region.ct %>%
  select(`Region match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.unemp.rate, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `Region match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state region grad year plus 2}
data <- master.grad.year.2.region.ct %>%
  select(`Region match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`Region match`, avg.wages.pct.state, fill = `Region match`, group = `Region match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `Region match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in on of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `Region match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity region grad year plus 2}
data <- master.grad.year.2.region.ct %>%
  select(`Region match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.cte.intensity, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `Region match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the NULL hypothesis.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .135 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in one of the three EDRs two years after graduation - 29.5% vs. 16.9% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in one of the three EDRs two years after graduation - 6,311 observed vs. 5,532 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .037 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in one of the three EDRs two years after graduation - 30.8% vs. 24.9% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 798 observed vs. 658 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .030 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in one of the three EDRs - 31.0% vs. 25.1% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 490 observed vs. 401 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct region limitedenglishproficiencyindicator grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct region pseo grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct region non english home grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct region english learner grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .177 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 35.8% vs 19.7% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 4,029 observed vs. 2,858 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .121 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in one of the three EDRs - 27.7% vs 13.2% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in one of the three EDRs - 7407 observed vs. 6,796 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and the number of CTE courses an individual has taken. The boxplot shows that individuals with meaningful employment in one of the three EDRs two years after graduation more likely took more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .119 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in one of the three EDRs - 30.1% vs. 24.5% for CTE participant and 14.2% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in one of the three EDRs than what was expected - 4,421 observed vs. 3,723 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs two years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs two years after graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs  and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs two years after graduation.

<br>

#### took.ACT

```{r ct region act taken grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct region ap exam grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses region grad year plus 2}

data <- master.grad.year.2.region.ct %>%
  select(`Region match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, total.cte.courses.taken, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in one of three EDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `Region match`, data = data)

```

<br>

#### cte.achievement

```{r ct region cte achievement grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math region grad year plus 2}

data <- master.grad.year.2.region.ct %>%
  select(`Region match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.M, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `Region match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading region grad year plus 2}
data <- master.grad.year.2.region.ct %>%
  select(`Region match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.R, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `Region match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science region grad year plus 2}
data <- master.grad.year.2.region.ct %>%
  select(`Region match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.S, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `Region match`, data = data)


```

<br>


### Post secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .143 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in one of the three EDRs - 32.1% vs 19.7% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in one of the three EDRs - 4,683 observed vs. 3,699 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .096 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in one of the three EDRs - 33.2% vs 23.2% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in one of the three EDRs - 2,333 observed vs. 1,781 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .277 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in one of the three EDRs two years after graduation - 38.8%.
* This same group of individuals had more people with meaningful employment in one of the three EDRs than expected - 2,192 vs. 1,434 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in one of the three EDRs two years after graduating - 33.2%.
* These same individuals a significantly higher number have meaningful employment in one of the three EDRs than expected - 2,333 observed vs. 1,781 expected.
* A significantly lower proportion of individuals that graduated from a public, 4 year college had meaningful employment in one of the three EDRs two years after graduation - 9.8%.
* These same individuals had a significantly lower number of people that had meaningful employment in one of the three EDRs - 700 observed vs. 1,810 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs two years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .259 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in one of the three EDRs - 31.1% of individuals with Associate degree and 33.0% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in one of the three EDRs than expected - 1,218 observed vs. 993 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in one of the three EDRs than expected - 6,090 observed vs. 4,684 expected.

<br>


#### ps.grad

```{r ps.grad ct region grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

#### attended.ps

```{r attended ps region grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector region grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level region grad year plus 2}
tab_xtab(var.row = master.grad.year.2.region.ct$`Region match`, var.col = master.grad.year.2.region.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

## Cross tabs - Time X = grad year +7

```{r master ct region grad year plus 7}
master.grad.year.7.region.ct <- updated.master %>%
  select(hs.grad.year.7.region.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.7.region.match != "Unknown") %>%
  filter(hs.grad.year.7.region.match != "After 2019") %>%
  droplevels() %>%
  rename(`Region match` = 1) %>%
  mutate(`Region match` = ifelse(`Region match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.031, indicating a weak association. Highlights in the table include;

* A smaller proportion of black individuals (22.7%) had meaningful employment in their high school region compared to all other races/ethnicities. 
* A smaller observed number of black individuals had meaningful employment in the same EDR as their high school than what was expected - 39 observed vs. 55 expected.

#### Race/Ethnicity

```{r ct region race and ethnicity grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.080, indicating that the relationships are weak. Highlights from the table include;

* Individuals from urban/town/rural mix high schools had a significantly lower proportion of individuals that had meaningful employment in one of the three EDRs - 23.4% compared to 33.2% in entirely rural and 33.8% in town/rural mix.
* Individuals from urban/town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in one of the three EDRs - 605 observed vs. 828 expected.

<br>

**EDR:** The p-value indicates we can reject the null hypothesis and accept taht the high school EDR is related to whether an individual has meaningful employment in one of the three EDRs seven years after graduating. Highlights include;

* EDR 6E has a significantly lower proportion of individuals with meaningful employment in one of the three EDRs compared to the other EDRs - 29.7% vs. 33.4% in EDR 6W, and 33.6% in EDR 8. It also had a lower number of observed than expected - 1,799 observed vs. 1,946 expected.

<br>

**avg.unemployment.rate:** No relationship 

<br>

**avg.wages.pct.state:** The p-value  does indicate a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and the average wages in their high school county as a percent of the state average wages. The boxplot shows that individuals with meaningful employment in one of the three EDRs seven years after graduation were more likely graduated from counties with a lower percentage.

<br>

**avg.cte.intensity:** There is no relationship.



#### Dem_Desc

```{r ct region Dem_Desc grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct region region grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate region grad year plus 7}
data <- master.grad.year.7.region.ct %>%
  select(`Region match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.unemp.rate, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `Region match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state region grad year plus 7}
data <- master.grad.year.7.region.ct %>%
  select(`Region match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`Region match`, avg.wages.pct.state, fill = `Region match`, group = `Region match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `Region match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in on of three EDRs")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `Region match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity region grad year plus 7}
data <- master.grad.year.7.region.ct %>%
  select(`Region match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, avg.cte.intensity, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in one of three EDRs")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `Region match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can not reject the NULL hypothesis.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .067 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in one of the three EDRs seven years after graduation - 33.8% vs. 26.5% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in one of the three EDRs seven years after graduation - 4,272 observed vs. 4,053 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .021 indicating a weak relationship. Highlights from the table include;

* A significantly smaller proportion of individuals where english wasn't the primary language at home had meaningful employment in one of the three EDRs the year of graduation - 28.4% vs. 32.4% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 317 observed vs. 358 expected.

<br>

**english.learner**: The p-value indicates that we can not reject the NULL hypothesis.

<br>

#### LimitedEnglishProficiencyIndicator

```{r ct region limitedenglishproficiencyindicator grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct region pseo grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct region non english home grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct region english learner grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .109 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 38.4% vs 28.0% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in one of the three EDRs - 2,503 observed vs. 2,092 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .104 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in one of the three EDRs - 34.2% vs 21.0% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in one of the three EDRs - 4,758 observed vs. 4,465 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and the number of CTE courses an individual has taken. The boxplot shows that individuals with meaningful employment in one of the three EDRs seven years after graduation were likely to have taken more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .121 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in one of the three EDRs - 36.8% vs. 30.2% for CTE participant and 22.6% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in one of the three EDRs than what was expected - 3,217 observed vs. 2,802 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs as their high school and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs seven years after graduation.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs seven years after graduation.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in one of the three EDRs  and their MCA math score. The boxplots show that the lower the scores, the more likely to have meaningful employment in one of the three EDRs seven years after graduation.

<br>

<br>

#### took.ACT

```{r ct region act taken grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct region ap exam grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses region grad year plus 7}

data <- master.grad.year.7.region.ct %>%
  select(`Region match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, total.cte.courses.taken, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in Region")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `Region match`, data = data)

```

<br>

#### cte.achievement

```{r ct region cte achievement grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math region grad year plus 7}

data <- master.grad.year.7.region.ct %>%
  select(`Region match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.M, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `Region match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading region grad year plus 7}
data <- master.grad.year.7.region.ct %>%
  select(`Region match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.R, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `Region match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science region grad year plus 7}
data <- master.grad.year.7.region.ct %>%
  select(`Region match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`Region match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`Region match`, MCA.S, fill = `Region match`, group = `Region match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `Region match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nEDR")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `Region match`, data = data)


```

<br>

### Post secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .035 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in one of the three EDRs - 33.9% vs 30.7% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in one of the three EDRs - 2,448 observed vs. 2,315 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .021 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in one of the three EDRs - 33.9% vs 31.6% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in one of the three EDRs - 1,202 observed vs. 1,137 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .188 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in one of the three EDRs seven years after graduation - 45.8%.
* This same group of individuals had more people with meaningful employment in one of the three EDRs than expected - 1,341 vs. 941 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in one of the three EDRs seven years after graduating - 33.9%.
* These same individuals a significantly higher number have meaningful employment in one of the three EDRs than expected - 1,202 observed vs. 1,137 expected.
* A significantly lower proportion of individuals that graduated from a private, 4 year college had meaningful employment in one of the three EDRs seven years after graduation - 13.3%.
* These same individuals had a significantly lower number of people that had meaningful employment in one of the three EDRs - 183 observed vs. 443 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in one of the three EDRs seven years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .156 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in one of the three EDRs - 39.9% of individuals with Associate degree and 36.3% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in one of the three EDRs than expected - 808 observed vs. 650 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in one of the three EDRs than expected - 3,394 observed vs. 3004 expected.

<br>


#### ps.grad

```{r ps.grad ct region grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```


<br>

#### attended.ps

```{r attended ps region grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector region grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level region grad year plus 7}
tab_xtab(var.row = master.grad.year.7.region.ct$`Region match`, var.col = master.grad.year.7.region.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

# Location match - Minnesota

## Summary chart

The chart below provides the percentage of individuals in the dataset that had meaningful employment in Minnesota the year of their graduation, graduation year +2, and graduation year +7. The percentage of individuals does increase with each subsequent time X - 19.6% the year of gradation, 34.8% two years after graduation, and 56.6% seven years after graduation.

<br>

```{r summary MN grad year}
mn.match.summary <- updated.master %>%
  select(PersonID, hs.grad.year.state.match, hs.grad.year.2.state.match, hs.grad.year.7.state.match) %>%
  gather(key = "key", value = "value", 2:4) %>%
  filter(value != "Unknown") %>%
  filter(value != "After 2019") %>%
  mutate(value = ifelse(value == "Location match", "Match", "No match")) %>%
  group_by(key, value) %>%
  summarize(n = n()) %>%
  ungroup() %>%
  group_by(key) %>%
  mutate(pct = n / sum(n)) %>%
  ungroup() %>%
  mutate(key = ifelse(str_detect(key, "2"), "grad year +2",
                      ifelse(str_detect(key, "7"), "grad year +7", "grad year +0")),
         key = fct_relevel(key, "grad year +0", "grad year +2", "grad year +7"),
         data_id = seq(n()))
                                      

mn.match.summary.plot <- ggplot(mn.match.summary, aes(value, pct, fill = key, group = key)) +
  geom_col_interactive(position = "dodge", aes(data_id = data_id, tooltip = paste(key, "\n", value, ": ", percent(pct, accuracy = .1), sep = ""))) +
  geom_label(aes(label = percent(pct, accuracy = .1)), show.legend = FALSE, color = "white", size = 5, position = position_dodge(width = .9)) +
  labs(x="", y = "", color="", title = "Meaningful employment in Minnesota as high school for each\ntime X as share of total individuals", subtitle = "The percentage of individuals with meaningful employment in Minnesota as their high\nschool increases for each subsequent Time X")+
  scale_y_continuous(labels=scales::percent)+
  theme_bar+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu"),
                    guide = guide_legend(ncol = 3)) +
  theme(legend.position = "bottom",
        text = element_text(size = 18))


girafe(ggobj = mn.match.summary.plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))      

```

<br>

## Cross tabs - Time X = grad year +0

```{r master ct mn grad year}
master.grad.year.mn.ct <- updated.master %>%
  select(hs.grad.year.state.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.state.match != "Unknown") %>%
  filter(hs.grad.year.state.match != "After 2019") %>%
  filter(RaceEthnicity != "Unknown") %>%
  droplevels() %>%
  rename(`MN match` = 1) %>%
  mutate(`MN match` = ifelse(`MN match` == "Location match", "Match", "No match"))

```

<br>

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in MN the year they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.062, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (24.9%) had meaningful employment in Minnesota compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in Minnesota than what was expected - 186 individuals vs. 146 expected.
* A larger proportion of hispanic individuals (27.8%) had meaningful employment in Minnesota compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in Minnesotathan what was expected - 762 observed vs. 537 expected.

#### Race/Ethnicity

```{r ct MN race and ethnicity}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.054, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in Minnesota - 20.9% compared to 15.3% in entirely rural and 17.5% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in Minnesota - 5,549 observed vs. 5,189 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that there may be a relationship between the EDR of an individuals high school and whether they have meaningful employment in Minnesota the year of graduation. Highlights include;

* EDR 8 has a significantly lower proportion of individuals that have meaningful employment in Minnesota the year of graduation - 17.9% compared to 18.8% in EDR 6W and 22% in EDR 6E.
* The observed number in EDR 8 is significantly lower - 3,008 observed vs. 3,284 expected.

<br>

**avg.unemployment.rate:** No relationship

<br>

**avg.wages.pct.state:** The p-value indicates that we can reject the NULL hypothesis and acknowledge that there may be a relationship between the average wages in the high school county as a percent of the state average wages and whether they have meaningful employment in Minnesota. The boxplot shows that there is a larger variation.

<br>

**avg.cte.intensity:** There is no relationship



#### Dem_Desc

```{r ct mn Dem_Desc}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct mn mn}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate mn}
data <- master.grad.year.mn.ct %>%
  select(`MN match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.unemp.rate, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `MN match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state mn}
data <- master.grad.year.mn.ct %>%
  select(`MN match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`MN match`, avg.wages.pct.state, fill = `MN match`, group = `MN match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `MN match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `MN match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity mn}
data <- master.grad.year.mn.ct %>%
  select(`MN match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.cte.intensity, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `MN match`, data = data)

```

<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota the year of graduation and if the individual has limited english proficiency. However, the Cramer's V^2 value is only .024 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that had limited english proficiency had meaningful employment in Minnesota the year of graduation - 22.2% vs. 16.0% for individuals that did not have limited english proficiency.
* A significantly larger number of individuals with limited english proficiency worked in Minnesota than expected - 179 observed vs. 130 expected.

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota the year of graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .107 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in Minnesota the year of graduation - 19.0% vs. 10.7% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in Minnesota the year of graduation - 4,743 observed vs. 4,027 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesotathe year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .056 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in Minnesota the year of graduation - 22.8% vs. 15.5% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 756 observed vs. 536 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota the year of graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .032 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in Minnesota - 21.1% vs. 15.9% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 437 observed vs. 334 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct mn limitedenglishproficiencyindicator}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")

```

<br>

#### pseo.participant

```{r ct mn pseo}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct mn non english home}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct mn english learner}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesotathe year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .132 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in Minnesota - 23.0% vs 12.7% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in Minnesota - 2,917 observed vs. 2,046 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota the year of graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .087 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in Minnesota - 17.5% vs 8.8% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in Minnesota - 5,637 observed vs. 5,192 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual has meaningful employment in Minnesota and the number of CTE courses an individual has taken. The boxplot shows that individuals with meaningful employment in Minnesota more likely had taken more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota the year of graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .085 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in Minnesota - 19.2% vs. 15.0% for CTE participant and 11.6% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in Minnesota than what was expected - 3,432 observed vs. 2,887 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota  and their MCA math score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota the year of graduation if their MCA-Math score was lower.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA reading score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota the year of graduation if their MCA-reading score was lower.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA science score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota the year of graduation if their MCA-science score was lower.

<br>

#### took.ACT

```{r ct mn act taken}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct mn ap exam}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses mn}

data <- master.grad.year.mn.ct %>%
  select(`MN match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, total.cte.courses.taken, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `MN match`, data = data)

```

<br>

#### cte.achievement

```{r ct mn cte achievement}
tab_xtab(var.row = master.grad.year.mn.ct$`MN match`, var.col = master.grad.year.mn.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math mn}

data <- master.grad.year.mn.ct %>%
  select(`MN match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.M, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `MN match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading mn}
data <- master.grad.year.mn.ct %>%
  select(`MN match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.R, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `MN match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science mn}
data <- master.grad.year.mn.ct %>%
  select(`MN match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.S, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `MN match`, data = data)


```

<br>

## Cross tabs - Time X = grad year +2

```{r master ct mn grad year plus 2}
master.grad.year.2.mn.ct <- updated.master %>%
  select(hs.grad.year.2.state.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.2.state.match != "Unknown") %>%
  filter(hs.grad.year.2.state.match != "After 2019") %>%
  filter(RaceEthnicity != "Unknown") %>%
  droplevels() %>%
  rename(`MN match` = 1) %>%
  mutate(`MN match` = ifelse(`MN match` == "Location match", "Match", "No match"))

```

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in MN two years after they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.046, indicating a weak association. Highlights in the table include;

* A larger proportion of black individuals (39.8%) had meaningful employment in their high school EDR compared to AI, Asian/PI and White individuals. 
* A larger observed number of Black individuals had meaningful employment in the same EDR as their high school than what was expected - 214 individuals vs. 187 expected.
* A larger proportion of hispanic individuals (42.2%) had meaningful employment in their high school EDR compared to all other races/ethnicities. 
* A larger observed number of hispanic individuals had meaningful employment in the same EDR as their high school than what was expected - 871 observed vs. 717 expected.

#### Race/Ethnicity

```{r ct MN race and ethnicity grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can reject the null hypothesis and acknowledge that the variables may have a relationship. The Cramer's V^2 value is only 0.045, indicating that the relationships are weak. Highlights from the table include;

* Individuals from town/rural mix high schools had a significantly higher proportion of individuals that had meaningful employment in Minnesota two years after graduation - 36.0% compared to 30% in entirely rural and 33.7% in urban/town/rural mix.
* Individuals from town/rural mix high schools had a significantly lower observed number of individuals that had meaningful employment in Minnesota two years after graduation - 7,939 observed vs. 7,661 expected.

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that there may be a relationship between the EDR of an individuals high school and whether they have meaningful employment in Minnesota two years after graduation. Highlights include;

* EDR 8 has a significantly lower proportion of individuals that have meaningful employment in Minnesota two years after graduation - 32.1% compared to 34.1% in EDR 6W and 38.3% in EDR 6E.
* The observed number in EDR 8 is significantly lower - 4,481 observed vs. 4,856 expected.

<br>

**avg.unemployment.rate:** The p-values indicates that we can reject the NULL hypothesis and acknowledge that there may be a relationship between the average unemployment rate of an individuals high school county and whether they have meaningful employment in Minnesota two years after graduation. The boxplot shows that individuals with meaningful employment in Minnesota two years after graduation had a higher unemployment rate in their high school county.

<br>

**avg.wages.pct.state:** The p-value indicates that we can reject the NULL hypothesis and acknowledge that there may be a relationship between the average wages in the high school county as a percent of the state average wages and  whether they have meaningful employment in Minnesota two years after graduation. The boxplot shows that individuals with meaningful employment in Minnesota two years after graduation had higher avg wages as a percentage of the state average in their high school counties.

<br>

**avg.cte.intensity:** There is no relationship



#### Dem_Desc

```{r ct mn Dem_Desc grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct mn mn grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate mn grad year plus 2}
data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.unemp.rate, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = .07, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `MN match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state mn grad year plus 2}
data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`MN match`, avg.wages.pct.state, fill = `MN match`, group = `MN match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `MN match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `MN match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity mn grad year plus 2}
data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.cte.intensity, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `MN match`, data = data)

```


<br>

### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can NOT reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and if the individual has limited english proficiency. 

<br>

**pseo.participant:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether they participated in PSEO classes. However, the Cramer's V^2 value is only .127 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that did NOT participate in PSEO classes had meaningful employment in Minnesota two years after graduation - 39.0% vs. 26.1% for individuals that did participate in PSEO.
* A significantly larger number of individuals that did NOT participate in PSEO had meaningful employment in Minnesota two years after graduation - 8,345 observed vs. 7,441 expected.

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .033 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals where english wasn't the primary language at home had meaningful employment in Minnesota the year of graduation - 40.1% vs. 34.3% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 1,039 observed vs. 902 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .025 indicating a weak relationship. Highlights from the table include;

* A larger proportion of individuals categorized as english learners had meaningful employment in Minnesota - 40.0% vs. 34.5% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 631 observed vs. 549 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct mn limitedenglishproficiencyindicator grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")


```

<br>

#### pseo.participant

```{r ct mn pseo grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct mn non english home grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct mn english learner grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .172 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ACT had meaningful employment in Minnesota - 45.9% vs 28.7% of individuals that did take the ACT.
* a significantly larger number of individuals that did NOT take the ACT had meaningful employment in Minnesota - 5,164 observed vs. 3,915 expected.

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .135 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT take the ap exam had meaningful employment in Minnesota - 37.5% vs 19.9% of individuals that did take the AP exam.
* a significantly larger number of individuals that did NOT take the AP exam had meaningful employment in Minnesota - 10,054 observed vs. 9.309 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual has meaningful employment in Minnesota and the number of CTE courses an individual has taken. The boxplot shows that individuals with meaningful employment in Minnesota two years after graduationmore likely had taken more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .120 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in Minnesota - 40.0% vs. 33.9% for CTE participant and 25.6% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in Minnesota than what was expected - 5,865 observed vs. 5,099 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota  and their MCA math score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota two years after graduation if their MCA-Math score was lower.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA reading score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota two years after graduation if their MCA-reading score was lower.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA science score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota two years after graduation if their MCA-science score was lower.

<br>

#### took.ACT

```{r ct mn act taken grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct mn ap exam grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses mn grad year plus 2}

data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, total.cte.courses.taken, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `MN match`, data = data)

```

<br>

#### cte.achievement

```{r ct mn cte achievement grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math mn grad year plus 2}

data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.M, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `MN match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading mn grad year plus 2}
data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.R, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `MN match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science mn grad year plus 2}
data <- master.grad.year.2.mn.ct %>%
  select(`MN match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.S, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `MN match`, data = data)


```

<br>

### Post secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota  two years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .160 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT graduate from a post-secondary institution  had meaningful employment in Minnesota - 43.0% vs 27.8% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in Minnesota - 6,272 observed vs. 5,066 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .092 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did NOT attend post-secondary had meaningful employment in Minnesota - 43.0% vs 32.4% of individuals that attended a post-secondary institution.
* a significantly larger number of individuals that did NOT attend a post-secondary institution had meaningful employment in one of the three EDRs - 3,019 observed vs. 2,440 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .309 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in Minnesota two years after graduation - 50.8%.
* This same group of individuals had more people with meaningful employment in one of the three EDRs than expected - 2,868 vs. 1,965 expected.
* A significantly larger proportion of individuals that never attended post secondary had meaningful employment in Minnesota two years after graduating - 43.0%.
* These same individuals had a significantly higher number have meaningful employment in one of the three EDRs than expected - 3,019 observed vs. 2,440 expected.
* A significantly lower proportion of individuals that graduated from a public, 4 year college had meaningful employment in Minnesota two years after graduation - 16.3%.
* These same individuals had a significantly lower number of people that had meaningful employment in Minnesota - 1,160 observed vs. 2,480 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota two years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .288 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree or Less than Associate degree  had meaningful employment in Minnesota - 43.2% of individuals with Associate degree and 43.8% for individuals with less than associate degree. 
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in Minnesota than expected - 1,692 observed vs. 1,361 expected.
* a significantly larger number of individuals that received less than an Associate degree had meaningful employment in Minnesota than expected - 8,075 observed vs. 6,416 expected.

<br>


#### ps.grad

```{r ps.grad ct mn grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```


<br>

#### attended.ps

```{r attended ps mn grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector MN grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level MN grad year plus 2}
tab_xtab(var.row = master.grad.year.2.mn.ct$`MN match`, var.col = master.grad.year.2.mn.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

## Cross tabs - Time X = grad year +7

```{r master ct mn grad year plus 7}
master.grad.year.7.mn.ct <- updated.master %>%
  select(hs.grad.year.7.state.match, updated.independent.var.names) %>% 
  filter(hs.grad.year.7.state.match != "Unknown") %>%
  filter(hs.grad.year.7.state.match != "After 2019") %>%
  filter(RaceEthnicity != "Unknown") %>%
  droplevels() %>%
  rename(`MN match` = 1) %>%
  mutate(`MN match` = ifelse(`MN match` == "Location match", "Match", "No match"))

```

### Demographic variables{.tabset}

**Race/Ethnicity:** The crosstabs indicate a relationship between whether an individual has meaningful employment in MN seven years after they graduate and the individual's race/ethnicity. The p-value was 0, however the Cramer's V^2 value was 0.050, indicating a weak association. Highlights in the table include;

* A higher proportion of white individuals (57.3%) had meaningful employment in Minnesota compared to all other races and ethnicities. 
* A larger observed number of white individuals had meaningful employment in Minnesota than what was expected - 8,606 individuals vs. 8,493 expected.


#### Race/Ethnicity

```{r ct MN race and ethnicity grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$RaceEthnicity, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```


<br>

### High school characteristic variables{.tabset}

**Dem_Desc:** The p-value indicates that we can NOT reject the null hypothesis and acknowledge that the variables may have a relationship. 

<br>

**EDR:** The p-value indicates that we can reject the null hypothesis and acknowledge that there may be a relationship between the EDR of an individuals high school and whether they have meaningful employment in Minnesota seven years after graduation. Highlights include;

* EDR 8 has a significantly lower proportion of individuals that have meaningful employment in Minnesota seven years after graduation - 51.3% compared to 55.9% in EDR 6W and 63.2% in EDR 6E.
* The observed number in EDR 8 is significantly lower - 3,684 observed vs. 4,061 expected.

<br>

**avg.unemployment.rate:** The p-values indicates that we can reject the NULL hypothesis and acknowledge that there may be a relationship between the average unemployment rate of an individuals high school county and whether they have meaningful employment in Minnesota seven years after graduation. The boxplot shows that individuals with meaningful employment in Minnesota seven years after graduation had a higher unemployment rate in their high school county.

<br>

**avg.wages.pct.state:** The p-value indicates that we can reject the NULL hypothesis and acknowledge that there may be a relationship between the average wages in the high school county as a percent of the state average wages and  whether they have meaningful employment in Minnesota seven years after graduation. The boxplot shows that individuals with meaningful employment in Minnesota seven years after graduation had higher avg wages as a percentage of the state average in their high school counties.

<br>

**avg.cte.intensity:** The p-value indicates that we can NOT reject the NULL hypothesis.



#### Dem_Desc

```{r ct mn Dem_Desc grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$Dem_Desc, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### EDR

```{r ct mn mn grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$edr, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)
```

<br>

#### avg.unemployment.rate

```{r ct avg unemployment rate mn grad year plus 7}
data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, avg.unemp.rate) %>%
  mutate(avg.unemp.rate = avg.unemp.rate / 100)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.unemp.rate, .0),
            Q1 = quantile(avg.unemp.rate, .25),
            Median = median(avg.unemp.rate),
            Q3 = quantile(avg.unemp.rate, .75),
            Max = quantile(avg.unemp.rate, 1),
            Mean = mean(avg.unemp.rate)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.unemp.rate, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = .08, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average unemployment during high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.unemp.rate ~ `MN match`, data = data)
```

<br>

#### avg.wages.pct.state

```{r ct avg wages pct state mn grad year plus 7}
data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, avg.wages.pct.state) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.wages.pct.state, .0),
            Q1 = quantile(avg.wages.pct.state, .25),
            Median = median(avg.wages.pct.state),
            Q3 = quantile(avg.wages.pct.state, .75),
            Max = quantile(avg.wages.pct.state, 1),
            Mean = mean(avg.wages.pct.state)) %>%
  ungroup()

plot <- ggplot(data, aes(`MN match`, avg.wages.pct.state, fill = `MN match`, group = `MN match`)) +
  geom_boxplot() +
    geom_label(data = labels, aes(x = `MN match`, y = .78, label = paste("Min: ", percent(Min, accuracy = .1), "\nQ1: ", percent(Q1, accuracy = .1), "\nMedian: ", percent(Median, accuracy = .1), "\nQ3: ", percent(Q3, accuracy = .1), "\nMax: ", percent(Max, accuracy = ), "\nMean: ", percent(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average wages of high school county as a percent of the\nstate average wages by meaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::percent)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.wages.pct.state ~ `MN match`, data = data)
```


<br>

#### avg.cte.intensity

```{r avg cte intensity mn grad year plus 7}
data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, avg.cte.intensity) %>%
  drop_na(avg.cte.intensity)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(avg.cte.intensity, .0),
            Q1 = quantile(avg.cte.intensity, .25),
            Median = median(avg.cte.intensity),
            Q3 = quantile(avg.cte.intensity, .75),
            Max = quantile(avg.cte.intensity, 1),
            Mean = mean(avg.cte.intensity)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, avg.cte.intensity, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of average CTE intensity  in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(avg.cte.intensity ~ `MN match`, data = data)

```


<br>


### High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** The p-value indicates that we can  reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and if the individual has limited english proficiency. However, the Cramer's v-score was only .032 inidicating that this variable does not explain muh variance. Highlights include;

* A significantly lower percentage of individuals with limited english proficiency had meaningful employment in Minnesota seven years after graduation - 43.2% vs. 56.8% for individuals with no limited english proficiency. 
* This same group had a significant difference between observed and expected - 99 observed vs. 130 expected.

<br>

**pseo.participant:** The p-value indicates that we can NOT reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether they participated in PSEO classes. 

<br>

**non.english.home:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .040 indicating a weak relationship. Highlights from the table include;

* A significantly smaller proportion of individuals where english wasn't the primary language at home had meaningful employment in Minnesota seven years after graduation - 49.1% vs. 57.1% for individuals where English was the primary language at home.
* The observed vs expected was also significantly different for this group - 548 observed vs. 631 expected.

<br>

**english.learner**: The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual had someone in their home where english wasn't the primary language. However, the Cramer's V^2 value is only .045 indicating a weak relationship. Highlights from the table include;

* A smaller proportion of individuals categorized as english learners had meaningful employment in Minnesota - 44.3% vs. 57.0% of individuals not designated as english learners.
* This same group had a larger number of individuals that expected - 239 observed vs. 305 expected.

#### LimitedEnglishProficiencyIndicator

```{r ct mn limitedenglishproficiencyindicator grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$LimitedEnglishProficiencyIndicator, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE,
         statistics = "cramer")


```

<br>

#### pseo.participant

```{r ct mn pseo grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$pseo.participant, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### non.english.home

```{r ct mn non english home grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$non.english.home, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### english.learner

```{r ct mn english learner grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$english.learner, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

### High school accomplishments{.tabset}

**took.ACT:** The p-value indicates that we can NOT reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual took the ACT. 

<br>

**ap.exam:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual took the ACT. However, the Cramer's V^2 value is only .036 indicating a weak relationship. Highlights from the table include;

* a significantly smaller proportion of individuals that did  take the ap exam had meaningful employment in Minnesota - 52.4% vs 57.4% of individuals that did NOT take the AP exam.
* a significantly smaller number of individuals that did  take the AP exam had meaningful employment in Minnesota - 1,381 observed vs. 1,490 expected.

<br>

**total.cte.courses.taken:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual has meaningful employment in Minnesota and the number of CTE courses an individual has taken. The boxplot shows that individuals with meaningful employment in Minnesota seven years after graduation more likely had taken more CTE courses.

<br>

**cte.achievement:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and the level of CTE achievement. However, the Cramer's V^2 value is only .084 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that was either a CTE concentrator, or completor had meaningful employment in Minnesota - 59.9% vs. 56.0% for CTE participant and 49.1% for individuals with no CTE.
* This same group had a high number of individuals with meaningful employment in Minnesota than what was expected - 5,227 observed vs. 4,940 expected.

<br>

**MCA.M:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota  and their MCA math score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota seven years after graduation if their MCA-Math score was lower.

<br>

**MCA.R:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA reading score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota seven years after graduation if their MCA-reading score was lower.

<br>

**MCA.S:** The p-value indicates we can reject the null hypothesis and accept that there's a relationship between whether an individual works in Minnesota and their MCA science score. The boxplot shows that individuals were more likely to have meaningful employment in Minnesota seven years after graduation if their MCA-science score was lower.

<br>

#### took.ACT

```{r ct mn act taken grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$took.ACT, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ap.exam

```{r ct mn ap exam grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$ap.exam, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### total.cte.courses.taken

```{r ct total cte courses mn grad year plus 7}

data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, total.cte.courses.taken) 

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(total.cte.courses.taken, .0),
            Q1 = quantile(total.cte.courses.taken, .25),
            Median = median(total.cte.courses.taken),
            Q3 = quantile(total.cte.courses.taken, .75),
            Max = quantile(total.cte.courses.taken, 1),
            Mean = mean(total.cte.courses.taken)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, total.cte.courses.taken, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 20, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of total CTE courses taken in high school and\nmeaningful employment in Minnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(total.cte.courses.taken ~ `MN match`, data = data)

```

<br>

#### cte.achievement

```{r ct mn cte achievement grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$cte.achievement, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### MCA.M

```{r ct total MCA math mn grad year plus 7}

data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, MCA.M) %>%
  drop_na(MCA.M)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.M, .0),
            Q1 = quantile(MCA.M, .25),
            Median = median(MCA.M),
            Q3 = quantile(MCA.M, .75),
            Max = quantile(MCA.M, 1),
            Mean = mean(MCA.M)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.M, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Math scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.M ~ `MN match`, data = data)


```

<br>

#### MCA.R

```{r ct totat MCA reading mn grad year plus 7}
data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, MCA.R) %>%
  drop_na(MCA.R)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.R, .0),
            Q1 = quantile(MCA.R, .25),
            Median = median(MCA.R),
            Q3 = quantile(MCA.R, .75),
            Max = quantile(MCA.R, 1),
            Mean = mean(MCA.R)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.R, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.5, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Reading scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.R ~ `MN match`, data = data)


```

<br>

#### MCA.S

```{r ct totat MCA science mn grad year plus 7}
data <- master.grad.year.7.mn.ct %>%
  select(`MN match`, MCA.S) %>%
  drop_na(MCA.S)

labels <- data %>%
  group_by(`MN match`) %>%
  summarize(Min = quantile(MCA.S, .0),
            Q1 = quantile(MCA.S, .25),
            Median = median(MCA.S),
            Q3 = quantile(MCA.S, .75),
            Max = quantile(MCA.S, 1),
            Mean = mean(MCA.S)) %>%
  ungroup()
  
plot <- ggplot(data, aes(`MN match`, MCA.S, fill = `MN match`, group = `MN match`)) +
  geom_boxplot_interactive() +
  geom_label(data = labels, aes(x = `MN match`, y = 3.6, label = paste("Min: ", comma(Min, accuracy = .1), "\nQ1: ", comma(Q1, accuracy = .1), "\nMedian: ", comma(Median, accuracy = .1), "\nQ3: ", comma(Q3, accuracy = .1), "\nMax: ", comma(Max, accuracy = ), "\nMean: ", comma(Mean, accuracy = .1))), color = "white") +
  labs(x="", y = "", color="", title = "Boxplots of MCA - Science scores and meaningful employment in\nMinnesota")+
  scale_y_continuous(labels=scales::comma)+
  scale_fill_manual(values = brewer.pal(n = 6, "RdYlBu")) +
  theme_bar+
  theme(legend.position = "none",
        text = element_text(size = 18))


girafe(ggobj = plot, width_svg = 10, height_svg = 10) %>%
  girafe_options(opts_selection(type = "none"),
                 opts_sizing(rescale = FALSE))    


wilcox.test(MCA.S ~ `MN match`, data = data)


```

<br>

### Post secondary{.tabset}

**ps.grad:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual graduated from a post-secondary institution. However, the Cramer's V^2 value is only .068 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that did graduate from a post-secondary institution  had meaningful employment in Minnesota - 59.5% vs 52.8% of individuals that graduated from a post-secondary institution.
* a significantly larger number of individuals that did NOT graduate from a post-secondary institution had meaningful employment in Minnesota - 5,557 observed vs. 5,281 expected.

<br>

**attended.ps:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .074 indicating a weak relationship. Highlights from the table include;

* a significantly smaller proportion of individuals that did NOT attend post-secondary had meaningful employment in Minnesota - 49.6% vs 58.5% of individuals that attended a post-secondary institution.
* a significantly smaller number of individuals that did NOT attend a post-secondary institution had meaningful employment in one of the three EDRs - 1,757 observed vs. 2,004 expected.

<br>

**ps.grad.InstitutionSector:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the individual attended a post-secondary institution. However, the Cramer's V^2 value is only .120 indicating a weak relationship. Highlights from the table include;

* A significantly larger proportion of individuals that graduated from a public, 2-year institutions (code 4) had meaningful employment in Minnesota seven years after graduation - 66.9%.
* This same group of individuals had more people with meaningful employment in one of the three EDRs than expected - 1,960 vs. 1,659 expected.
* A significantly larger proportion of individuals that attended a private for-profit, 4-year institution had meaningful employment seven yars after graduation - 74%. 111 were observed and 85 were expected.
* A significantly lower proportion of individuals that never attended post-secondary had meaningful employment in Minnesota seven years after graduation - 49.6%. 1,757 observed vs. 2,004 expected.

<br>

**highest.cred.level:** The p-value indicates that we can reject the NULL hypothesis and acknowledge there may be a relationship between whether an individual has meaningful employment in Minnesota seven years after graduation and whether the highest credential an individual received. However, the Cramer's V^2 value is only .070 indicating a weak relationship. Highlights from the table include;

* a significantly larger proportion of individuals that received an Associate degree had meaningful employment in Minnesota - 65.6% of individuals with Associate degree.
* a significantly larger number of individuals that received an Associate degree  had meaningful employment in Minnesota than expected - 1,329 observed vs. 1,146 expected.


<br>


#### ps.grad

```{r ps.grad ct mn grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$ps.grad, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)


```


<br>

#### attended.ps

```{r attended ps mn grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$attended.ps, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### ps.grad.InstitutionSector

```{r ps grad institution sector MN grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$ps.grad.InstitutionSector, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

#### highest.cred.level

```{r highest cred level MN grad year plus 7}
tab_xtab(var.row = master.grad.year.7.mn.ct$`MN match`, var.col = master.grad.year.7.mn.ct$highest.cred.level, 
         title = "Test", 
         show.exp = TRUE,
         show.col.prc = TRUE)

```

<br>

# Summary

Okay, let's summarize all of this analysis. Below are tables that indicate which variables were significant (p-value < .01).

We will group variables by their themes/labels, for example we will start with Demographic variables, and then summarize the High school characteristics, etc.....

```{r pvalue summary table framework}
pvalue.summary.table.framework <- matrix(c("Grad year", "Grad year +0", "Grad year +2", "Grad year +7", "County", "", "", "", "EDR", "", "", "", "All 3 EDRs","", "", "", "MN", "", "", ""), ncol = 5) %>%
  row_to_names(1) %>%
  as.tibble()
```

<br>

## Demographic variables

The race and ethnicity variable provided significant differences pretty consistently across time and place. A couple of interesting things about this variable, however, is that the race and ethnicity  that experienced significant differences changes over time. For grad year +0, Hispanic and Black individuals had meaningful employment at a much higher rate than all other races. By grad year +7, that advantage decreased and there was much less difference. All other races were pretty equal. Interestingly, white individuals had an equal or higher rate of meaningful employment by grad year +7, especially at the MN level. 

<br>

```{r summary demographic}

dem.race.ethnicity.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c(0, 0, .007),
         EDR = c(0, 0, .093),
         `All 3 EDRs` = c(0, 0, .004),
         MN = c(0, 0, 0)) 

datatable(dem.race.ethnicity.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

## High school characteristic variables{.tabset}

**Dem_Desc:** At grad year +0, there was a higher proportion of individuals that graduated from a town/rural mix high school that had meaningful employment. By grad year +7, that separation was less significant. In particular, there became a higher proportion of individuals that graduated from a entirely rural high school that had meaningful employment.

**EDR:** For all grad years, EDR 6W consistently had a significantly lower proportion of individuals that had meaningful employment at the county and EDR level. However, that changed when looking at whether an individual had meaningful employment in any of the three EDRs where there was not much difference at all between the EDRs. Interestingly, when we get to the question of whether an individual has meaningful employment in Minnesota at any of the time X, EDR 8 - Southwest has a significantly lower proportion.

**avg.unemployment.rate:** This variable seems to have very little impact.

**avg.wages.pct.state"** This variable only seemed to have an impact when asking whether an individual had meaningful employment at the county and Minnesota level. When there was a relationship, the boxplots indicated that if the average wages of an individuals high school county made up a higher percentage of the state average then there was a higher liklihood that the individual had meaningful employment in their high school county and Minnesota.

**avg.cte.intensity:** This variable seems to have no impact.



<br>

### Dem_Desc

```{r summary hs characteristics dem_desc}

hschar.dem_desc.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c(0, 0, .007),
         EDR = c(0, 0, 0),
         `All 3 EDRs` = c(0, 0, 0),
         MN = c(0, 0, .072)) 

datatable(hschar.dem_desc.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### EDR

```{r summary hs characteristics EDR}

hschar.edr.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c(0, 0, 0),
         EDR = c(0, 0, 0),
         `All 3 EDRs` = c(.012, .639, 0),
         MN = c(0, 0, 0)) 

datatable(hschar.edr.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### avg.unemployment.rate

```{r summary hs characteristics average unemployment rate}

hschar.avg.unemployment.rate.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c(.01295, .0477, 0),
         EDR = c(.005401, .0195, 0),
         `All 3 EDRs` = c(.00818, .6165, .01565),
         MN = c(0.07123, 0, 0)) 

datatable(hschar.avg.unemployment.rate.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### avg.wages.pct.state

```{r summary hs characteristics average wages as pct of state avg}

hschar.avg.wages.pct.state.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c(0, 0, 0),
         EDR = c(0.01038, 0.2369, 0.03764),
         `All 3 EDRs` = c(0.02715, 0.4286, 0.001539),
         MN = c(0, 0.0002099, 0)) 

datatable(hschar.avg.wages.pct.state.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### avg.cte.intensity

```{r summary hs characteristics average cte intensity}

hschar.avg.cte.intensity.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c( 0.006514, 0.02743, 0.7816),
         EDR = c(0.0554, 0.3711, 0.9731),
         `All 3 EDRs` = c(0.6134, 0.9881, 0.9728),
         MN = c(0.1357, 0.9323, 0.116)) 

datatable(hschar.avg.cte.intensity.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

## High school enrollment variables{.tabset}

**LimitedEnglishProficiencyIndicator:** This variable was signifiacnt for grad year +0, but no other. It consistently showed that a larger proportion of individuals designated as having limited english proficiency had meaningful employment across all geographies.

**PSEO.participant:** This variable was consistently significantly different across time X and geographies. It always showed that a significantly larger proportion of individuals that participated in PSEO class(es) had meaningful employment across all geographies. The only time that wasn't the case was at time X = grad year +7 and if having meaningful employment in Minnesota. There was no statistically significant difference at that time X and for all meaningful employment in Minnesota.

**non.english.home:** A larger proportion of individuals that were categorized as having a non-english speaking home had meaningful employment at the time of graduation across all geographies, and two years after graduation. However, by seven years after graduation, that changed. There was no statistical difference for individuals having meaningful employment at the County or EDR level. And by seven years after graduation, there was a larger proportion of individuals that were NOT designated as having a non-english speaker at home that had meaningful employment in one of the three EDRs and Minnesota.

<br>

### LimitedEnglishProficiency

```{r summary hs enrollment limited english proficiency}

hsenroll.LimitedEnglishProficiencyIndicator.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c( 0, 0.032, 0.898),
         EDR = c(0, 0.025, 0.794),
         `All 3 EDRs` = c(0, 0.263, 0.199),
         MN = c(0, 0.265, 0)) 

datatable(hsenroll.LimitedEnglishProficiencyIndicator.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### PSEO.participant

```{r summary hs enrollment pseo participant}

hsenroll.pseo.participant.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c( 0, 0, 0),
         EDR = c(0, 0, 0),
         `All 3 EDRs` = c(0, 0, 0),
         MN = c(0, 0, 0.233)) 

datatable(hsenroll.pseo.participant.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>

### non.english.home

```{r summary hs enrollment non english home}

hsenroll.non.english.home.pvalues <- pvalue.summary.table.framework %>%
  mutate(County = c( 0, 0, 0.928),
         EDR = c(0, 0, 0.253),
         `All 3 EDRs` = c(0, 0, 0.007),
         MN = c(0, 0, 0)) 

datatable(hsenroll.non.english.home.pvalues, class = "cell-border stripe", filter = "top", rownames = FALSE,
          options = list(columnDefs = list(list(className = "dt-center", targets = 1:4)))) %>%
  formatCurrency(2:5, "", digits = 3) %>%
  formatStyle(c("County", "EDR", "All 3 EDRs", "MN"),
              backgroundColor = styleInterval(c(.01), c("#99CC33", "#fb9a99")))


```

<br>







