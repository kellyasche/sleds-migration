<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Analysis - local employment CART</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#section-TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#section-TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="section-TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CTE impacts on migration trends in SW Minnesota</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Summary of results</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Data prep and summaries
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="k12enrollment.html">K12Enrollment</a>
    </li>
    <li>
      <a href="k12orgs.html">K12Orgs</a>
    </li>
    <li>
      <a href="act.html">ACT</a>
    </li>
    <li>
      <a href="ap.html">AP</a>
    </li>
    <li>
      <a href="cteenrollment.html">CTEEnrollment</a>
    </li>
    <li>
      <a href="ctedemographics.html">CTEDemographics</a>
    </li>
    <li>
      <a href="cteintensity.html">CTEIntensity</a>
    </li>
    <li>
      <a href="assessments.html">Assessments</a>
    </li>
    <li>
      <a href="sat.html">SAT</a>
    </li>
    <li>
      <a href="nscenrollment.html">National Student Clearinghouse - enrollment</a>
    </li>
    <li>
      <a href="nsccompletions.html">National Student Clearinghouse - completions</a>
    </li>
    <li>
      <a href="employment.html">Employment</a>
    </li>
    <li>
      <a href="unemployment.html">Unemployment</a>
    </li>
    <li>
      <a href="avgwages.html">Average wages</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="analysis_multiple_correspondence.html">Analysis - multiple correspondence analysis</a>
    </li>
    <li>
      <a href="analysis_local_employment_ct.html">Local employment cross tabs</a>
    </li>
    <li>
      <a href="the_story.html">The story</a>
    </li>
    <li>
      <a href="analysis_local_employment_cart.html">Local employment CART analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="section-header">



<h1 class="title toc-ignore">Analysis - local employment CART</h1>

</div>


<p><br></p>
<p>We will use a tree-based method for classification - CART analysis.
This type of analysis involves stratifying and/or segmenting the
predictor space into a number of simple regions. Essentially, it’s
another way to see which independent variables play a role in if an
individual has meaningful employment in the local region X. We will be
using the independent variables that were identified as being important
in the multiple correspondence analysis.</p>
<p>There are three “times” in which we checked to see if the individual
had meaningful employment within these geographies;</p>
<ol style="list-style-type: decimal">
<li>the same year as graduation</li>
<li>two years after graduation, and</li>
<li>seven years after graduation.</li>
</ol>
<p>Meaningful employment is determined by whether an individual worked
1,000 hours for an employer during time X. In addition, if the
individual worked 1,000 hours for that employer during another year, but
not for that exact “time X” year, it’s still considered
“meaningful”.</p>
<p>Due to time x potentially being passed the date of the latest data
(2019) for some individuals, the analysis below will filter out all
individuals where time x is after 2019.</p>
<p>The primary independent variables that the cross tables indicated as
important are;</p>
<pre><code>## $RaceEthnicity
## [1] &quot;factor&quot;
## 
## $Dem_Desc
## [1] &quot;factor&quot;
## 
## $edr
## [1] &quot;factor&quot;
## 
## $avg.wages.pct.state
## [1] &quot;numeric&quot;
## 
## $LimitedEnglishProficiencyIndicator
## [1] &quot;factor&quot;
## 
## $pseo.participant
## [1] &quot;factor&quot;
## 
## $non.english.home
## [1] &quot;factor&quot;
## 
## $english.learner
## [1] &quot;factor&quot;
## 
## $took.ACT
## [1] &quot;factor&quot;
## 
## $ap.exam
## [1] &quot;factor&quot;
## 
## $total.cte.courses.taken
## [1] &quot;numeric&quot;
## 
## $cte.achievement
## [1] &quot;factor&quot;
## 
## $MCA.M
## [1] &quot;numeric&quot;
## 
## $MCA.R
## [1] &quot;numeric&quot;
## 
## $MCA.S
## [1] &quot;numeric&quot;
## 
## $attended.ps.within.first.year.hsgrad
## [1] &quot;factor&quot;
## 
## $ps.grad
## [1] &quot;factor&quot;
## 
## $attended.ps
## [1] &quot;factor&quot;
## 
## $ps.grad.InstitutionSector
## [1] &quot;factor&quot;
## 
## $highest.cred.level
## [1] &quot;factor&quot;</code></pre>
<p>However, there are plenty of variables here that are VERY similar.
For example, whether an individual graduated from a post-secondary
institution and the type of institution they graduated from. So let’s
simplify the variables to what is most important and has the least
amount of overlap with other variables.</p>
<ul>
<li>Demographic
<ul>
<li>RaceEthnicity</li>
</ul></li>
<li>High school characteristics
<ul>
<li>Dem_Desc</li>
<li>EDR</li>
<li>avg.wages.pct.state</li>
</ul></li>
<li>High school enrollment
<ul>
<li>LimitedEnglishProficiencyIndicator</li>
<li>PSEO.participant</li>
</ul></li>
<li>High school accomplishments
<ul>
<li>took.act</li>
<li>ap.exam</li>
<li>cte.achievement</li>
<li>MCA.M</li>
<li>MCA.R</li>
<li>MCA.S</li>
</ul></li>
<li>Post-secondary
<ul>
<li>attended.ps.within.first.year.hsgrad: only for grad year +0
dependent variable</li>
<li>ps.grad.InstitutionSector</li>
<li>highest.cred.level</li>
</ul></li>
</ul>
<p>We eliminated the following variables for now;</p>
<ul>
<li>non.english.home</li>
<li>english.learner</li>
<li>total.cte.courses.taken</li>
<li>ps.grad</li>
<li>attended.ps</li>
</ul>
<p>In addition to eliminating those variables, we will also simplify the
ps.grad.InstitutionSector to the following codes;</p>
<ul>
<li>1 = graduated from the following insitutions
<ul>
<li>Public, 4-year (1)</li>
<li>Private, not for profit 4-year (2)</li>
<li>Private, for profit 4-year (3)</li>
</ul></li>
<li>2 = graduated from the following institutions
<ul>
<li>Private, not for profit 2-year (5, 11)</li>
<li>Private, for profit 2-year (6, 11)</li>
<li>Public, less than 2-year (7, 11)</li>
<li>Private, not for profit less than 2-year (8, 11)</li>
<li>Private for-profit, less-than 2-year (9, 11)</li>
</ul></li>
<li>3 = graduated from multiple institution sectors (10)</li>
<li>4 = graduated from a public, 2-year institution (4,4)</li>
<li>5 = Did not graduate or attend a post-secondary institution</li>
</ul>
<p>We will also simplify the attended.ps.within.first.year.hsgrad
variable to the following;</p>
<ul>
<li>Yes = Attended PS within first year</li>
<li>No = Attended PS but not within first year &amp; never attended
PS</li>
</ul>
<p><br></p>
<div id="section-steps-in-analysis" class="section level1">
<h1>Steps in analysis</h1>
<p>Our dependent variable - the individual has meaningful employment in
same location X as their high school - has 4 different outcomes.</p>
<ol style="list-style-type: decimal">
<li>Location match: the individual has
<ul>
<li>a MN employment record at time X</li>
<li>has meaningful employment at time X</li>
<li>is employed in the same location X as their high school.</li>
</ul></li>
<li>No location match: the individual has
<ul>
<li>a MN employment record at time X</li>
<li>has meaningful employment at time X</li>
<li>does NOT have employment in the same location X as their high
school.</li>
</ul></li>
<li>No meaningful emp: the individual has
<ul>
<li>a MN employment record at time X</li>
<li>the employment is not meaningful at time X.</li>
</ul></li>
<li>No MN emp record: the individual has
<ul>
<li>NO MN employment record at time X.</li>
</ul></li>
</ol>
<p>Since we are most interested in whether an individual has meaningful
employment in region X at time X we will create two groups; 1. all
individuals that meet the criteria/outcome 1 from list above, and 2. all
remaining individuals.</p>
<p>For each time X we will analyze whether the independent variables are
good at predicting whether an individual has a MN employment record AND
has meaningful employment AND the meaningful employment is in the same
region X as their high school.</p>
<p><br></p>
</div>
<div id="section-analysis---time-x-grad-year-0" class="section level1">
<h1>Analysis - time X = grad year +0</h1>
<div id="section-county-meaningful-employment" class="section level2">
<h2>County meaningful employment</h2>
<p>The following analysis will determine which variables are most
important in predicting whether an individual has meaningful employment
in the same county as their high school the year they graduate.</p>
<p>Let’s split the data into two sets, Train and Test, in a 70:30 ratio.
The Train set is used for training and creating the model. The Test set
is considered to be a dummy production environment to test predictions
and evaluate the accuracy of the model.</p>
<p><br></p>
<pre class="r"><code>set.seed(1234)
sample_ind &lt;- sample(nrow(master.grad.year.county.path), nrow(master.grad.year.county.path) *.7)

train &lt;- master.grad.year.county.path[sample_ind,]

test &lt;- master.grad.year.county.path[-sample_ind,]</code></pre>
<p><br></p>
<p>Next, we create a decision tree model by calling the rpart function.
Let’s first create a base model with default parameters and value. The
CP (complexity parameter) is used to control tree growth. If the cost of
adding a variable is higher then the value of CP, then tree growth
stops.</p>
<p><br></p>
<pre class="r"><code>#Base model
grad.year.0.county.model &lt;- rpart(hs.grad.year.county.match ~ ., data = train, method = &quot;class&quot;, control = rpart.control(cp = 0))</code></pre>
<pre class="r"><code># Examine the complexity plot
printcp(grad.year.0.county.model)</code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = hs.grad.year.county.match ~ ., data = train, 
##     method = &quot;class&quot;, control = rpart.control(cp = 0))
## 
## Variables actually used in tree construction:
##  [1] ap.exam                              attended.ps.within.first.year.hsgrad
##  [3] avg.wages.pct.state                  cte.achievement                     
##  [5] Dem_Desc                             edr                                 
##  [7] LimitedEnglishProficiencyIndicator   MCA.M                               
##  [9] MCA.R                                MCA.S                               
## [11] ps.grad.InstitutionSector            pseo.participant                    
## [13] RaceEthnicity                        took.ACT                            
## 
## Root node error: 3340/26635 = 0.1254
## 
## n= 26635 
## 
##            CP nsplit rel error xerror     xstd
## 1  2.8179e-04      0   1.00000 1.0000 0.016182
## 2  2.2455e-04     18   0.99461 1.0204 0.016322
## 3  2.1386e-04     33   0.98922 1.0257 0.016359
## 4  1.9960e-04     41   0.98743 1.0287 0.016379
## 5  1.7964e-04     59   0.98383 1.0371 0.016436
## 6  1.6633e-04     64   0.98293 1.0368 0.016434
## 7  1.4970e-04     73   0.98144 1.0473 0.016504
## 8  1.1976e-04     94   0.97754 1.0509 0.016528
## 9  9.9800e-05    111   0.97545 1.0787 0.016712
## 10 8.9820e-05    136   0.97275 1.0811 0.016728
## 11 8.5543e-05    173   0.96886 1.0826 0.016737
## 12 7.4850e-05    180   0.96826 1.0922 0.016799
## 13 6.6534e-05    188   0.96766 1.0931 0.016805
## 14 5.9880e-05    197   0.96707 1.0958 0.016823
## 15 4.9900e-05    207   0.96647 1.1021 0.016863
## 16 4.7274e-05    243   0.96467 1.1024 0.016865
## 17 4.6062e-05    262   0.96377 1.1042 0.016877
## 18 3.9920e-05    277   0.96287 1.1042 0.016877
## 19 3.3267e-05    292   0.96228 1.1072 0.016896
## 20 2.4950e-05    301   0.96198 1.1087 0.016905
## 21 0.0000e+00    313   0.96168 1.1087 0.016905</code></pre>
<pre class="r"><code>plotcp(grad.year.0.county.model)</code></pre>
<p><img src="analysis_local_employment_cart_files/figure-html/decision%20tree%20error%20grad%20year%20+0%20county-1.png" width="672" /></p>
<p><br></p>
<p>The resulting model produced a VERY complex tree with too many nodes
that it isn’t interpretable. However, examining the complexity
parameters shows that I have an increasing cross-validated error which
provides evidence of a decision tree with too much complexity.</p>
<p>Below are the values in variable important and it shows that average
wages, post-secondary pathway, MCA-reading scores, EDR, and CTE
achievement play an important role in this model.</p>
<p><br></p>
<pre class="r"><code>grad.year.0.county.model$variable.importance</code></pre>
<pre><code>##                  avg.wages.pct.state            ps.grad.InstitutionSector 
##                            226.03264                            118.28163 
##                        RaceEthnicity                                MCA.M 
##                             50.95809                             48.01114 
##                             Dem_Desc                                  edr 
##                             44.13841                             42.07482 
##                                MCA.R                      cte.achievement 
##                             39.21761                             35.43118 
##                             took.ACT                                MCA.S 
##                             32.19541                             28.29183 
## attended.ps.within.first.year.hsgrad                     pseo.participant 
##                             25.38406                             23.06849 
##                              ap.exam   LimitedEnglishProficiencyIndicator 
##                             22.10069                             12.64942</code></pre>
<p><br></p>
<p>Next, the accuracy of the model is computed and stored in a variable
base_accuracy so we can compare it to our pruned trees later.</p>
<p><br></p>
<pre class="r"><code>test$pred &lt;- predict(grad.year.0.county.model, test, type = &quot;class&quot;)

base_accuracy &lt;- mean(test$pred == test$hs.grad.year.county.match)

base_accuracy</code></pre>
<pre><code>## [1] 0.8642138</code></pre>
<p><br></p>
<p>Next, we need to prune. We can either pre-prune or post-prune. We
will start with pre-pruning and use each method - max depth, min depth,
and min bucket.</p>
<p><br></p>
<pre class="r"><code># Grow a tree with minsplit of 40 and max depth of 10
grad.year.0.county.model.preprune &lt;- rpart(hs.grad.year.county.match ~ ., data = train, method = &quot;class&quot;, 
                   control = rpart.control(cp = 0, maxdepth = 10, minsplit = 40))

#Summary
summary(grad.year.0.county.model.preprune)</code></pre>
<pre><code>## Call:
## rpart(formula = hs.grad.year.county.match ~ ., data = train, 
##     method = &quot;class&quot;, control = rpart.control(cp = 0, maxdepth = 10, 
##         minsplit = 40))
##   n= 26635 
## 
##             CP nsplit rel error   xerror       xstd
## 1 0.0002806886      0 1.0000000 1.000000 0.01618198
## 2 0.0001996008     16 0.9955090 1.002695 0.01620064
## 3 0.0000499002     19 0.9949102 1.007186 0.01623165
## 4 0.0000000000     31 0.9943114 1.012874 0.01627078
## 
## Variable importance
##            ps.grad.InstitutionSector                  avg.wages.pct.state 
##                                   35                                   17 
##                                MCA.M                             Dem_Desc 
##                                    9                                    7 
##                                  edr                             took.ACT 
##                                    7                                    5 
##                              ap.exam                                MCA.R 
##                                    5                                    3 
##                     pseo.participant                      cte.achievement 
##                                    3                                    3 
##                        RaceEthnicity attended.ps.within.first.year.hsgrad 
##                                    3                                    1 
##   LimitedEnglishProficiencyIndicator 
##                                    1 
## 
## Node number 1: 26635 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.1253989  P(node) =1
##     class counts:  3340 23295
##    probabilities: 0.125 0.875 
##   left son=2 (18407 obs) right son=3 (8228 obs)
##   Primary splits:
##       ps.grad.InstitutionSector &lt; 3.5       to the right, improve=93.57033, (0 missing)
##       took.ACT                  splits as  LR, improve=70.05845, (0 missing)
##       MCA.M                     &lt; 2.5       to the left,  improve=66.85044, (1982 missing)
##       MCA.R                     &lt; 2.5       to the left,  improve=53.52671, (1985 missing)
##       pseo.participant          splits as  LR, improve=48.93189, (0 missing)
##   Surrogate splits:
##       ap.exam splits as  LR, agree=0.716, adj=0.079, (0 split)
## 
## Node number 2: 18407 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.1534199  P(node) =0.6910832
##     class counts:  2824 15583
##    probabilities: 0.153 0.847 
##   left son=4 (12985 obs) right son=5 (5422 obs)
##   Primary splits:
##       MCA.M               &lt; 2.5       to the left,  improve=22.32004, (1827 missing)
##       took.ACT            splits as  LR, improve=22.29232, (0 missing)
##       avg.wages.pct.state &lt; 0.7019467 to the right, improve=20.38124, (0 missing)
##       pseo.participant    splits as  LR, improve=18.08671, (0 missing)
##       edr                 splits as  LRR, improve=17.31975, (0 missing)
##   Surrogate splits:
##       pseo.participant splits as  LR, agree=0.743, adj=0.188, (1827 split)
##       ap.exam          splits as  LR, agree=0.726, adj=0.137, (0 split)
##       MCA.R            &lt; 3.5       to the left,  agree=0.720, adj=0.116, (0 split)
## 
## Node number 3: 8228 observations
##   predicted class=No match  expected loss=0.06271269  P(node) =0.3089168
##     class counts:   516  7712
##    probabilities: 0.063 0.937 
## 
## Node number 4: 12985 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.1665768  P(node) =0.4875164
##     class counts:  2163 10822
##    probabilities: 0.167 0.833 
##   left son=8 (4552 obs) right son=9 (8433 obs)
##   Primary splits:
##       edr                 splits as  LRR, improve=18.584650, (0 missing)
##       avg.wages.pct.state &lt; 0.7000086 to the right, improve=16.336810, (0 missing)
##       Dem_Desc            splits as  RLL, improve=12.529490, (0 missing)
##       cte.achievement     splits as  LLR, improve=12.358430, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve= 7.431983, (0 missing)
##   Surrogate splits:
##       avg.wages.pct.state &lt; 0.7769473 to the right, agree=0.762, adj=0.320, (0 split)
##       Dem_Desc            splits as  RRL, agree=0.730, adj=0.231, (0 split)
## 
## Node number 5: 5422 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.1219107  P(node) =0.2035667
##     class counts:   661  4761
##    probabilities: 0.122 0.878 
##   left son=10 (1008 obs) right son=11 (4414 obs)
##   Primary splits:
##       took.ACT                             splits as  LR, improve=12.674640, (0 missing)
##       pseo.participant                     splits as  LR, improve= 8.336370, (0 missing)
##       MCA.S                                &lt; 3.5       to the left,  improve= 7.430105, (614 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve= 5.885428, (0 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the left,  improve= 5.065376, (0 missing)
##   Surrogate splits:
##       RaceEthnicity                      splits as  RRRRLR, agree=0.814, adj=0.002, (0 split)
##       LimitedEnglishProficiencyIndicator splits as  RL,     agree=0.814, adj=0.001, (0 split)
## 
## Node number 8: 4552 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.2029877  P(node) =0.1709029
##     class counts:   924  3628
##    probabilities: 0.203 0.797 
##   left son=16 (2560 obs) right son=17 (1992 obs)
##   Primary splits:
##       Dem_Desc            splits as  RLR, improve=13.005440, (0 missing)
##       avg.wages.pct.state &lt; 0.7154559 to the left,  improve= 9.229829, (0 missing)
##       cte.achievement     splits as  LRR, improve= 7.521857, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve= 4.365202, (0 missing)
##       MCA.R               &lt; 1.5       to the left,  improve= 2.744162, (623 missing)
##   Surrogate splits:
##       avg.wages.pct.state &lt; 0.7207798 to the left,  agree=0.9, adj=0.772, (0 split)
## 
## Node number 9: 8433 observations,    complexity param=0.0001996008
##   predicted class=No match  expected loss=0.1469228  P(node) =0.3166135
##     class counts:  1239  7194
##    probabilities: 0.147 0.853 
##   left son=18 (6852 obs) right son=19 (1581 obs)
##   Primary splits:
##       cte.achievement     splits as  LLR, improve=6.635735, (0 missing)
##       Dem_Desc            splits as  RLR, improve=5.931692, (0 missing)
##       avg.wages.pct.state &lt; 0.7000086 to the right, improve=4.782019, (0 missing)
##       edr                 splits as  -RL, improve=3.663782, (0 missing)
##       RaceEthnicity       splits as  RRRLRR, improve=3.060077, (0 missing)
## 
## Node number 10: 1008 observations
##   predicted class=No match  expected loss=0.1934524  P(node) =0.03784494
##     class counts:   195   813
##    probabilities: 0.193 0.807 
## 
## Node number 11: 4414 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.1055732  P(node) =0.1657218
##     class counts:   466  3948
##    probabilities: 0.106 0.894 
##   left son=22 (1059 obs) right son=23 (3355 obs)
##   Primary splits:
##       ps.grad.InstitutionSector &lt; 4.5       to the left,  improve=7.298615, (0 missing)
##       pseo.participant          splits as  LR, improve=5.081071, (0 missing)
##       MCA.S                     &lt; 3.5       to the left,  improve=4.418022, (431 missing)
##       MCA.R                     &lt; 2.5       to the left,  improve=3.217267, (81 missing)
##       avg.wages.pct.state       &lt; 0.7019467 to the right, improve=3.030200, (0 missing)
## 
## Node number 16: 2560 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.2363281  P(node) =0.09611414
##     class counts:   605  1955
##    probabilities: 0.236 0.764 
##   left son=32 (1823 obs) right son=33 (737 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.6998419 to the right, improve=7.103247, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve=3.727332, (0 missing)
##       cte.achievement     splits as  LRR, improve=3.392032, (0 missing)
##       took.ACT            splits as  LR, improve=1.866783, (0 missing)
##       MCA.M               &lt; 1.5       to the left,  improve=1.154541, (301 missing)
## 
## Node number 17: 1992 observations
##   predicted class=No match  expected loss=0.1601406  P(node) =0.07478881
##     class counts:   319  1673
##    probabilities: 0.160 0.840 
## 
## Node number 18: 6852 observations
##   predicted class=No match  expected loss=0.1564507  P(node) =0.2572555
##     class counts:  1072  5780
##    probabilities: 0.156 0.844 
## 
## Node number 19: 1581 observations,    complexity param=0.0001996008
##   predicted class=No match  expected loss=0.1056293  P(node) =0.05935799
##     class counts:   167  1414
##    probabilities: 0.106 0.894 
##   left son=38 (120 obs) right son=39 (1461 obs)
##   Primary splits:
##       LimitedEnglishProficiencyIndicator splits as  RL, improve=2.312953, (0 missing)
##       avg.wages.pct.state                &lt; 0.7173974 to the right, improve=2.186616, (0 missing)
##       RaceEthnicity                      splits as  RRLLRR, improve=1.968251, (0 missing)
##       edr                                splits as  -RL, improve=1.353776, (0 missing)
##       MCA.S                              &lt; 2.5       to the left,  improve=1.171381, (590 missing)
## 
## Node number 22: 1059 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.1567517  P(node) =0.03975971
##     class counts:   166   893
##    probabilities: 0.157 0.843 
##   left son=44 (437 obs) right son=45 (622 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7056402 to the right, improve=3.9445820, (0 missing)
##       edr                 splits as  LRR, improve=1.5873470, (0 missing)
##       RaceEthnicity       splits as  RRRL-R, improve=1.4067940, (0 missing)
##       cte.achievement     splits as  LRR, improve=0.3557618, (0 missing)
##       pseo.participant    splits as  LR, improve=0.2769660, (0 missing)
##   Surrogate splits:
##       edr                                splits as  LRR,    agree=0.700, adj=0.272, (0 split)
##       Dem_Desc                           splits as  RRL,    agree=0.651, adj=0.153, (0 split)
##       ap.exam                            splits as  RL,     agree=0.637, adj=0.121, (0 split)
##       RaceEthnicity                      splits as  RLRL-R, agree=0.604, adj=0.041, (0 split)
##       LimitedEnglishProficiencyIndicator splits as  RL,     agree=0.589, adj=0.005, (0 split)
## 
## Node number 23: 3355 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.08941878  P(node) =0.1259621
##     class counts:   300  3055
##    probabilities: 0.089 0.911 
##   left son=46 (1292 obs) right son=47 (2063 obs)
##   Primary splits:
##       pseo.participant                     splits as  LR, improve=4.757281, (0 missing)
##       MCA.S                                &lt; 3.5       to the left,  improve=4.100002, (329 missing)
##       MCA.R                                &lt; 2.5       to the left,  improve=3.578949, (71 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=3.394462, (0 missing)
##       cte.achievement                      splits as  LRR, improve=2.042924, (0 missing)
##   Surrogate splits:
##       avg.wages.pct.state &lt; 0.6047901 to the left,  agree=0.628, adj=0.033, (0 split)
##       RaceEthnicity       splits as  LRRR-R, agree=0.618, adj=0.008, (0 split)
## 
## Node number 32: 1823 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.260011  P(node) =0.06844378
##     class counts:   474  1349
##    probabilities: 0.260 0.740 
##   left son=64 (1266 obs) right son=65 (557 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7154559 to the left,  improve=5.5714290, (0 missing)
##       cte.achievement     splits as  LLR, improve=2.9343390, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve=1.3167340, (0 missing)
##       MCA.R               &lt; 1.5       to the left,  improve=0.5670197, (248 missing)
##       took.ACT            splits as  LR, improve=0.4304287, (0 missing)
## 
## Node number 33: 737 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.1777476  P(node) =0.02767036
##     class counts:   131   606
##    probabilities: 0.178 0.822 
##   left son=66 (76 obs) right son=67 (661 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.6770254 to the left,  improve=4.5781430, (0 missing)
##       took.ACT                             splits as  LR, improve=1.8039520, (0 missing)
##       RaceEthnicity                        splits as  LRRLRR, improve=1.1216510, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=0.4694517, (88 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.3365898, (0 missing)
## 
## Node number 38: 120 observations,    complexity param=0.0001996008
##   predicted class=No match  expected loss=0.2  P(node) =0.00450535
##     class counts:    24    96
##    probabilities: 0.200 0.800 
##   left son=76 (16 obs) right son=77 (104 obs)
##   Primary splits:
##       RaceEthnicity                        splits as  -RLR-L, improve=4.8519230, (0 missing)
##       took.ACT                             splits as  LR, improve=0.4800000, (0 missing)
##       avg.wages.pct.state                  &lt; 0.732997  to the left,  improve=0.4568854, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.4436457, (0 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the left,  improve=0.1200000, (0 missing)
## 
## Node number 39: 1461 observations
##   predicted class=No match  expected loss=0.09787817  P(node) =0.05485264
##     class counts:   143  1318
##    probabilities: 0.098 0.902 
## 
## Node number 44: 437 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.208238  P(node) =0.01640698
##     class counts:    91   346
##    probabilities: 0.208 0.792 
##   left son=88 (148 obs) right son=89 (289 obs)
##   Primary splits:
##       MCA.R               &lt; 3.5       to the right, improve=1.7520860, (4 missing)
##       RaceEthnicity       splits as  LRRL-R, improve=1.2214630, (0 missing)
##       avg.wages.pct.state &lt; 0.807751  to the right, improve=1.1423930, (0 missing)
##       ap.exam             splits as  LR, improve=0.9453980, (0 missing)
##       edr                 splits as  LRR, improve=0.8660124, (0 missing)
##   Surrogate splits:
##       MCA.M               &lt; 3.5       to the right, agree=0.686, adj=0.081, (2 split)
##       MCA.S               &lt; 3.5       to the right, agree=0.665, adj=0.020, (0 split)
##       avg.wages.pct.state &lt; 0.70854   to the left,  agree=0.663, adj=0.014, (2 split)
## 
## Node number 45: 622 observations
##   predicted class=No match  expected loss=0.1205788  P(node) =0.02335273
##     class counts:    75   547
##    probabilities: 0.121 0.879 
## 
## Node number 46: 1292 observations
##   predicted class=No match  expected loss=0.123065  P(node) =0.0485076
##     class counts:   159  1133
##    probabilities: 0.123 0.877 
## 
## Node number 47: 2063 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.06834707  P(node) =0.07745448
##     class counts:   141  1922
##    probabilities: 0.068 0.932 
##   left son=94 (408 obs) right son=95 (1655 obs)
##   Primary splits:
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=3.264647, (0 missing)
##       MCA.S                                &lt; 3.5       to the left,  improve=1.834591, (101 missing)
##       MCA.R                                &lt; 2.5       to the left,  improve=1.678213, (46 missing)
##       RaceEthnicity                        splits as  RRRL-R, improve=1.442350, (0 missing)
##       edr                                  splits as  LRR, improve=1.338888, (0 missing)
##   Surrogate splits:
##       LimitedEnglishProficiencyIndicator splits as  RL, agree=0.803, adj=0.005, (0 split)
##       avg.wages.pct.state                &lt; 0.8085253 to the right, agree=0.803, adj=0.002, (0 split)
## 
## Node number 64: 1266 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.28594  P(node) =0.04753144
##     class counts:   362   904
##    probabilities: 0.286 0.714 
##   left son=128 (658 obs) right son=129 (608 obs)
##   Primary splits:
##       cte.achievement                    splits as  LRR, improve=2.2491900, (0 missing)
##       avg.wages.pct.state                &lt; 0.7025719 to the left,  improve=0.7457463, (0 missing)
##       took.ACT                           splits as  LR, improve=0.7198588, (0 missing)
##       RaceEthnicity                      splits as  RRLLRR, improve=0.6140553, (0 missing)
##       LimitedEnglishProficiencyIndicator splits as  RL, improve=0.5955187, (0 missing)
##   Surrogate splits:
##       RaceEthnicity                        splits as  RLRRRL, agree=0.587, adj=0.140, (0 split)
##       LimitedEnglishProficiencyIndicator   splits as  LR, agree=0.575, adj=0.115, (0 split)
##       pseo.participant                     splits as  LR, agree=0.540, adj=0.043, (0 split)
##       avg.wages.pct.state                  &lt; 0.7122351 to the left,  agree=0.536, adj=0.035, (0 split)
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.533, adj=0.028, (0 split)
## 
## Node number 65: 557 observations
##   predicted class=No match  expected loss=0.2010772  P(node) =0.02091233
##     class counts:   112   445
##    probabilities: 0.201 0.799 
## 
## Node number 66: 76 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.3421053  P(node) =0.002853388
##     class counts:    26    50
##    probabilities: 0.342 0.658 
##   left son=132 (48 obs) right son=133 (28 obs)
##   Primary splits:
##       MCA.M                     &lt; 1.5       to the left,  improve=2.3625000, (16 missing)
##       took.ACT                  splits as  LR, improve=1.5909980, (0 missing)
##       MCA.R                     &lt; 2.5       to the right, improve=1.3497200, (11 missing)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, improve=1.1116250, (0 missing)
##       MCA.S                     &lt; 1.5       to the left,  improve=0.4778409, (12 missing)
##   Surrogate splits:
##       pseo.participant          splits as  LR, agree=0.633, adj=0.214, (16 split)
##       MCA.S                     &lt; 2.5       to the left,  agree=0.600, adj=0.143, (0 split)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, agree=0.600, adj=0.143, (0 split)
##       cte.achievement           splits as  RLL, agree=0.583, adj=0.107, (0 split)
##       took.ACT                  splits as  LR, agree=0.567, adj=0.071, (0 split)
## 
## Node number 67: 661 observations
##   predicted class=No match  expected loss=0.1588502  P(node) =0.02481697
##     class counts:   105   556
##    probabilities: 0.159 0.841 
## 
## Node number 76: 16 observations
##   predicted class=Match     expected loss=0.4375  P(node) =0.0006007133
##     class counts:     9     7
##    probabilities: 0.562 0.438 
## 
## Node number 77: 104 observations
##   predicted class=No match  expected loss=0.1442308  P(node) =0.003904637
##     class counts:    15    89
##    probabilities: 0.144 0.856 
## 
## Node number 88: 148 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.2702703  P(node) =0.005556598
##     class counts:    40   108
##    probabilities: 0.270 0.730 
##   left son=176 (96 obs) right son=177 (52 obs)
##   Primary splits:
##       ap.exam             splits as  LR, improve=2.1732500, (0 missing)
##       Dem_Desc            splits as  LRR, improve=2.0501730, (0 missing)
##       cte.achievement     splits as  LRR, improve=0.8611654, (0 missing)
##       avg.wages.pct.state &lt; 0.7938869 to the left,  improve=0.8550492, (0 missing)
##       pseo.participant    splits as  RL, improve=0.1482759, (0 missing)
##   Surrogate splits:
##       edr                                  splits as  LRL, agree=0.669, adj=0.058, (0 split)
##       avg.wages.pct.state                  &lt; 0.7138932 to the right, agree=0.669, adj=0.058, (0 split)
##       RaceEthnicity                        splits as  RRLL-L, agree=0.662, adj=0.038, (0 split)
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.655, adj=0.019, (0 split)
## 
## Node number 89: 289 observations
##   predicted class=No match  expected loss=0.1764706  P(node) =0.01085038
##     class counts:    51   238
##    probabilities: 0.176 0.824 
## 
## Node number 94: 408 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.125  P(node) =0.01531819
##     class counts:    51   357
##    probabilities: 0.125 0.875 
##   left son=188 (166 obs) right son=189 (242 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7056402 to the right, improve=2.1340980, (0 missing)
##       MCA.R               &lt; 3.5       to the left,  improve=1.4187790, (16 missing)
##       MCA.S               &lt; 3.5       to the left,  improve=1.2295840, (32 missing)
##       Dem_Desc            splits as  RLR, improve=1.1699200, (0 missing)
##       RaceEthnicity       splits as  RRRL-R, improve=0.5663529, (0 missing)
##   Surrogate splits:
##       Dem_Desc      splits as  RRL,    agree=0.701, adj=0.265, (0 split)
##       ap.exam       splits as  RL,     agree=0.642, adj=0.120, (0 split)
##       edr           splits as  LRR,    agree=0.608, adj=0.036, (0 split)
##       RaceEthnicity splits as  RLRR-R, agree=0.603, adj=0.024, (0 split)
## 
## Node number 95: 1655 observations
##   predicted class=No match  expected loss=0.05438066  P(node) =0.06213629
##     class counts:    90  1565
##    probabilities: 0.054 0.946 
## 
## Node number 128: 658 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.3145897  P(node) =0.02470434
##     class counts:   207   451
##    probabilities: 0.315 0.685 
##   left son=256 (122 obs) right son=257 (536 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7039552 to the left,  improve=1.4953810, (0 missing)
##       took.ACT            splits as  LR, improve=1.2646400, (0 missing)
##       RaceEthnicity       splits as  RRLL-L, improve=1.0086080, (0 missing)
##       MCA.M               &lt; 1.5       to the left,  improve=0.5369837, (43 missing)
##       MCA.R               &lt; 1.5       to the left,  improve=0.4661558, (47 missing)
## 
## Node number 129: 608 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.2549342  P(node) =0.02282711
##     class counts:   155   453
##    probabilities: 0.255 0.745 
##   left son=258 (123 obs) right son=259 (485 obs)
##   Primary splits:
##       RaceEthnicity                      splits as  LLLRRR, improve=1.8954810, (0 missing)
##       LimitedEnglishProficiencyIndicator splits as  RL, improve=1.5107460, (0 missing)
##       avg.wages.pct.state                &lt; 0.7077928 to the right, improve=0.9196207, (0 missing)
##       MCA.S                              &lt; 2.5       to the left,  improve=0.4823501, (166 missing)
##       MCA.M                              &lt; 1.5       to the left,  improve=0.2959430, (95 missing)
##   Surrogate splits:
##       LimitedEnglishProficiencyIndicator splits as  RL, agree=0.868, adj=0.35, (0 split)
## 
## Node number 132: 48 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.3958333  P(node) =0.00180214
##     class counts:    19    29
##    probabilities: 0.396 0.604 
##   left son=264 (14 obs) right son=265 (34 obs)
##   Primary splits:
##       MCA.R                                &lt; 2.5       to the right, improve=1.51502400, (11 missing)
##       cte.achievement                      splits as  LRR, improve=0.48980190, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.22500000, (0 missing)
##       MCA.S                                &lt; 1.5       to the left,  improve=0.02539683, (12 missing)
##   Surrogate splits:
##       MCA.S &lt; 2.5       to the right, agree=0.676, adj=0.143, (3 split)
## 
## Node number 133: 28 observations
##   predicted class=No match  expected loss=0.25  P(node) =0.001051248
##     class counts:     7    21
##    probabilities: 0.250 0.750 
## 
## Node number 176: 96 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.3333333  P(node) =0.00360428
##     class counts:    32    64
##    probabilities: 0.333 0.667 
##   left son=352 (13 obs) right son=353 (83 obs)
##   Primary splits:
##       Dem_Desc            splits as  LRR, improve=1.2653690, (0 missing)
##       edr                 splits as  LRR, improve=1.2090550, (0 missing)
##       avg.wages.pct.state &lt; 0.7938869 to the left,  improve=1.0971430, (0 missing)
##       MCA.M               &lt; 3.5       to the right, improve=0.4075976, (2 missing)
##       cte.achievement     splits as  LRR, improve=0.2443121, (0 missing)
##   Surrogate splits:
##       RaceEthnicity splits as  --LR-R, agree=0.875, adj=0.077, (0 split)
## 
## Node number 177: 52 observations
##   predicted class=No match  expected loss=0.1538462  P(node) =0.001952318
##     class counts:     8    44
##    probabilities: 0.154 0.846 
## 
## Node number 188: 166 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.186747  P(node) =0.006232401
##     class counts:    31   135
##    probabilities: 0.187 0.813 
##   left son=376 (89 obs) right son=377 (77 obs)
##   Primary splits:
##       MCA.R               &lt; 3.5       to the left,  improve=3.173697, (8 missing)
##       MCA.S               &lt; 3.5       to the left,  improve=2.362732, (16 missing)
##       Dem_Desc            splits as  RLR, improve=2.341551, (0 missing)
##       avg.wages.pct.state &lt; 0.7769473 to the left,  improve=2.138640, (0 missing)
##       RaceEthnicity       splits as  -LLL-R, improve=1.212098, (0 missing)
##   Surrogate splits:
##       MCA.S               &lt; 3.5       to the left,  agree=0.646, adj=0.263, (2 split)
##       MCA.M               &lt; 3.5       to the left,  agree=0.620, adj=0.211, (4 split)
##       Dem_Desc            splits as  RLR, agree=0.608, adj=0.184, (2 split)
##       avg.wages.pct.state &lt; 0.7898468 to the left,  agree=0.608, adj=0.184, (0 split)
##       cte.achievement     splits as  LRR, agree=0.557, adj=0.079, (0 split)
## 
## Node number 189: 242 observations
##   predicted class=No match  expected loss=0.08264463  P(node) =0.009085789
##     class counts:    20   222
##    probabilities: 0.083 0.917 
## 
## Node number 256: 122 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.3852459  P(node) =0.004580439
##     class counts:    47    75
##    probabilities: 0.385 0.615 
##   left son=512 (88 obs) right son=513 (34 obs)
##   Primary splits:
##       took.ACT                             splits as  LR, improve=3.0328750, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=1.1030740, (7 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.9468852, (0 missing)
##       MCA.R                                &lt; 1.5       to the left,  improve=0.5660819, (8 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the left,  improve=0.4344848, (0 missing)
##   Surrogate splits:
##       RaceEthnicity splits as  -RLL-L, agree=0.73, adj=0.029, (0 split)
## 
## Node number 257: 536 observations
##   predicted class=No match  expected loss=0.2985075  P(node) =0.0201239
##     class counts:   160   376
##    probabilities: 0.299 0.701 
## 
## Node number 258: 123 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.3333333  P(node) =0.004617984
##     class counts:    41    82
##    probabilities: 0.333 0.667 
##   left son=516 (72 obs) right son=517 (51 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.7077928 to the right, improve=2.4117650, (0 missing)
##       LimitedEnglishProficiencyIndicator   splits as  RL, improve=2.3768120, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.9837398, (0 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the right, improve=0.6936294, (0 missing)
##       cte.achievement                      splits as  -LR, improve=0.2892416, (0 missing)
##   Surrogate splits:
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.61, adj=0.059, (0 split)
## 
## Node number 259: 485 observations
##   predicted class=No match  expected loss=0.2350515  P(node) =0.01820912
##     class counts:   114   371
##    probabilities: 0.235 0.765 
## 
## Node number 264: 14 observations
##   predicted class=Match     expected loss=0.3571429  P(node) =0.0005256242
##     class counts:     9     5
##    probabilities: 0.643 0.357 
## 
## Node number 265: 34 observations
##   predicted class=No match  expected loss=0.2941176  P(node) =0.001276516
##     class counts:    10    24
##    probabilities: 0.294 0.706 
## 
## Node number 352: 13 observations
##   predicted class=Match     expected loss=0.4615385  P(node) =0.0004880796
##     class counts:     7     6
##    probabilities: 0.538 0.462 
## 
## Node number 353: 83 observations
##   predicted class=No match  expected loss=0.3012048  P(node) =0.0031162
##     class counts:    25    58
##    probabilities: 0.301 0.699 
## 
## Node number 376: 89 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.2696629  P(node) =0.003341468
##     class counts:    24    65
##    probabilities: 0.270 0.730 
##   left son=752 (63 obs) right son=753 (26 obs)
##   Primary splits:
##       Dem_Desc            splits as  RLR, improve=1.7484870, (0 missing)
##       avg.wages.pct.state &lt; 0.7769473 to the left,  improve=1.2024250, (0 missing)
##       MCA.R               &lt; 2.5       to the left,  improve=1.1114190, (7 missing)
##       RaceEthnicity       splits as  -LLL-R, improve=0.6129365, (0 missing)
##       edr                 splits as  RLL, improve=0.4901420, (0 missing)
##   Surrogate splits:
##       avg.wages.pct.state                &lt; 0.7769473 to the left,  agree=0.966, adj=0.885, (0 split)
##       LimitedEnglishProficiencyIndicator splits as  LR, agree=0.719, adj=0.038, (0 split)
## 
## Node number 377: 77 observations
##   predicted class=No match  expected loss=0.09090909  P(node) =0.002890933
##     class counts:     7    70
##    probabilities: 0.091 0.909 
## 
## Node number 512: 88 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.4545455  P(node) =0.003303923
##     class counts:    40    48
##    probabilities: 0.455 0.545 
##   left son=1024 (21 obs) right son=1025 (67 obs)
##   Primary splits:
##       ps.grad.InstitutionSector &lt; 4.5       to the left,  improve=1.4927960, (0 missing)
##       MCA.R                     &lt; 1.5       to the left,  improve=1.0345340, (8 missing)
##       MCA.M                     &lt; 1.5       to the left,  improve=0.9375157, (7 missing)
##       avg.wages.pct.state       &lt; 0.7025719 to the left,  improve=0.1500478, (0 missing)
##       MCA.S                     &lt; 1.5       to the right, improve=0.0974359, (10 missing)
## 
## Node number 513: 34 observations
##   predicted class=No match  expected loss=0.2058824  P(node) =0.001276516
##     class counts:     7    27
##    probabilities: 0.206 0.794 
## 
## Node number 516: 72 observations,    complexity param=0.0002806886
##   predicted class=No match  expected loss=0.4166667  P(node) =0.00270321
##     class counts:    30    42
##    probabilities: 0.417 0.583 
##   left son=1032 (40 obs) right son=1033 (32 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.7122351 to the left,  improve=4.5125000, (0 missing)
##       LimitedEnglishProficiencyIndicator   splits as  RL, improve=1.5714290, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.5253227, (0 missing)
##       cte.achievement                      splits as  -LR, improve=0.5000000, (0 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the right, improve=0.3767927, (0 missing)
##   Surrogate splits:
##       RaceEthnicity             splits as  RLL---, agree=0.597, adj=0.094, (0 split)
##       cte.achievement           splits as  -LR, agree=0.583, adj=0.063, (0 split)
##       pseo.participant          splits as  LR, agree=0.569, adj=0.031, (0 split)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, agree=0.569, adj=0.031, (0 split)
## 
## Node number 517: 51 observations
##   predicted class=No match  expected loss=0.2156863  P(node) =0.001914774
##     class counts:    11    40
##    probabilities: 0.216 0.784 
## 
## Node number 752: 63 observations,    complexity param=4.99002e-05
##   predicted class=No match  expected loss=0.3333333  P(node) =0.002365309
##     class counts:    21    42
##    probabilities: 0.333 0.667 
##   left son=1504 (13 obs) right son=1505 (50 obs)
##   Primary splits:
##       MCA.R               &lt; 2.5       to the left,  improve=1.11104800, (4 missing)
##       avg.wages.pct.state &lt; 0.7576334 to the right, improve=0.70000000, (0 missing)
##       RaceEthnicity       splits as  -LLL-R, improve=0.53846150, (0 missing)
##       cte.achievement     splits as  LRL, improve=0.07161125, (0 missing)
##       edr                 splits as  RRL, improve=0.05714286, (0 missing)
## 
## Node number 753: 26 observations
##   predicted class=No match  expected loss=0.1153846  P(node) =0.0009761592
##     class counts:     3    23
##    probabilities: 0.115 0.885 
## 
## Node number 1024: 21 observations
##   predicted class=Match     expected loss=0.3809524  P(node) =0.0007884363
##     class counts:    13     8
##    probabilities: 0.619 0.381 
## 
## Node number 1025: 67 observations
##   predicted class=No match  expected loss=0.4029851  P(node) =0.002515487
##     class counts:    27    40
##    probabilities: 0.403 0.597 
## 
## Node number 1032: 40 observations
##   predicted class=Match     expected loss=0.425  P(node) =0.001501783
##     class counts:    23    17
##    probabilities: 0.575 0.425 
## 
## Node number 1033: 32 observations
##   predicted class=No match  expected loss=0.21875  P(node) =0.001201427
##     class counts:     7    25
##    probabilities: 0.219 0.781 
## 
## Node number 1504: 13 observations
##   predicted class=Match     expected loss=0.4615385  P(node) =0.0004880796
##     class counts:     7     6
##    probabilities: 0.538 0.462 
## 
## Node number 1505: 50 observations
##   predicted class=No match  expected loss=0.28  P(node) =0.001877229
##     class counts:    14    36
##    probabilities: 0.280 0.720</code></pre>
<pre class="r"><code>#Plot tree
rpart.plot(grad.year.0.county.model.preprune)</code></pre>
<p><img src="analysis_local_employment_cart_files/figure-html/pre%20pruning%20%20grad%20year%20+0%20county-1.png" width="672" /></p>
<pre class="r"><code># Examine the complexity plot
printcp(grad.year.0.county.model.preprune)</code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = hs.grad.year.county.match ~ ., data = train, 
##     method = &quot;class&quot;, control = rpart.control(cp = 0, maxdepth = 10, 
##         minsplit = 40))
## 
## Variables actually used in tree construction:
##  [1] ap.exam                              attended.ps.within.first.year.hsgrad
##  [3] avg.wages.pct.state                  cte.achievement                     
##  [5] Dem_Desc                             edr                                 
##  [7] LimitedEnglishProficiencyIndicator   MCA.M                               
##  [9] MCA.R                                ps.grad.InstitutionSector           
## [11] pseo.participant                     RaceEthnicity                       
## [13] took.ACT                            
## 
## Root node error: 3340/26635 = 0.1254
## 
## n= 26635 
## 
##           CP nsplit rel error xerror     xstd
## 1 0.00028069      0   1.00000 1.0000 0.016182
## 2 0.00019960     16   0.99551 1.0027 0.016201
## 3 0.00004990     19   0.99491 1.0072 0.016232
## 4 0.00000000     31   0.99431 1.0129 0.016271</code></pre>
<pre class="r"><code>plotcp(grad.year.0.county.model.preprune)</code></pre>
<p><img src="analysis_local_employment_cart_files/figure-html/pre%20pruning%20%20grad%20year%20+0%20county-2.png" width="672" /></p>
<pre class="r"><code># Compute the accuracy of the pruned tree

test$pred &lt;- predict(grad.year.0.county.model.preprune, test, type = &quot;class&quot;)

accuracy_preprun &lt;- mean(test$pred == test$hs.grad.year.county.match)

accuracy_preprun</code></pre>
<pre><code>## [1] 0.8773544</code></pre>
<p><br></p>
<p>The pre-pruning resulted in a significantly less complex tree with a
.877442 accuracy. Let’s see what variables are important in this
model.</p>
<p>This model does indicate a difference in important when pruned.
Average wages are no longer as important, however post-secondary pathway
is still very important.</p>
<p><br></p>
<pre class="r"><code>grad.year.0.county.model.preprune$variable.importance</code></pre>
<pre><code>##            ps.grad.InstitutionSector                  avg.wages.pct.state 
##                           102.840259                            50.254887 
##                                MCA.M                             Dem_Desc 
##                            25.492752                            22.061251 
##                                  edr                             took.ACT 
##                            19.861321                            15.876263 
##                              ap.exam                                MCA.R 
##                            13.394852                            10.136550 
##                     pseo.participant                      cte.achievement 
##                             9.706693                             9.670636 
##                        RaceEthnicity attended.ps.within.first.year.hsgrad 
##                             8.030888                             3.511197 
##   LimitedEnglishProficiencyIndicator                                MCA.S 
##                             3.348433                             1.424631</code></pre>
<p>Next, let’s try postpruning. The idea here is to allow the decision
tree to grow fully and observe the CP value. Next, we prune/cut the tree
with the optimal CP value as the parameter as shown in below code:</p>
<p><br></p>
<pre class="r"><code># Prune the hr_base_model based on the optimal cp value
grad.year.0.county.model.postprune &lt;- prune(grad.year.0.county.model, cp = .00024657 )

#Summary
summary(grad.year.0.county.model.postprune)</code></pre>
<pre><code>## Call:
## rpart(formula = hs.grad.year.county.match ~ ., data = train, 
##     method = &quot;class&quot;, control = rpart.control(cp = 0))
##   n= 26635 
## 
##             CP nsplit rel error   xerror       xstd
## 1 0.0002817894      0 1.0000000 1.000000 0.01618198
## 2 0.0002465700     18 0.9946108 1.020359 0.01632201
## 
## Variable importance
##            ps.grad.InstitutionSector                  avg.wages.pct.state 
##                                   41                                   18 
##                                MCA.M                                  edr 
##                                   11                                    8 
##                             Dem_Desc                              ap.exam 
##                                    7                                    5 
##                     pseo.participant                             took.ACT 
##                                    3                                    2 
##                                MCA.R                        RaceEthnicity 
##                                    2                                    1 
##                      cte.achievement attended.ps.within.first.year.hsgrad 
##                                    1                                    1 
## 
## Node number 1: 26635 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.1253989  P(node) =1
##     class counts:  3340 23295
##    probabilities: 0.125 0.875 
##   left son=2 (18407 obs) right son=3 (8228 obs)
##   Primary splits:
##       ps.grad.InstitutionSector &lt; 3.5       to the right, improve=93.57033, (0 missing)
##       took.ACT                  splits as  LR, improve=70.05845, (0 missing)
##       MCA.M                     &lt; 2.5       to the left,  improve=66.85044, (1982 missing)
##       MCA.R                     &lt; 2.5       to the left,  improve=53.52671, (1985 missing)
##       pseo.participant          splits as  LR, improve=48.93189, (0 missing)
##   Surrogate splits:
##       ap.exam splits as  LR, agree=0.716, adj=0.079, (0 split)
## 
## Node number 2: 18407 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.1534199  P(node) =0.6910832
##     class counts:  2824 15583
##    probabilities: 0.153 0.847 
##   left son=4 (12985 obs) right son=5 (5422 obs)
##   Primary splits:
##       MCA.M               &lt; 2.5       to the left,  improve=22.32004, (1827 missing)
##       took.ACT            splits as  LR, improve=22.29232, (0 missing)
##       avg.wages.pct.state &lt; 0.7019467 to the right, improve=20.38124, (0 missing)
##       pseo.participant    splits as  LR, improve=18.08671, (0 missing)
##       edr                 splits as  LRR, improve=17.31975, (0 missing)
##   Surrogate splits:
##       pseo.participant splits as  LR, agree=0.743, adj=0.188, (1827 split)
##       ap.exam          splits as  LR, agree=0.726, adj=0.137, (0 split)
##       MCA.R            &lt; 3.5       to the left,  agree=0.720, adj=0.116, (0 split)
## 
## Node number 3: 8228 observations
##   predicted class=No match  expected loss=0.06271269  P(node) =0.3089168
##     class counts:   516  7712
##    probabilities: 0.063 0.937 
## 
## Node number 4: 12985 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.1665768  P(node) =0.4875164
##     class counts:  2163 10822
##    probabilities: 0.167 0.833 
##   left son=8 (4552 obs) right son=9 (8433 obs)
##   Primary splits:
##       edr                 splits as  LRR, improve=18.584650, (0 missing)
##       avg.wages.pct.state &lt; 0.7000086 to the right, improve=16.336810, (0 missing)
##       Dem_Desc            splits as  RLL, improve=12.529490, (0 missing)
##       cte.achievement     splits as  LLR, improve=12.358430, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve= 7.431983, (0 missing)
##   Surrogate splits:
##       avg.wages.pct.state &lt; 0.7769473 to the right, agree=0.762, adj=0.320, (0 split)
##       Dem_Desc            splits as  RRL, agree=0.730, adj=0.231, (0 split)
## 
## Node number 5: 5422 observations
##   predicted class=No match  expected loss=0.1219107  P(node) =0.2035667
##     class counts:   661  4761
##    probabilities: 0.122 0.878 
## 
## Node number 8: 4552 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.2029877  P(node) =0.1709029
##     class counts:   924  3628
##    probabilities: 0.203 0.797 
##   left son=16 (2560 obs) right son=17 (1992 obs)
##   Primary splits:
##       Dem_Desc            splits as  RLR, improve=13.005440, (0 missing)
##       avg.wages.pct.state &lt; 0.7154559 to the left,  improve= 9.229829, (0 missing)
##       cte.achievement     splits as  LRR, improve= 7.521857, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve= 4.365202, (0 missing)
##       MCA.R               &lt; 1.5       to the left,  improve= 2.744162, (623 missing)
##   Surrogate splits:
##       avg.wages.pct.state &lt; 0.7207798 to the left,  agree=0.9, adj=0.772, (0 split)
## 
## Node number 9: 8433 observations
##   predicted class=No match  expected loss=0.1469228  P(node) =0.3166135
##     class counts:  1239  7194
##    probabilities: 0.147 0.853 
## 
## Node number 16: 2560 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.2363281  P(node) =0.09611414
##     class counts:   605  1955
##    probabilities: 0.236 0.764 
##   left son=32 (1823 obs) right son=33 (737 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.6998419 to the right, improve=7.103247, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve=3.727332, (0 missing)
##       cte.achievement     splits as  LRR, improve=3.392032, (0 missing)
##       took.ACT            splits as  LR, improve=1.866783, (0 missing)
##       MCA.M               &lt; 1.5       to the left,  improve=1.154541, (301 missing)
## 
## Node number 17: 1992 observations
##   predicted class=No match  expected loss=0.1601406  P(node) =0.07478881
##     class counts:   319  1673
##    probabilities: 0.160 0.840 
## 
## Node number 32: 1823 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.260011  P(node) =0.06844378
##     class counts:   474  1349
##    probabilities: 0.260 0.740 
##   left son=64 (1266 obs) right son=65 (557 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7154559 to the left,  improve=5.5714290, (0 missing)
##       cte.achievement     splits as  LLR, improve=2.9343390, (0 missing)
##       RaceEthnicity       splits as  RRLLRR, improve=1.3167340, (0 missing)
##       MCA.R               &lt; 1.5       to the left,  improve=0.5670197, (248 missing)
##       took.ACT            splits as  LR, improve=0.4304287, (0 missing)
## 
## Node number 33: 737 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.1777476  P(node) =0.02767036
##     class counts:   131   606
##    probabilities: 0.178 0.822 
##   left son=66 (76 obs) right son=67 (661 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.6770254 to the left,  improve=4.5781430, (0 missing)
##       took.ACT                             splits as  LR, improve=1.8039520, (0 missing)
##       RaceEthnicity                        splits as  LRRLRR, improve=1.1216510, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=0.4694517, (88 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.3365898, (0 missing)
## 
## Node number 64: 1266 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.28594  P(node) =0.04753144
##     class counts:   362   904
##    probabilities: 0.286 0.714 
##   left son=128 (658 obs) right son=129 (608 obs)
##   Primary splits:
##       cte.achievement                    splits as  LRR, improve=2.2491900, (0 missing)
##       avg.wages.pct.state                &lt; 0.7025719 to the left,  improve=0.7457463, (0 missing)
##       took.ACT                           splits as  LR, improve=0.7198588, (0 missing)
##       RaceEthnicity                      splits as  RRLLRR, improve=0.6140553, (0 missing)
##       LimitedEnglishProficiencyIndicator splits as  RL, improve=0.5955187, (0 missing)
##   Surrogate splits:
##       RaceEthnicity                        splits as  RLRRRL, agree=0.587, adj=0.140, (0 split)
##       LimitedEnglishProficiencyIndicator   splits as  LR, agree=0.575, adj=0.115, (0 split)
##       pseo.participant                     splits as  LR, agree=0.540, adj=0.043, (0 split)
##       avg.wages.pct.state                  &lt; 0.7122351 to the left,  agree=0.536, adj=0.035, (0 split)
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.533, adj=0.028, (0 split)
## 
## Node number 65: 557 observations
##   predicted class=No match  expected loss=0.2010772  P(node) =0.02091233
##     class counts:   112   445
##    probabilities: 0.201 0.799 
## 
## Node number 66: 76 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.3421053  P(node) =0.002853388
##     class counts:    26    50
##    probabilities: 0.342 0.658 
##   left son=132 (48 obs) right son=133 (28 obs)
##   Primary splits:
##       MCA.M                     &lt; 1.5       to the left,  improve=2.3625000, (16 missing)
##       took.ACT                  splits as  LR, improve=1.5909980, (0 missing)
##       MCA.R                     &lt; 2.5       to the right, improve=1.3497200, (11 missing)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, improve=1.1116250, (0 missing)
##       MCA.S                     &lt; 1.5       to the left,  improve=0.4778409, (12 missing)
##   Surrogate splits:
##       pseo.participant          splits as  LR, agree=0.633, adj=0.214, (16 split)
##       MCA.S                     &lt; 2.5       to the left,  agree=0.600, adj=0.143, (0 split)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, agree=0.600, adj=0.143, (0 split)
##       cte.achievement           splits as  RLL, agree=0.583, adj=0.107, (0 split)
##       took.ACT                  splits as  LR, agree=0.567, adj=0.071, (0 split)
## 
## Node number 67: 661 observations
##   predicted class=No match  expected loss=0.1588502  P(node) =0.02481697
##     class counts:   105   556
##    probabilities: 0.159 0.841 
## 
## Node number 128: 658 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.3145897  P(node) =0.02470434
##     class counts:   207   451
##    probabilities: 0.315 0.685 
##   left son=256 (122 obs) right son=257 (536 obs)
##   Primary splits:
##       avg.wages.pct.state &lt; 0.7039552 to the left,  improve=1.4953810, (0 missing)
##       took.ACT            splits as  LR, improve=1.2646400, (0 missing)
##       RaceEthnicity       splits as  RRLL-L, improve=1.0086080, (0 missing)
##       MCA.M               &lt; 1.5       to the left,  improve=0.5369837, (43 missing)
##       MCA.R               &lt; 1.5       to the left,  improve=0.4661558, (47 missing)
## 
## Node number 129: 608 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.2549342  P(node) =0.02282711
##     class counts:   155   453
##    probabilities: 0.255 0.745 
##   left son=258 (123 obs) right son=259 (485 obs)
##   Primary splits:
##       RaceEthnicity                      splits as  LLLRRR, improve=1.8954810, (0 missing)
##       LimitedEnglishProficiencyIndicator splits as  RL, improve=1.5107460, (0 missing)
##       avg.wages.pct.state                &lt; 0.7077928 to the right, improve=0.9196207, (0 missing)
##       MCA.S                              &lt; 2.5       to the left,  improve=0.4823501, (166 missing)
##       MCA.M                              &lt; 1.5       to the left,  improve=0.2959430, (95 missing)
##   Surrogate splits:
##       LimitedEnglishProficiencyIndicator splits as  RL, agree=0.868, adj=0.35, (0 split)
## 
## Node number 132: 48 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.3958333  P(node) =0.00180214
##     class counts:    19    29
##    probabilities: 0.396 0.604 
##   left son=264 (37 obs) right son=265 (11 obs)
##   Primary splits:
##       took.ACT                             splits as  LR, improve=2.65366500, (0 missing)
##       MCA.R                                &lt; 2.5       to the right, improve=1.51502400, (11 missing)
##       cte.achievement                      splits as  LRR, improve=0.48980190, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.22500000, (0 missing)
##       MCA.S                                &lt; 1.5       to the left,  improve=0.02539683, (12 missing)
##   Surrogate splits:
##       ps.grad.InstitutionSector            &lt; 4.5       to the right, agree=0.875, adj=0.455, (0 split)
##       pseo.participant                     splits as  LR, agree=0.854, adj=0.364, (0 split)
##       attended.ps.within.first.year.hsgrad splits as  LR, agree=0.854, adj=0.364, (0 split)
##       ap.exam                              splits as  LR, agree=0.792, adj=0.091, (0 split)
## 
## Node number 133: 28 observations
##   predicted class=No match  expected loss=0.25  P(node) =0.001051248
##     class counts:     7    21
##    probabilities: 0.250 0.750 
## 
## Node number 256: 122 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.3852459  P(node) =0.004580439
##     class counts:    47    75
##    probabilities: 0.385 0.615 
##   left son=512 (88 obs) right son=513 (34 obs)
##   Primary splits:
##       took.ACT                             splits as  LR, improve=3.0328750, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=1.1030740, (7 missing)
##       attended.ps.within.first.year.hsgrad splits as  LR, improve=0.9468852, (0 missing)
##       MCA.R                                &lt; 1.5       to the left,  improve=0.5660819, (8 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the left,  improve=0.4344848, (0 missing)
##   Surrogate splits:
##       RaceEthnicity splits as  -RLL-L, agree=0.73, adj=0.029, (0 split)
## 
## Node number 257: 536 observations
##   predicted class=No match  expected loss=0.2985075  P(node) =0.0201239
##     class counts:   160   376
##    probabilities: 0.299 0.701 
## 
## Node number 258: 123 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.3333333  P(node) =0.004617984
##     class counts:    41    82
##    probabilities: 0.333 0.667 
##   left son=516 (72 obs) right son=517 (51 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.7077928 to the right, improve=2.4117650, (0 missing)
##       LimitedEnglishProficiencyIndicator   splits as  RL, improve=2.3768120, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.9837398, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=0.9642857, (27 missing)
##       ps.grad.InstitutionSector            &lt; 4.5       to the right, improve=0.6936294, (0 missing)
##   Surrogate splits:
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.61, adj=0.059, (0 split)
## 
## Node number 259: 485 observations
##   predicted class=No match  expected loss=0.2350515  P(node) =0.01820912
##     class counts:   114   371
##    probabilities: 0.235 0.765 
## 
## Node number 264: 37 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.4864865  P(node) =0.00138915
##     class counts:    18    19
##    probabilities: 0.486 0.514 
##   left son=528 (11 obs) right son=529 (26 obs)
##   Primary splits:
##       MCA.R                                &lt; 2.5       to the right, improve=1.36644900, (10 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.89601030, (0 missing)
##       cte.achievement                      splits as  LRR, improve=0.13529600, (0 missing)
##       MCA.S                                &lt; 1.5       to the left,  improve=0.03333333, (10 missing)
##   Surrogate splits:
##       attended.ps.within.first.year.hsgrad splits as  RL, agree=0.704, adj=0.2, (10 split)
##       MCA.S                                &lt; 2.5       to the right, agree=0.667, adj=0.1, (0 split)
## 
## Node number 265: 11 observations
##   predicted class=No match  expected loss=0.09090909  P(node) =0.0004129904
##     class counts:     1    10
##    probabilities: 0.091 0.909 
## 
## Node number 512: 88 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.4545455  P(node) =0.003303923
##     class counts:    40    48
##    probabilities: 0.455 0.545 
##   left son=1024 (21 obs) right son=1025 (67 obs)
##   Primary splits:
##       ps.grad.InstitutionSector &lt; 4.5       to the left,  improve=1.4927960, (0 missing)
##       MCA.R                     &lt; 1.5       to the left,  improve=1.0345340, (8 missing)
##       MCA.M                     &lt; 1.5       to the left,  improve=0.9375157, (7 missing)
##       avg.wages.pct.state       &lt; 0.7025719 to the left,  improve=0.1500478, (0 missing)
##       MCA.S                     &lt; 1.5       to the right, improve=0.0974359, (10 missing)
## 
## Node number 513: 34 observations
##   predicted class=No match  expected loss=0.2058824  P(node) =0.001276516
##     class counts:     7    27
##    probabilities: 0.206 0.794 
## 
## Node number 516: 72 observations,    complexity param=0.0002817894
##   predicted class=No match  expected loss=0.4166667  P(node) =0.00270321
##     class counts:    30    42
##    probabilities: 0.417 0.583 
##   left son=1032 (40 obs) right son=1033 (32 obs)
##   Primary splits:
##       avg.wages.pct.state                  &lt; 0.7122351 to the left,  improve=4.5125000, (0 missing)
##       LimitedEnglishProficiencyIndicator   splits as  RL, improve=1.5714290, (0 missing)
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.5253227, (0 missing)
##       cte.achievement                      splits as  -LR, improve=0.5000000, (0 missing)
##       MCA.M                                &lt; 1.5       to the left,  improve=0.3967033, (20 missing)
##   Surrogate splits:
##       RaceEthnicity             splits as  RLL---, agree=0.597, adj=0.094, (0 split)
##       cte.achievement           splits as  -LR, agree=0.583, adj=0.063, (0 split)
##       pseo.participant          splits as  LR, agree=0.569, adj=0.031, (0 split)
##       ps.grad.InstitutionSector &lt; 4.5       to the right, agree=0.569, adj=0.031, (0 split)
## 
## Node number 517: 51 observations
##   predicted class=No match  expected loss=0.2156863  P(node) =0.001914774
##     class counts:    11    40
##    probabilities: 0.216 0.784 
## 
## Node number 528: 11 observations
##   predicted class=Match     expected loss=0.2727273  P(node) =0.0004129904
##     class counts:     8     3
##    probabilities: 0.727 0.273 
## 
## Node number 529: 26 observations
##   predicted class=No match  expected loss=0.3846154  P(node) =0.0009761592
##     class counts:    10    16
##    probabilities: 0.385 0.615 
## 
## Node number 1024: 21 observations
##   predicted class=Match     expected loss=0.3809524  P(node) =0.0007884363
##     class counts:    13     8
##    probabilities: 0.619 0.381 
## 
## Node number 1025: 67 observations
##   predicted class=No match  expected loss=0.4029851  P(node) =0.002515487
##     class counts:    27    40
##    probabilities: 0.403 0.597 
## 
## Node number 1032: 40 observations,    complexity param=0.0002817894
##   predicted class=Match     expected loss=0.425  P(node) =0.001501783
##     class counts:    23    17
##    probabilities: 0.575 0.425 
##   left son=2064 (30 obs) right son=2065 (10 obs)
##   Primary splits:
##       attended.ps.within.first.year.hsgrad splits as  RL, improve=0.8166667, (0 missing)
##       LimitedEnglishProficiencyIndicator   splits as  RL, improve=0.5633333, (0 missing)
##       cte.achievement                      splits as  -LR, improve=0.4402821, (0 missing)
##       MCA.S                                &lt; 1.5       to the right, improve=0.3027318, (11 missing)
##       avg.wages.pct.state                  &lt; 0.7101155 to the right, improve=0.2317043, (0 missing)
##   Surrogate splits:
##       RaceEthnicity splits as  RRL---, agree=0.800, adj=0.2, (0 split)
##       ap.exam       splits as  LR,     agree=0.775, adj=0.1, (0 split)
## 
## Node number 1033: 32 observations
##   predicted class=No match  expected loss=0.21875  P(node) =0.001201427
##     class counts:     7    25
##    probabilities: 0.219 0.781 
## 
## Node number 2064: 30 observations
##   predicted class=Match     expected loss=0.3666667  P(node) =0.001126338
##     class counts:    19    11
##    probabilities: 0.633 0.367 
## 
## Node number 2065: 10 observations
##   predicted class=No match  expected loss=0.4  P(node) =0.0003754458
##     class counts:     4     6
##    probabilities: 0.400 0.600</code></pre>
<pre class="r"><code>#Plot tree
rpart.plot(grad.year.0.county.model.postprune)</code></pre>
<p><img src="analysis_local_employment_cart_files/figure-html/postpruning%20grad%20year%20+0%20county-1.png" width="672" /></p>
<pre class="r"><code># Examine the complexity plot
printcp(grad.year.0.county.model.postprune)</code></pre>
<pre><code>## 
## Classification tree:
## rpart(formula = hs.grad.year.county.match ~ ., data = train, 
##     method = &quot;class&quot;, control = rpart.control(cp = 0))
## 
## Variables actually used in tree construction:
##  [1] attended.ps.within.first.year.hsgrad avg.wages.pct.state                 
##  [3] cte.achievement                      Dem_Desc                            
##  [5] edr                                  MCA.M                               
##  [7] MCA.R                                ps.grad.InstitutionSector           
##  [9] RaceEthnicity                        took.ACT                            
## 
## Root node error: 3340/26635 = 0.1254
## 
## n= 26635 
## 
##           CP nsplit rel error xerror     xstd
## 1 0.00028179      0   1.00000 1.0000 0.016182
## 2 0.00024657     18   0.99461 1.0204 0.016322</code></pre>
<pre class="r"><code>plotcp(grad.year.0.county.model.postprune)</code></pre>
<p><img src="analysis_local_employment_cart_files/figure-html/postpruning%20grad%20year%20+0%20county-2.png" width="672" /></p>
<pre class="r"><code># Compute the accuracy of the pruned tree

test$pred &lt;- predict(grad.year.0.county.model.postprune, test, type = &quot;class&quot;)

accuracy_postprun &lt;- mean(test$pred == test$hs.grad.year.county.match)

accuracy_postprun</code></pre>
<pre><code>## [1] 0.879194</code></pre>
<p><br></p>
<p>We still end up with a highly complex tree that is difficult to
interpret. Let’s check to see what variables are considered
important.</p>
<p>And it tells me that none of the variables are important?????</p>
<p><br></p>
<pre class="r"><code>grad.year.0.county.model.postprune$variable.importance</code></pre>
<pre><code>##            ps.grad.InstitutionSector                  avg.wages.pct.state 
##                           96.7478550                           41.7294505 
##                                MCA.M                                  edr 
##                           24.6825438                           18.5846511 
##                             Dem_Desc                              ap.exam 
##                           17.2923259                           10.8089855 
##                     pseo.participant                             took.ACT 
##                            5.9143809                            5.8552896 
##                                MCA.R                        RaceEthnicity 
##                            3.9511430                            2.8855057 
##                      cte.achievement attended.ps.within.first.year.hsgrad 
##                            2.7843460                            2.2596826 
##   LimitedEnglishProficiencyIndicator                                MCA.S 
##                            0.9216005                            0.4741449</code></pre>
<p><br></p>
<p>Now let’s compare the accuracy.</p>
<pre class="r"><code>data.frame(base_accuracy, accuracy_preprun, accuracy_postprun)</code></pre>
<pre><code>##   base_accuracy accuracy_preprun accuracy_postprun
## 1     0.8642138        0.8773544          0.879194</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#section-TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
